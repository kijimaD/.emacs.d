<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-02-11 Tue 06:47 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>kijimad Emacs Config</title>
<meta name="author" content="Anka" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">kijimad Emacs Config</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org4d663a7">1. Emacs</a></li>
<li><a href="#org16742f1">2. Org</a>
<ul>
<li><a href="#org8cf7de7">2.1. base</a></li>
<li><a href="#orgb5c6048">2.2. open-junk-file</a></li>
<li><a href="#org4ad4197">2.3. org-superstar</a></li>
<li><a href="#org6649ac9">2.4. org-modern</a></li>
<li><a href="#org694127a">2.5. org-tree-slide</a></li>
<li><a href="#org0a27afc">2.6. org-journal</a></li>
<li><a href="#orgc6006bc">2.7. org-roam</a></li>
<li><a href="#org6ace107">2.8. org-roam-ui</a></li>
<li><a href="#org256b5f1">2.9. org-alert</a></li>
<li><a href="#orge62cea5">2.10. denote</a></li>
<li><a href="#org442f2dc">2.11. org-agenda</a></li>
<li><a href="#org499fa7c">2.12. org-super-agenda</a></li>
<li><a href="#org06456e6">2.13. org-pomodoro</a></li>
<li><a href="#org5d05d3d">2.14. org-effort</a></li>
<li><a href="#org9308cc0">2.15. org-tag</a></li>
<li><a href="#org67627c7">2.16. Mermaid</a></li>
</ul>
</li>
<li><a href="#org7a2b903">3. Font</a></li>
<li><a href="#orgb0c0466">4. Simple</a></li>
<li><a href="#orgdc72da4">5. Packages</a></li>
<li><a href="#org568aaaa">6. Rails</a></li>
<li><a href="#org650ee1d">7. Go</a></li>
<li><a href="#org3b1f695">8. Haskell</a></li>
<li><a href="#org2935b4a">9. Yaml</a></li>
<li><a href="#org8886896">10. Web</a></li>
<li><a href="#orgde99e02">11. corfu</a></li>
<li><a href="#org482fe09">12. vertico</a></li>
<li><a href="#org19262cb">13. tabnine</a></li>
<li><a href="#org298557d">14. emacs Lisp</a>
<ul>
<li><a href="#org7398117">14.1. rispy</a></li>
</ul>
</li>
<li><a href="#orgcbd40af">15. eldoc</a></li>
<li><a href="#org2a554c5">16. eshell</a></li>
<li><a href="#orgb0e15c2">17. Vterm</a></li>
<li><a href="#orgcbc0b76">18. Theme</a></li>
<li><a href="#org779a508">19. EXWM</a></li>
<li><a href="#org61c3264">20. Polybar</a></li>
<li><a href="#orgc75cf50">21. Workspace</a></li>
<li><a href="#org21ae592">22. Hydra</a></li>
<li><a href="#org5df1844">23. Display Manager</a></li>
<li><a href="#org3bf0faf">24. Helper</a></li>
<li><a href="#org26501b7">25. delve-mode</a></li>
<li><a href="#orgf530457">26. spray</a></li>
</ul>
</div>
</div>

<div id="outline-container-org4d663a7" class="outline-2">
<h2 id="org4d663a7"><span class="section-number-2">1.</span> Emacs</h2>
<div class="outline-text-2" id="text-1">
<p>
Emacsの文芸的設定。
</p>

<ul class="org-ul">
<li><a href="https://github.com/kijimaD/.emacs.d">Repository</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>package設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">package</span>)

(<span style="font-weight: bold;">setq</span> package-archives '((<span style="font-style: italic;">"melpa"</span> . <span style="font-style: italic;">"https://melpa.org/packages/"</span>)
                         (<span style="font-style: italic;">"gnu"</span> . <span style="font-style: italic;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="font-style: italic;">"elpa"</span> . <span style="font-style: italic;">"https://elpa.gnu.org/packages/"</span>)
                         (<span style="font-style: italic;">"org"</span> . <span style="font-style: italic;">"http://orgmode.org/elpa/"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org16742f1" class="outline-2">
<h2 id="org16742f1"><span class="section-number-2">2.</span> Org</h2>
<div class="outline-text-2" id="text-2">
<p>
org-modeはEmacsのキラーアプリの1つ。パッケージ名であり、ファイルの種類の1つ。ドキュメント管理にスケジュール、時間計測、コード評価を含めることができる。このドキュメントもorg-modeで書かれている。
</p>
</div>

<div id="outline-container-org8cf7de7" class="outline-3">
<h3 id="org8cf7de7"><span class="section-number-3">2.1.</span> base</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>読み込み</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-protocol</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>日付時刻のフォーマットを指定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> system-time-locale <span style="font-style: italic;">"C"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>拡張子がorgのファイルを開いた時，自動的にorg-modeにする</label><pre class="src src-emacs-lisp">(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.org$"</span> . org-mode))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>orgファイルを開いたときに展開状態にする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-startup-folded 'content)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>強調表示できるようにする</label><pre class="src src-emacs-lisp">(add-hook 'org-mode-hook 'turn-on-font-lock)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>本文を自動インデント</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-startup-indented t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>見出しの余分な*を消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-hide-leading-stars t)
(<span style="font-weight: bold;">setq</span> org-hide-emphasis-markers t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>画像表示</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-startup-with-inline-images t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>独自のTODOキーワードを設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-todo-keywords '((type <span style="font-style: italic;">"TODO"</span> <span style="font-style: italic;">"WIP"</span> <span style="font-style: italic;">"WAIT"</span> <span style="font-style: italic;">"|"</span> <span style="font-style: italic;">"DONE"</span> <span style="font-style: italic;">"CLOSE"</span>)))
(<span style="font-weight: bold;">setq</span> org-todo-keyword-faces
      '((<span style="font-style: italic;">"TODO"</span> . (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"orange"</span> <span style="font-weight: bold;">:weight</span> bold))
        (<span style="font-style: italic;">"WIP"</span> . (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"DeepSkyBlue"</span> <span style="font-weight: bold;">:weight</span> bold))
        (<span style="font-style: italic;">"WAIT"</span> . (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"yellow"</span> <span style="font-weight: bold;">:weight</span> bold))
        (<span style="font-style: italic;">"DONE"</span> . (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"green"</span> <span style="font-weight: bold;">:weight</span> bold))
        (<span style="font-style: italic;">"CLOSE"</span> . (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"DarkOrchid"</span> <span style="font-weight: bold;">:weight</span> bold))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>コードブロックをシンタックスハイライトする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-src-fontify-natively t)
(<span style="font-weight: bold;">setq</span> org-fontify-quote-and-verse-blocks t)
(<span style="font-weight: bold;">setq</span> org-src-tab-acts-natively t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 12: </span>本文収納時の記号</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "&#187;")</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "..")</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "&#10549;")</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "&#129175;")</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "&#10070;")</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-ellipsis "&#8623;")</span>
(<span style="font-weight: bold;">setq</span> org-ellipsis <span style="font-style: italic;">"&#9661;"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 13: </span>本文収納時の記号と、本文に空ける行数</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-cycle-separator-lines 2)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 14: </span>行末で折り返し表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-startup-truncated nil)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">change-truncation</span>()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">cond</span> ((eq truncate-lines nil)
         (<span style="font-weight: bold;">setq</span> truncate-lines t))
        (t
         (<span style="font-weight: bold;">setq</span> truncate-lines nil))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 15: </span>スピードコマンド有効化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-use-speed-commands t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 16: </span>ほかとかぶるので無効化するキーバインド</label><pre class="src src-emacs-lisp">(define-key org-mode-map (kbd <span style="font-style: italic;">"C-c C-j"</span>) nil)
(define-key org-mode-map (kbd <span style="font-style: italic;">"M-&lt;left&gt;"</span>) nil)
(define-key org-mode-map (kbd <span style="font-style: italic;">"M-&lt;right&gt;"</span>) nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 17: </span>キーバインド</label><pre class="src src-emacs-lisp">(define-key org-mode-map (kbd <span style="font-style: italic;">"C-c C-x i"</span>) 'org-clock-in)
(define-key org-mode-map (kbd <span style="font-style: italic;">"C-c C-x o"</span>) 'org-clock-out)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 18: </span>org-babelで実行可能にする言語</label><pre class="src src-emacs-lisp">(org-babel-do-load-languages 'org-babel-load-languages
                             '((C . t)
                               (clojure . t)
                               (emacs-lisp . t)
                               (graphql . t)
                               (haskell . t)
                               (lisp . t)
                               (python . t)
                               (ruby . t)
                               (rust . t)
                               (shell . t)
                               (sql . t)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 19: </span>Clojure 設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">cider</span>)
(<span style="font-weight: bold;">setq</span> org-babel-clojure-backend 'cider)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 20: </span>Common Lisp設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> inferior-lisp-program <span style="font-style: italic;">"clisp"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 21: </span>sql設定</label><pre class="src src-emacs-lisp">(add-hook 'sql-mode-org-src-hook #'sqlind-minor-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 22: </span>python設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-babel-python-command <span style="font-style: italic;">"python3"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 23: </span>評価するときに確認プロンプトを出さない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-confirm-babel-evaluate nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 24: </span>org selectでコード挿入時に表示される選択肢を増やす</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> 'org
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This is needed as of Org 9.2</span>
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-tempo</span>)

  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"cj"</span> . <span style="font-style: italic;">"src clojure"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"cl"</span> . <span style="font-style: italic;">"src C"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"el"</span> . <span style="font-style: italic;">"src emacs-lisp"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"gp"</span> . <span style="font-style: italic;">"src git-permalink"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"go"</span> . <span style="font-style: italic;">"src go"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"gq"</span> . <span style="font-style: italic;">"src graphql"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"hs"</span> . <span style="font-style: italic;">"src haskell"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"js"</span> . <span style="font-style: italic;">"src javascript"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"py"</span> . <span style="font-style: italic;">"src python"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"rb"</span> . <span style="font-style: italic;">"src ruby"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"rs"</span> . <span style="font-style: italic;">"src rust"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"sc"</span> . <span style="font-style: italic;">"src scala"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"sh"</span> . <span style="font-style: italic;">"src shell"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"sq"</span> . <span style="font-style: italic;">"src sql"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"ts"</span> . <span style="font-style: italic;">"src typescript"</span>))
  (add-to-list 'org-structure-template-alist '(<span style="font-style: italic;">"mm"</span> . <span style="font-style: italic;">"src mermaid"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 25: </span>中央寄せ設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">visual-fill-column</span>)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/centering-buffer</span> ()
  <span style="font-style: italic;">"Centering buffer."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">setq</span> visual-fill-column-width 100
        visual-fill-column-center-text t)
  (visual-fill-column-mode 1))

(add-hook 'org-mode-hook (<span style="font-weight: bold;">lambda</span> () (kd/centering-buffer)))
(add-hook 'eww-mode-hook (<span style="font-weight: bold;">lambda</span> () (kd/centering-buffer)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 26: </span>よりよい外観</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">efs/org-font-setup</span> ()
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Replace list hyphen with dot</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(font-lock-add-keywords 'org-mode</span>
    <span style="font-weight: bold; font-style: italic;">;;                         </span><span style="font-weight: bold; font-style: italic;">'(("^ *\\([-]\\) "</span>
    <span style="font-weight: bold; font-style: italic;">;;                            </span><span style="font-weight: bold; font-style: italic;">(0 (prog1 () (compose-region (match-beginning 1) (match-end 1) "&#10022;"))))))</span>

    (<span style="font-weight: bold;">dolist</span> (face '((org-level-1 . 1.0)
                    (org-level-2 . 1.0)
                    (org-level-3 . 1.0)
                    (org-level-4 . 1.0)
                    (org-level-5 . 1.0)
                    (org-level-6 . 1.0)
                    (org-level-7 . 1.0)
                    (org-level-8 . 1.0)))
      (set-face-attribute (car face) nil <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"Hiragino Sans"</span> <span style="font-weight: bold;">:height</span> (cdr face) <span style="font-weight: bold;">:weight</span> 'bold))

    (set-face-attribute 'org-block nil    <span style="font-weight: bold;">:foreground</span> nil <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)
    (set-face-attribute 'org-table nil    <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)
    (set-face-attribute 'org-formula nil  <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)
    (set-face-attribute 'org-code nil     <span style="font-weight: bold;">:inherit</span> '(shadow fixed-pitch))
    (set-face-attribute 'org-table nil    <span style="font-weight: bold;">:inherit</span> '(shadow fixed-pitch))
    (set-face-attribute 'org-verbatim nil <span style="font-weight: bold;">:inherit</span> '(shadow fixed-pitch))
    (set-face-attribute 'org-special-keyword nil <span style="font-weight: bold;">:inherit</span> '(font-lock-comment-face fixed-pitch))
    (set-face-attribute 'org-meta-line nil <span style="font-weight: bold;">:inherit</span> '(font-lock-comment-face fixed-pitch))
    (set-face-attribute 'org-checkbox nil  <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)
    (set-face-attribute 'line-number nil <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)
    (set-face-attribute 'line-number-current-line nil <span style="font-weight: bold;">:inherit</span> 'fixed-pitch)

    (custom-theme-set-faces
     'user
     '(variable-pitch ((t (<span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Helvetica Neue"</span> <span style="font-weight: bold;">:height</span> 1.0 <span style="font-weight: bold;">:weight</span> regular))))
     '(fixed-pitch ((t (<span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Fira Mono"</span> <span style="font-weight: bold;">:height</span> 1.0))))
     '(org-block ((t (<span style="font-weight: bold;">:inherit</span> fixed-pitch))))
     '(org-code ((t (<span style="font-weight: bold;">:inherit</span> (shadow fixed-pitch)))))
     '(org-document-info ((t (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"dark orange"</span>))))
     '(org-document-info-keyword ((t (<span style="font-weight: bold;">:inherit</span> (shadow fixed-pitch)))))
     '(org-indent ((t (<span style="font-weight: bold;">:inherit</span> (org-hide fixed-pitch)))))
     '(org-link ((t (<span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"royal blue"</span> <span style="font-weight: bold;">:underline</span> t))))
     '(org-meta-line ((t (<span style="font-weight: bold;">:inherit</span> (font-lock-comment-face fixed-pitch)))))
     '(org-property-value ((t (<span style="font-weight: bold;">:inherit</span> fixed-pitch))) t)
     '(org-special-keyword ((t (<span style="font-weight: bold;">:inherit</span> (font-lock-comment-face fixed-pitch)))))
     '(org-table ((t (<span style="font-weight: bold;">:inherit</span> fixed-pitch))))
     '(org-tag ((t (<span style="font-weight: bold;">:inherit</span> (shadow fixed-pitch) <span style="font-weight: bold;">:weight</span> bold <span style="font-weight: bold;">:height</span> 0.8))))
     '(org-verbatim ((t (<span style="font-weight: bold;">:inherit</span> (shadow fixed-pitch)))))
     '(org-block-begin-line ((t (<span style="font-weight: bold;">:inherit</span> org-block))))))
</pre>
</div>

<p>
themeのあとに評価するため、ここでは関数定義だけ。参考 <a href="https://github.com/daviwil/emacs-from-scratch/blob/master/Emacs.org">https://github.com/daviwil/emacs-from-scratch/blob/master/Emacs.org</a>
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 27: </span>線の幅</label><pre class="src src-emacs-lisp">(add-hook 'org-mode-hook 'variable-pitch-mode)
(add-hook 'org-mode-hook 'visual-line-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 28: </span>org-lintの対象ファイル</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">org-lint-dir</span> (directory)
  (<span style="font-weight: bold;">let*</span> ((files (directory-files directory t <span style="font-style: italic;">".*\\.org$"</span>)))
    (org-lint-list files)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">org-lint-list</span> (files)
  (<span style="font-weight: bold;">cond</span> (files
         (org-lint-file (car files))
         (org-lint-list (cdr files)))))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">org-lint-file</span> (file)
  (<span style="font-weight: bold;">let</span> ((buf)
        (lint))
    (<span style="font-weight: bold;">setq</span> buf (find-file-noselect file))
    (<span style="font-weight: bold;">with-current-buffer</span> buf (<span style="font-weight: bold;">if</span> (<span style="font-weight: bold;">setq</span> lint (org-lint)) (print (list file lint))))))
</pre>
</div>

<p>
babelで出力した結果はラップしないとtextlintでエラーになる。なのでデフォルトの設定に追加する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 29: </span>:wrapを設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-babel-default-header-args '(
                                      (<span style="font-weight: bold;">:session</span> . <span style="font-style: italic;">"none"</span>)
                                      (<span style="font-weight: bold;">:results</span> . <span style="font-style: italic;">"replace"</span>)
                                      (<span style="font-weight: bold;">:results</span> . <span style="font-style: italic;">"raw"</span>)
                                      (<span style="font-weight: bold;">:exports</span> . <span style="font-style: italic;">"code"</span>)
                                      (<span style="font-weight: bold;">:cache</span> . <span style="font-style: italic;">"no"</span>)
                                      (<span style="font-weight: bold;">:noweb</span> . <span style="font-style: italic;">"no"</span>)
                                      (<span style="font-weight: bold;">:hlines</span> . <span style="font-style: italic;">"no"</span>)
                                      (<span style="font-weight: bold;">:tangle</span> . <span style="font-style: italic;">"no"</span>)
                                      (<span style="font-weight: bold;">:wrap</span> . <span style="font-style: italic;">"src"</span>))
      )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb5c6048" class="outline-3">
<h3 id="orgb5c6048"><span class="section-number-3">2.2.</span> open-junk-file</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 30: </span>Cask install が失敗するので取り込んでいる</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">open-junk-file.el --- Open a junk (memo) file to try-and-error</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">$Time-stamp: &lt;2016-09-13 10:59:40 rubikitch&gt;$</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Copyright (C) 2010  rubikitch</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Author: rubikitch <a href="mailto:rubikitch%40ruby-lang.org">&lt;rubikitch@ruby-lang.org&gt;</a></span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Keywords: convenience, tools</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Package-Version: 20161210.1114</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Package-Commit: 558bec7372b0fed4c4cb6074ab906535fae615bd</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">URL: http://www.emacswiki.org/cgi-bin/wiki/download/open-junk-file.el</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This file is free software; you can redistribute it and/or modify</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">it under the terms of the GNU General Public License as published by</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">the Free Software Foundation; either version 2, or (at your option)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">any later version.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This file is distributed in the hope that it will be useful,</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GNU General Public License for more details.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">You should have received a copy of the GNU General Public License</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">along with GNU Emacs; see the file COPYING.  If not, write to</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Boston, MA 02110-1301, USA.</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Commentary:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">M-x `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file</span><span style="font-weight: bold; font-style: italic;">' opens a new file whose filename is derived from</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">current time.  You can write short program in it.  It helps to</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">try-and-error programs.</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">For example, in Emacs Lisp programming, use M-x `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file</span><span style="font-weight: bold; font-style: italic;">'</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">instead of *scratch* buffer.  The junk code is SEARCHABLE.</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">In Ruby programming, use M-x `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file</span><span style="font-weight: bold; font-style: italic;">' and</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">write a script with xmpfilter annotations.  It is the FASTEST</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">methodology to try Ruby methods, Irb is not needed anymore.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Xmpfilter is available at http://eigenclass.org/hiki/rcodetools</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Commands:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Below are complete command list:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">`</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file</span><span style="font-weight: bold; font-style: italic;">'</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">Open a new file whose filename is derived from current time.</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Customizable Options:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Below are customizable option list:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">`</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-format</span><span style="font-weight: bold; font-style: italic;">'</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">*File format to put junk files with directory.</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">default = "~/junk/%Y/%m/%d-%H%M%S."</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">`</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-find-file-function</span><span style="font-weight: bold; font-style: italic;">'</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">*Function to open junk files.</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">default = (quote find-file-other-window)</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Installation:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Put open-junk-file.el to your load-path.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">The load-path is usually ~/elisp/.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">It's set in your ~/.emacs like this:</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-to-list 'load-path (expand-file-name "~/elisp"))</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">And the following to your ~/.emacs startup file.</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(require 'open-junk-file)</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">No need more.</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Customize:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">All of the above can customize by:</span>
<span style="font-weight: bold; font-style: italic;">;;      </span><span style="font-weight: bold; font-style: italic;">M-x customize-group RET open-junk-file RET</span>
<span style="font-weight: bold; font-style: italic;">;;</span>


<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Bug Report:</span>
<span style="font-weight: bold; font-style: italic;">;;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">If you have problem, send a bug report via M-x open-junk-file-send-bug-report.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">The step is:</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">0) Setup mail in Emacs, the easiest way is:</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq user-mail-address "your@mail.address")</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq user-full-name "Your Full Name")</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq smtpmail-smtp-server "your.smtp.server.jp")</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq mail-user-agent 'message-user-agent)</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq message-send-mail-function 'message-smtpmail-send-it)</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">1) Be sure to use the LATEST version of open-junk-file.el.</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">2) Enable debugger. M-x toggle-debug-on-error or (setq debug-on-error t)</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">3) Use Lisp version instead of compiled one: (load "open-junk-file.el")</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">4) Do it!</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">5) If you got an error, please do not close *Backtrace* buffer.</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">6) M-x open-junk-file-send-bug-report and M-x insert-buffer *Backtrace*</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">7) Describe the bug using a precise recipe.</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;">8) Type C-c C-c to send.</span>
<span style="font-weight: bold; font-style: italic;">;;  </span><span style="font-weight: bold; font-style: italic;"># If you are a Japanese, please write in Japanese:-)</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Code:</span>

(<span style="font-weight: bold;">eval-when-compile</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">cl</span>))
(<span style="font-weight: bold;">defgroup</span> <span style="font-weight: bold; text-decoration: underline;">open-junk-file</span> nil
  <span style="font-style: italic;">"open-junk-file"</span>
  <span style="font-weight: bold;">:group</span> 'files)
(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">open-junk-file-format</span> <span style="font-style: italic;">"~/junk/%Y/%m/%d-%H%M%S."</span>
  <span style="font-style: italic;">"File format to put junk files with directory.</span>
<span style="font-style: italic;">It can include `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">format-time-string</span><span style="font-style: italic;">' format specifications."</span>
  <span style="font-weight: bold;">:type</span> 'string
  <span style="font-weight: bold;">:group</span> 'open-junk-file)
(<span style="font-weight: bold;">defvaralias</span> '<span style="font-weight: bold; font-style: italic;">open-junk-file-format</span> 'open-junk-file-directory)
(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">open-junk-file-find-file-function</span> 'find-file-other-window
  <span style="font-style: italic;">"Function to open junk files."</span>
  <span style="font-weight: bold;">:type</span> 'function
  <span style="font-weight: bold;">:group</span> 'open-junk-file)
(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">open-junk-file-hook</span> nil
  <span style="font-style: italic;">"List of functions to be called after a buffer is loaded from a `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">junk</span><span style="font-style: italic;">' file.</span>
<span style="font-style: italic;">Whether the file is a JUNK or not is infered by `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-format</span><span style="font-style: italic;">'."</span>)

<span style="font-weight: bold; font-style: italic;">;;;</span><span style="font-weight: bold; font-style: italic;">###</span><span style="font-weight: bold; font-style: italic;">autoload</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">find-file-hook--open-junk-file</span> ()
  <span style="font-style: italic;">"Run `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-hook</span><span style="font-style: italic;">' when the file is a JUNK file."</span>
  (<span style="font-weight: bold;">when</span> (string-prefix-p
         (file-truename (replace-regexp-in-string <span style="font-style: italic;">"%.+$"</span> <span style="font-style: italic;">""</span> open-junk-file-format))
         (file-truename buffer-file-name))
    (run-hooks 'open-junk-file-hook)))

<span style="font-weight: bold; font-style: italic;">;;;</span><span style="font-weight: bold; font-style: italic;">###</span><span style="font-weight: bold; font-style: italic;">autoload</span>
(add-hook 'find-file-hook 'find-file-hook--open-junk-file)

<span style="font-weight: bold; font-style: italic;">;;;</span><span style="font-weight: bold; font-style: italic;">###</span><span style="font-weight: bold; font-style: italic;">autoload</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">open-junk-file</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> format find-file-fn)
  <span style="font-style: italic;">"Open a new file whose filename is derived from current time.</span>
<span style="font-style: italic;">You can write short program in it.  It helps to try-and-error programs.</span>

<span style="font-style: italic;">For example, in Emacs Lisp programming, use M-x `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file</span><span style="font-style: italic;">'</span>
<span style="font-style: italic;">instead of *scratch* buffer.  The junk code is SEARCHABLE.</span>

<span style="font-style: italic;">FORMAT and FIND-FILE-FN are optional.</span>
<span style="font-style: italic;">Default value of them are `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-format</span><span style="font-style: italic;">' and</span>
<span style="font-style: italic;">`</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">open-junk-file-find-file-function</span><span style="font-style: italic;">'."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let*</span> ((file (format-time-string (<span style="font-weight: bold;">or</span> format open-junk-file-format) (current-time)))
         (dir (file-name-directory file)))
    (make-directory dir t)
    (funcall (<span style="font-weight: bold;">or</span> find-file-fn open-junk-file-find-file-function)
             (read-string <span style="font-style: italic;">"Junk Code (Enter extension): "</span> file))))

<span style="font-weight: bold; font-style: italic;">;;;; </span><span style="font-weight: bold; font-style: italic;">Bug report</span>
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">open-junk-file-maintainer-mail-address</span>
  (concat <span style="font-style: italic;">"rubiki"</span> <span style="font-style: italic;">"tch@ru"</span> <span style="font-style: italic;">"by-lang.org"</span>))
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">open-junk-file-bug-report-salutation</span>
  <span style="font-style: italic;">"Describe bug below, using a precise recipe.</span>

<span style="font-style: italic;">When I executed M-x ...</span>

<span style="font-style: italic;">How to send a bug report:</span>
<span style="font-style: italic;">  1) Be sure to use the LATEST version of open-junk-file.el.</span>
<span style="font-style: italic;">  2) Enable debugger. M-x toggle-debug-on-error or (setq debug-on-error t)</span>
<span style="font-style: italic;">  3) Use Lisp version instead of compiled one: (load \"open-junk-file.el\")</span>
<span style="font-style: italic;">  4) If you got an error, please paste *Backtrace* buffer.</span>
<span style="font-style: italic;">  5) Type C-c C-c to send.</span>
<span style="font-style: italic;"># If you are a Japanese, please write in Japanese:-)"</span>)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">open-junk-file-send-bug-report</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (reporter-submit-bug-report
   open-junk-file-maintainer-mail-address
   <span style="font-style: italic;">"open-junk-file.el"</span>
   (apropos-internal <span style="font-style: italic;">"^open-junk-file-"</span> 'boundp)
   nil nil
   open-junk-file-bug-report-salutation))

(<span style="font-weight: bold;">provide</span> '<span style="font-weight: bold; text-decoration: underline;">open-junk-file</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">How to save (DO NOT REMOVE!!)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(emacswiki-post "open-junk-file.el")</span>
<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">open-junk-file.el ends here</span>

</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 31: </span>使い捨てファイルを開く</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">open-junk-file</span>)
(<span style="font-weight: bold;">setq</span> open-junk-file-format (concat <span style="font-style: italic;">"~/Private/junk/%Y-%m-%d-%H%M%S."</span>))
(global-set-key (kbd <span style="font-style: italic;">"C-x C-z"</span>) 'open-junk-file)
</pre>
</div>

<p>
見出しをいい感じにするパッケージ。だが、org-modernに上書きされてしまうので使ってない。
</p>
</div>
</div>
<div id="outline-container-org4ad4197" class="outline-3">
<h3 id="org4ad4197"><span class="section-number-3">2.3.</span> org-superstar</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 32: </span>見出しをいい感じにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-superstar</span>)
(add-hook 'org-mode-hook (<span style="font-weight: bold;">lambda</span> () (org-superstar-mode 1)))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-superstar-headline-bullets-list '("&#128592;" "&#128593;" "&#128594;" "&#128595;" "&#128596;" "&#128597;" "&#128598;" "&#128599;"))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-superstar-headline-bullets-list '("&#9673;" "&#9675;" "&#9679;" "&#10047;" "&#10040;"))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq org-superstar-item-bullet-alist '((?* . ?&#8226;)</span>
<span style="font-weight: bold; font-style: italic;">;;                                         </span><span style="font-weight: bold; font-style: italic;">(?+ . ?&#187;)</span>
<span style="font-weight: bold; font-style: italic;">;;                                         </span><span style="font-weight: bold; font-style: italic;">(?- . ?&#10148;)))</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6649ac9" class="outline-3">
<h3 id="org6649ac9"><span class="section-number-3">2.4.</span> org-modern</h3>
<div class="outline-text-3" id="text-2-4">
<p>
org-modernはorg-modeの外観をいい感じにするパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 33: </span>org-modernを有効化する</label><pre class="src src-emacs-lisp">(add-hook 'org-mode-hook #'org-modern-mode)
(add-hook 'org-agenda-finalize-hook #'org-modern-agenda)
</pre>
</div>
</div>
</div>
<div id="outline-container-org694127a" class="outline-3">
<h3 id="org694127a"><span class="section-number-3">2.5.</span> org-tree-slide</h3>
<div class="outline-text-3" id="text-2-5">
<p>
org-tree-slideはorg-modeでスライド表示するパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 34: </span>org-tree-slideを有効化する</label><pre class="src src-emacs-lisp">(org-tree-slide-presentation-profile)
(org-tree-slide--hide-slide-header)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a27afc" class="outline-3">
<h3 id="org0a27afc"><span class="section-number-3">2.6.</span> org-journal</h3>
<div class="outline-text-3" id="text-2-6">
<p>
org-journalは日付ごとのファイルを生成したり、時刻を挿入できるパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 35: </span>org-journal</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-journal</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 36: </span>日付と時刻のフォーマット</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-journal-date-format <span style="font-style: italic;">"%Y-%m-%d(%a)"</span>)
(<span style="font-weight: bold;">setq</span> org-journal-time-format <span style="font-style: italic;">"%R "</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 37: </span>読込・保存するディレクトリ</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-journal-dir (concat <span style="font-style: italic;">"~/Private/junk/diary/org-journal"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 38: </span>ファイルのフォーマット</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-journal-file-format <span style="font-style: italic;">"%Y%m%d.org"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 39: </span>ファイルを開く時、画面分割させない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-journal-find-file 'find-file)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 40: </span>ファイルを開いたときに展開状態にする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-journal-hide-entries-p nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 41: </span>テンプレートファイルを設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/new-buffer-p</span> ()
  (not (file-exists-p (buffer-file-name))))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/insert-journal-template</span> ()
  (<span style="font-weight: bold;">let</span> ((template-file (expand-file-name <span style="font-style: italic;">"~/.emacs.d/resources/journal-template.org"</span> org-directory)))
    (<span style="font-weight: bold;">when</span> (kd/new-buffer-p)
      (<span style="font-weight: bold;">save-excursion</span>
        (goto-char (point-min))
        (insert-file-contents template-file)))))
(add-hook 'org-journal-after-entry-create-hook #'kd/insert-journal-template)
</pre>
</div>

<ul class="org-ul">
<li><a href="https://emacs.stackexchange.com/questions/17897/create-an-org-journal-template-for-daily-journal-entry/32655#32655?newreg=7c9543fa39e342cfb438c4168020447d">https://emacs.stackexchange.com/questions/17897/create-an-org-journal-template-for-daily-journal-entry/32655#32655?newreg=7c9543fa39e342cfb438c4168020447d</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc6006bc" class="outline-3">
<h3 id="orgc6006bc"><span class="section-number-3">2.7.</span> org-roam</h3>
<div class="outline-text-3" id="text-2-7">
<p>
org-roamはorgファイルをsqliteによって管理しやすくしたパッケージ。orgファイル同士の関連を挿入したり、リンク元のファイルを一覧にする、といったことができる。sqliteに保存されるので、別でクエリを使って取り出してグラフ描画に使ったりも可能。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 42: </span>基本設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-roam</span>)
(add-hook 'after-init-hook 'org-roam-mode)
(make-directory <span style="font-style: italic;">"~/roam"</span> t)
(<span style="font-weight: bold;">setq</span> org-roam-v2-ack t)
(<span style="font-weight: bold;">setq</span> org-roam-directory <span style="font-style: italic;">"~/roam"</span>)
(<span style="font-weight: bold;">setq</span> org-roam-completion-everywhere t)

(<span style="font-weight: bold;">setq</span> org-id-link-to-org-use-id t)
(<span style="font-weight: bold;">setq</span> org-id-extra-files (org-roam--list-files org-roam-directory))
(org-roam-setup)

(org-roam-db-autosync-enable)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 43: </span>キーバインド</label><pre class="src src-emacs-lisp">(define-key global-map (kbd <span style="font-style: italic;">"C-c n f"</span>) 'org-roam-node-find)
(define-key global-map (kbd <span style="font-style: italic;">"C-c n g"</span>) 'org-roam-graph)
(define-key global-map (kbd <span style="font-style: italic;">"C-c n i"</span>) 'org-roam-node-insert)
(define-key global-map (kbd <span style="font-style: italic;">"C-c n r"</span>) 'org-roam-node-random)
(define-key global-map (kbd <span style="font-style: italic;">"C-c n l"</span>) 'org-roam-buffer-toggle)
(define-key global-map (kbd <span style="font-style: italic;">"C-M-i"</span>) 'completion-at-point)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 44: </span>テンプレート</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> my-todo-file <span style="font-style: italic;">"~/roam/20230202234553-inbox.org"</span>)
(<span style="font-weight: bold;">setq</span> org-roam-capture-templates
      '((<span style="font-style: italic;">"t"</span> <span style="font-style: italic;">"TODO"</span> entry
         (file+headline my-todo-file <span style="font-style: italic;">"Inbox"</span>)
         <span style="font-style: italic;">"*** TODO %?\n"</span>)
        (<span style="font-style: italic;">"d"</span> <span style="font-style: italic;">"default"</span> plain
         <span style="font-style: italic;">"%?"</span>
         <span style="font-weight: bold;">:if-new</span>
         (file+head <span style="font-style: italic;">"%&lt;%Y%m%d%H%M%S&gt;-${slug}.org"</span> <span style="font-style: italic;">"#+title: ${title}"</span>))
        (<span style="font-style: italic;">"r"</span> <span style="font-style: italic;">"roam-page"</span> plain
         (file <span style="font-style: italic;">"~/roam/templates/roam-page.org"</span>)
         <span style="font-weight: bold;">:if-new</span>
         (file+head <span style="font-style: italic;">"%&lt;%Y%m%d%H%M%S&gt;-${slug}.org"</span> <span style="font-style: italic;">"#+title: ${title}"</span>))
        (<span style="font-style: italic;">"p"</span> <span style="font-style: italic;">"project"</span> plain
         (file <span style="font-style: italic;">"~/roam/templates/project.org"</span>)
         <span style="font-weight: bold;">:if-new</span>
         (file+head <span style="font-style: italic;">"%&lt;%Y%m%d%H%M%S&gt;-${slug}.org"</span> <span style="font-style: italic;">"#+title: ${title}\n#+filetags: Project"</span>))
        ))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ace107" class="outline-3">
<h3 id="org6ace107"><span class="section-number-3">2.8.</span> org-roam-ui</h3>
<div class="outline-text-3" id="text-2-8">
<p>
org-roam-uiは関係グラフを表示するパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 45: </span>org-roam-ui</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-roam-ui</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 46: </span>更新日時を設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-roam-timestamps</span>)
(<span style="font-weight: bold;">setq</span> org-roam-timestamps-remember-timestamps nil)
(add-hook 'org-mode-hook 'org-roam-timestamps-mode)
</pre>
</div>
</div>
</div>
<div id="outline-container-org256b5f1" class="outline-3">
<h3 id="org256b5f1"><span class="section-number-3">2.9.</span> org-alert</h3>
<div class="outline-text-3" id="text-2-9">
<p>
org-alertはorg scheduleの項目を時間経過で通知してくれるパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 47: </span>設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-alert</span>)
(<span style="font-weight: bold;">setq</span> alert-default-style 'notifications)
(<span style="font-weight: bold;">setq</span> org-alert-interval 300)
(<span style="font-weight: bold;">setq</span> org-alert-notification-title <span style="font-style: italic;">"Reminder"</span>)
(org-alert-enable)
</pre>
</div>
</div>
</div>
<div id="outline-container-orge62cea5" class="outline-3">
<h3 id="orge62cea5"><span class="section-number-3">2.10.</span> denote</h3>
<div class="outline-text-3" id="text-2-10">
<p>
denoteはシンプルなノートパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 48: </span>v3に追従できてないのでv2に固定する</label><pre class="src src-emacs-lisp">(add-to-list 'load-path <span style="font-style: italic;">"~/.emacs.d/vendor/denote-2.0.0"</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">denote</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">denote-org-dblock</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 49: </span>設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> denote-directory (expand-file-name <span style="font-style: italic;">"~/roam"</span>))
(<span style="font-weight: bold;">setq</span> denote-known-keywords '(<span style="font-style: italic;">"permanent"</span> <span style="font-style: italic;">"book"</span> <span style="font-style: italic;">"structure"</span> <span style="font-style: italic;">"project"</span> <span style="font-style: italic;">"wiki"</span> <span style="font-style: italic;">"essay"</span>))
(define-key global-map (kbd <span style="font-style: italic;">"C-c d"</span>) 'denote-create-note)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12459;&#12473;&#12479;&#12512;&#12486;&#12531;&#12503;&#12524;&#12540;&#12488;</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">roam&#12391;&#34920;&#31034;&#12391;&#12365;&#12427;ID&#12434;&#36861;&#21152;</span>
  (<span style="font-weight: bold;">setq</span> denote-org-front-matter
              <span style="font-style: italic;">":properties:</span>
<span style="font-style: italic;">:ID: %4$s</span>
<span style="font-style: italic;">:end:</span>
<span style="font-style: italic;">#+title:      KDOC n: %1$s</span>
<span style="font-style: italic;">#+date:       %2$s</span>
<span style="font-style: italic;">#+filetags:   :draft%3$s</span>
<span style="font-style: italic;">#+identifier: %4$s</span>
<span style="font-style: italic;">\n"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 50: </span>denoteのテンプレートを設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> denote-templates
      `((entry . ,(f-read-text <span style="font-style: italic;">"~/.emacs.d/resources/entry.org"</span>))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 51: </span>候補に出ないようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> denote-excluded-files-regexp <span style="font-style: italic;">".*html$"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 52: </span>確認を非表示にする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> denote-rename-confirmations nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org442f2dc" class="outline-3">
<h3 id="org442f2dc"><span class="section-number-3">2.11.</span> org-agenda</h3>
<div class="outline-text-3" id="text-2-11">
<p>
org-agendaはorg-modeでtodo管理する機能。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 53: </span>キーバインド</label><pre class="src src-emacs-lisp">(define-key global-map <span style="font-style: italic;">"\C-cl"</span> 'org-store-link)
(define-key global-map <span style="font-style: italic;">"\C-ca"</span> 'org-agenda)
(define-key global-map <span style="font-style: italic;">"\C-cc"</span> 'org-capture)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">org-agenda-default</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">mini-buffer&#12434;&#38283;&#12356;&#12390;&#12356;&#12427;&#38291;&#12395;persp-switch&#12364;&#36208;&#12427;&#12392;&#12289;&#12503;&#12525;&#12531;&#12503;&#12488;&#12364;&#27531;&#12426;&#32154;&#12369;&#12427;&#12398;&#12434;&#38450;&#12368;</span>
  (<span style="font-weight: bold;">when</span> (window-minibuffer-p)
    (minibuffer-keyboard-quit))
  (persp-switch <span style="font-style: italic;">"2"</span>)
  (org-agenda nil <span style="font-style: italic;">"z"</span>))
(global-set-key (kbd <span style="font-style: italic;">"&lt;f6&gt;"</span>) 'org-agenda-default)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 54: </span>フック</label><pre class="src src-emacs-lisp">(add-hook 'org-pomodoro-short-break-finished-hook 'org-agenda-default)
(add-hook 'org-pomodoro-long-break-finished-hook 'org-agenda-default)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 55: </span>org-captureするときのテンプレート</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-capture-templates
      '((<span style="font-style: italic;">"m"</span> <span style="font-style: italic;">"Memo"</span> entry
         (file+headline my-todo-file <span style="font-style: italic;">"Memo"</span>)
         <span style="font-style: italic;">"** %?\n"</span>)
        (<span style="font-style: italic;">"t"</span> <span style="font-style: italic;">"Task"</span> entry
         (file+headline my-todo-file <span style="font-style: italic;">"Tasks"</span>)
         <span style="font-style: italic;">"** TODO %?\n"</span>)
        (<span style="font-style: italic;">"p"</span> <span style="font-style: italic;">"Protocol"</span> entry
         (file+headline my-todo-file <span style="font-style: italic;">"Inbox"</span>)
         <span style="font-style: italic;">"* %^{Title}\nSource: %u, %c\n #+BEGIN_QUOTE\n%i\n#+END_QUOTE\n\n\n%?"</span>)
        (<span style="font-style: italic;">"L"</span> <span style="font-style: italic;">"Protocol Link"</span> entry
         (file+headline my-todo-file <span style="font-style: italic;">"Inbox"</span>)
         <span style="font-style: italic;">"* %?[[%:link][%:description]]"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 56: </span>完了したときの時刻を記録する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-log-done t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 57: </span>agenda対象のディレクトリを指定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">let*</span> ((my-org-directory (concat <span style="font-style: italic;">"~/Private/junk/diary/org-journal/"</span>))
       (my-todo-file (concat my-org-directory <span style="font-style: italic;">"todo.org"</span>))
       (my-roam-file <span style="font-style: italic;">"~/roam"</span>)
       (my-agenda-files nil))

  (<span style="font-weight: bold;">if</span> (file-exists-p my-todo-file)
      (<span style="font-weight: bold;">setq</span> my-agenda-files (<span style="font-weight: bold;">push</span> my-todo-file my-agenda-files)))
  (<span style="font-weight: bold;">if</span> (file-exists-p my-roam-file)
      (<span style="font-weight: bold;">setq</span> my-agenda-files (<span style="font-weight: bold;">push</span> my-roam-file my-agenda-files)))
  (<span style="font-weight: bold;">setq</span> org-agenda-files my-agenda-files)
  (<span style="font-weight: bold;">setq</span> org-directory my-org-directory)
  (<span style="font-weight: bold;">setq</span> org-default-notes-file my-todo-file))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 58: </span>時刻をデフォルト表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-agenda-start-with-log-mode t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 59: </span>7日分の予定を表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-agenda-span 14)
(<span style="font-weight: bold;">setq</span> org-agenda-start-day <span style="font-style: italic;">"7d"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 60: </span>agendaには、習慣・スケジュール・TODOを表示させる</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-agenda-custom-commands
      '((<span style="font-style: italic;">"z"</span> <span style="font-style: italic;">"Super zaen view"</span>
         ((agenda <span style="font-style: italic;">""</span> ((org-agenda-span 'day)
                      (org-super-agenda-groups
                       '((<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#127959;&#65039;Today"</span>
                                <span style="font-weight: bold;">:time-grid</span> t
                                <span style="font-weight: bold;">:date</span> today
                                <span style="font-weight: bold;">:scheduled</span> today
                                <span style="font-weight: bold;">:order</span> 1)
                         (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Overdue"</span>
                                <span style="font-weight: bold;">:deadline</span> past
                                <span style="font-weight: bold;">:scheduled</span> past
                                <span style="font-weight: bold;">:order</span> 3)
                         (<span style="font-weight: bold;">:habit</span> t)
                         (<span style="font-weight: bold;">:log</span> t)
                         (<span style="font-weight: bold;">:discard</span> (<span style="font-weight: bold;">:anything</span>))))))
          (alltodo <span style="font-style: italic;">""</span> ((org-agenda-overriding-header <span style="font-style: italic;">""</span>)
                       (org-super-agenda-groups
                        '((<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#9654;&#65039;Work In Progress"</span>
                                 <span style="font-weight: bold;">:todo</span> <span style="font-style: italic;">"WIP"</span>
                                 <span style="font-weight: bold;">:order</span> 1)
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#128294;Next"</span>
                                 <span style="font-weight: bold;">:effort&gt;</span> <span style="font-style: italic;">"0:01"</span>
                                 <span style="font-weight: bold;">:order</span> 5)
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#9997;To write"</span>
                                 <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"Write"</span>
                                 <span style="font-weight: bold;">:order</span> 12)
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#128213;To read"</span>
                                 <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"Read"</span>
                                 <span style="font-weight: bold;">:order</span> 14)
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#9997;Things I Don't Know"</span>
                                 <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"DontKnow"</span>
                                 <span style="font-weight: bold;">:order</span> 15)
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#128740;&#65039;Train"</span>
                                 <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"Train"</span>
                                 <span style="font-weight: bold;">:order</span> 18)
                         (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"&#127861;TODO"</span>
                                <span style="font-weight: bold;">:todo</span> <span style="font-style: italic;">"TODO"</span>
                                <span style="font-weight: bold;">:order</span> 20)
                          (<span style="font-weight: bold;">:discard</span> (<span style="font-weight: bold;">:anything</span> t))))))))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 61: </span>agenda内でRで出るclocktableを設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-clocktable-defaults '(<span style="font-weight: bold;">:maxlevel</span> 3 <span style="font-weight: bold;">:scope</span> agenda <span style="font-weight: bold;">:tags</span> <span style="font-style: italic;">""</span> <span style="font-weight: bold;">:block</span> today <span style="font-weight: bold;">:step</span> day <span style="font-weight: bold;">:stepskip0</span> true <span style="font-weight: bold;">:fileskip0</span> true))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 62: </span>外観設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> spacemacs-theme-org-agenda-height nil
      org-agenda-skip-scheduled-if-done t
      org-agenda-skip-deadline-if-done t
      org-agenda-include-deadlines t
      org-agenda-include-diary t
      org-agenda-block-separator nil
      org-agenda-compact-blocks t
      org-agenda-start-with-log-mode t
      org-habit-following-days 7
      org-habit-preceding-days 10
      org-habit-graph-column 80 <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#35211;&#20986;&#12375;&#12364;&#38560;&#12428;&#12427;&#12383;&#12417;</span>
      org-habit-show-habits t)
</pre>
</div>

<ul class="org-ul">
<li>org-roamの長いファイル名が表示されてうざいので省略する</li>
<li>フォーマットのeはorg-effort</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 63: </span>agendaでorg-roamファイルの表示をきれいにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-agenda-prefix-format
      `((agenda . <span style="font-style: italic;">" %i %-12(vulpea-agenda-category)%?-12t% s"</span>)
        (todo . <span style="font-style: italic;">" %i %-12(vulpea-agenda-category)%?-12t%-6e% s"</span>)
        (tags . <span style="font-style: italic;">" %i %-12(vulpea-agenda-category) "</span>)
        (search . <span style="font-style: italic;">" %i %-12(vaulpea-agenda-category) "</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">original -&gt; https://d12frosted.io/posts/2020-06-24-task-management-with-roam-vol2.html</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">vulpea-agenda-category</span> ()
  (<span style="font-weight: bold;">let*</span> ((title (vulpea-buffer-prop-get <span style="font-style: italic;">"title"</span>)))
    title))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">vulpea-buffer-prop-get</span> (name)
  <span style="font-style: italic;">"Get a buffer property called NAME as a string."</span>
  (<span style="font-weight: bold;">org-with-point-at</span> 1
    (<span style="font-weight: bold;">if</span> (re-search-forward (concat <span style="font-style: italic;">"^#\\+"</span> name <span style="font-style: italic;">": </span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(</span><span style="font-style: italic;">.*</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-style: italic;">"</span>)
                           (point-max) t)
        (buffer-substring-no-properties
         (match-beginning 1)
         (match-end 1))
      <span style="font-style: italic;">""</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org499fa7c" class="outline-3">
<h3 id="org499fa7c"><span class="section-number-3">2.12.</span> org-super-agenda</h3>
<div class="outline-text-3" id="text-2-12">
<p>
org-super-agendaは詳細に設定できるagenda表示ができるパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 64: </span>グループ設定例</label><pre class="src src-emacs-lisp">(org-super-agenda-mode)

(<span style="font-weight: bold;">let</span> ((org-super-agenda-groups
       '(<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Each group has an implicit boolean OR operator between its selectors.</span>
         (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Today"</span>  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Optionally specify section name</span>
                <span style="font-weight: bold;">:time-grid</span> t  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Items that appear on the time grid</span>
                <span style="font-weight: bold;">:todo</span> <span style="font-style: italic;">"TODAY"</span>)  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Items that have this TODO keyword</span>
         (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Important"</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Single arguments given alone</span>
                <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"bills"</span>
                <span style="font-weight: bold;">:priority</span> <span style="font-style: italic;">"A"</span>)
         (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"WIP"</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Single arguments given alone</span>
                <span style="font-weight: bold;">:todo</span> <span style="font-style: italic;">"WIP"</span>)
         <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set order of multiple groups at once</span>
         (<span style="font-weight: bold;">:order-multi</span> (2 (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Shopping in town"</span>
                                 <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Boolean AND group matches items that match all subgroups</span>
                                 <span style="font-weight: bold;">:and</span> (<span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"shopping"</span> <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"@town"</span>))
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Food-related"</span>
                                 <span style="font-weight: bold;">:habit</span> t
                                 <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Multiple args given in list with implicit OR</span>
                                 <span style="font-weight: bold;">:tag</span> (<span style="font-style: italic;">"food"</span> <span style="font-style: italic;">"dinner"</span>))
                          (<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Space-related (non-moon-or-planet-related)"</span>
                                 <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Regexps match case-insensitively on the entire entry</span>
                                 <span style="font-weight: bold;">:and</span> (<span style="font-weight: bold;">:regexp</span> (<span style="font-style: italic;">"space"</span> <span style="font-style: italic;">"NASA"</span>)
                                               <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Boolean NOT also has implicit OR between selectors</span>
                                               <span style="font-weight: bold;">:not</span> (<span style="font-weight: bold;">:regexp</span> <span style="font-style: italic;">"moon"</span> <span style="font-weight: bold;">:tag</span> <span style="font-style: italic;">"planet"</span>)))))
         <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Groups supply their own section names when none are given</span>
         (<span style="font-weight: bold;">:todo</span> (<span style="font-style: italic;">"SOMEDAY"</span> <span style="font-style: italic;">"TO-READ"</span> <span style="font-style: italic;">"TO-WRITE"</span> <span style="font-style: italic;">"CHECK"</span> <span style="font-style: italic;">"TO-WATCH"</span> <span style="font-style: italic;">"WATCHING"</span>)
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Show this group at the end of the agenda (since it has the</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">highest number). If you specified this group last, items</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">with these todo keywords that e.g. have priority A would be</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">displayed in that group instead, because items are grouped</span>
                <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">out in the order the groups are listed.</span>
                <span style="font-weight: bold;">:order</span> 9)
         (<span style="font-weight: bold;">:priority&lt;=</span> <span style="font-style: italic;">"B"</span>
                      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Show this section after "Today" and "Important", because</span>
                      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">their order is unspecified, defaulting to 0. Sections</span>
                      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">are displayed lowest-number-first.</span>
                      <span style="font-weight: bold;">:order</span> 1)
         <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">After the last group, the agenda will display items that didn't</span>
         <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">match any of these groups, with the default order position of 99</span>
         )))
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(org-agenda nil "a")</span>
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org06456e6" class="outline-3">
<h3 id="org06456e6"><span class="section-number-3">2.13.</span> org-pomodoro</h3>
<div class="outline-text-3" id="text-2-13">
<p>
org-pomodoro用の設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 65: </span>基本設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">org-pomodoro</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 66: </span>キーバインド</label><pre class="src src-emacs-lisp">(define-key global-map [insert] 'org-pomodoro)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 67: </span>時間の長さ</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-pomodoro-short-break-length 0)
(<span style="font-weight: bold;">setq</span> org-pomodoro-long-break-length 10)
(<span style="font-weight: bold;">setq</span> org-pomodoro-expiry-time 120)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 68: </span>サウンド</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-pomodoro-finished-sound <span style="font-style: italic;">"~/.emacs.d/resources/atos.wav"</span>)
(<span style="font-weight: bold;">setq</span> org-pomodoro-short-break-sound <span style="font-style: italic;">"~/.emacs.d/resources/atos.wav"</span>)
(<span style="font-weight: bold;">setq</span> org-pomodoro-long-break-sound <span style="font-style: italic;">"~/.emacs.d/resources/atos.wav"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12486;&#12473;&#12488;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(org-pomodoro-finished)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(org-pomodoro-short-break-finished)</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 69: </span>タイマーが終了したときにagendaに切り替える</label><pre class="src src-emacs-lisp">(add-hook 'org-pomodoro-short-break-finished-hook 'org-agenda-default)
(add-hook 'org-pomodoro-long-break-finished-hook 'org-agenda-default)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 70: </span>モードラインに表示する経過時間を今日限定にする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-clock-mode-line-total 'all)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 71: </span>polybarにpomodoro情報を表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/org-pomodoro-remain-gauge</span> (max-minutes)
  <span style="font-style: italic;">"Display remain time gauge."</span>
  (<span style="font-weight: bold;">let*</span> ((display-len 25)
         (remaining-minutes (/ (org-pomodoro-remaining-seconds) 60))
         (current-percent (/ remaining-minutes max-minutes))
         (done (truncate (* (- 1 current-percent) display-len)))
         (will (truncate (* current-percent display-len))))
    (concat
     <span style="font-style: italic;">"%{T2}"</span>
     <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(concat "%{F#008000}" (make-string done ?&#9608;) "%{F-}")</span>
     (concat <span style="font-style: italic;">"%{F#008000}"</span> (make-string done ?|) <span style="font-style: italic;">"%{F-}"</span>)
     (concat <span style="font-style: italic;">"%{F#413839}"</span> (make-string will ?|) <span style="font-style: italic;">"%{F-}"</span>)
     <span style="font-style: italic;">"%{T-}"</span>)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/org-pomodoro-time</span> ()
  <span style="font-style: italic;">"Return the remaining pomodoro time. Function for displaying in Polybar."</span>
  (<span style="font-weight: bold;">cond</span>
   ((org-pomodoro-active-p) (<span style="font-weight: bold;">cl-case</span> org-pomodoro-state
                              (<span style="font-weight: bold;">:pomodoro</span>
                               (format <span style="font-style: italic;">"%s %dm %s%s%s"</span>
                                       (kd/org-pomodoro-remain-gauge org-pomodoro-length)
                                       (/ (org-pomodoro-remaining-seconds) 60)
                                       <span style="font-style: italic;">"%{F#000000}"</span>
                                       org-clock-heading
                                       <span style="font-style: italic;">"%{F-}"</span>
                                       ))
                              (<span style="font-weight: bold;">:short-break</span>
                               (format <span style="font-style: italic;">"%s &#61476;Short break: %dm"</span>
                                       (kd/org-pomodoro-remain-gauge org-pomodoro-short-break-length)
                                       (/ (org-pomodoro-remaining-seconds) 60)))
                              (<span style="font-weight: bold;">:long-break</span>
                               (format <span style="font-style: italic;">"%s &#61476;Long break: %dm"</span>
                                       (kd/org-pomodoro-remain-gauge org-pomodoro-long-break-length)
                                       (/ (org-pomodoro-remaining-seconds) 60)))
                              (<span style="font-weight: bold;">:overtime</span>
                               (format <span style="font-style: italic;">"&#61561;Overtime! %dm"</span> (/ (org-pomodoro-remaining-seconds) 60)))
                              ))
   ((org-clocking-p) (format <span style="font-style: italic;">"(%s) %s"</span> (org-clock-get-clocked-time) org-clock-heading))
   (t <span style="font-style: italic;">"OFF"</span>)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/effort-timer</span> ()
  (<span style="font-weight: bold;">cond</span>
   ((<span style="font-weight: bold;">and</span> (not org-clock-effort) (<span style="font-weight: bold;">or</span> (org-pomodoro-active-p) (org-clocking-p)) <span style="font-style: italic;">"[effort not set]"</span>))
   ((<span style="font-weight: bold;">and</span> org-clock-effort (<span style="font-weight: bold;">or</span> (org-pomodoro-active-p) (org-clocking-p))) (format <span style="font-style: italic;">"[%s/%s]"</span> (org-duration-from-minutes (org-clock-get-clocked-time)) org-clock-effort))
   (t <span style="font-style: italic;">""</span>)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/pmd-today-point-display</span> ()
  (<span style="font-weight: bold;">let*</span> ((all-minute (* kd/pmd-today-point 25))
         (hour (/ all-minute 60))
         (minute (% all-minute 60)))
    (format
     <span style="font-style: italic;">" %s &#61874;%dpts/%02dh%02dm"</span>
     (kd/effort-timer)
     kd/pmd-today-point
     hour
     minute
     )))
</pre>
</div>

<ul class="org-ul">
<li><a href="https://colekillian.com/posts/org-pomodoro-and-polybar/">https://colekillian.com/posts/org-pomodoro-and-polybar/</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 72: </span>今日のポイントをカウントする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">kd/pmd-today-point</span> 0)
(add-hook 'org-pomodoro-finished-hook
          (<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">setq</span> kd/pmd-today-point (1+ kd/pmd-today-point))))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/write-pmd</span> (str)
  (shell-command (format <span style="font-style: italic;">"echo '</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">%s</span><span style="font-style: italic;">' &gt;&gt; ~/roam/pmd.csv"</span> str)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">reset point</span>
(run-at-time <span style="font-style: italic;">"23:59pm"</span> (* 24 60 60) (<span style="font-weight: bold;">lambda</span> ()
                                      (<span style="font-weight: bold;">when</span> (&gt; kd/pmd-today-point 0)
                                        (kd/write-pmd (concat (format-time-string <span style="font-style: italic;">"%Y-%m-%d"</span>)
                                                              <span style="font-style: italic;">", "</span>
                                                              (number-to-string kd/pmd-today-point)))
                                        (<span style="font-weight: bold;">setq</span> kd/pmd-today-point 0)
                                        (message <span style="font-style: italic;">"pomodoro count reset!"</span>))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 73: </span>ポモドーロのカウントを手動で変更する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/pmd-manual</span> ()
  <span style="font-style: italic;">"set point manually"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((point (read-from-minibuffer <span style="font-style: italic;">"How much point? "</span>)))
    (<span style="font-weight: bold;">setq</span> kd/pmd-today-point (string-to-number point))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5d05d3d" class="outline-3">
<h3 id="org5d05d3d"><span class="section-number-3">2.14.</span> org-effort</h3>
<div class="outline-text-3" id="text-2-14">
<ul class="org-ul">
<li>org-clock-effort</li>
<li>mode-line-format</li>
<li>org-pomodoro-mode-line</li>
</ul>
</div>
</div>

<div id="outline-container-org9308cc0" class="outline-3">
<h3 id="org9308cc0"><span class="section-number-3">2.15.</span> org-tag</h3>
<div class="outline-text-3" id="text-2-15">
<p>
タグを選択できるようにする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 74: </span>タグのプリセット</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> org-tag-alist '((<span style="font-style: italic;">"Write"</span> . ?w)
                      (<span style="font-style: italic;">"Read"</span> . ?r)
                      (<span style="font-style: italic;">"DontKnow"</span> . ?d)
                      (<span style="font-style: italic;">"Train"</span> . ?t)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org67627c7" class="outline-3">
<h3 id="org67627c7"><span class="section-number-3">2.16.</span> Mermaid</h3>
<div class="outline-text-3" id="text-2-16">
<p>
Mermaid JSはテキストから図を描画するライブラリ。
</p>

<p>
コマンドをインストールすることなく実行するためにDockerを使う設定。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">mermaid-mode</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> mermaid-mmdc-location <span style="font-style: italic;">"docker"</span>)
(<span style="font-weight: bold;">setq</span> mermaid-flags '(concat <span style="font-style: italic;">"run --rm -u 1000 -v /tmp:/tmp -v "</span>
                            (projectile-project-root)
                            <span style="font-style: italic;">":"</span>
                            (projectile-project-root)
                            <span style="font-style: italic;">" ghcr.io/mermaid-js/mermaid-cli/mermaid-cli:9.1.6"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 75: </span>mermaidをdockerで実行するときの引数指定が間違っているので直す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">org-babel-execute:mermaid</span> (body params)
  <span style="font-style: italic;">"Execute command with BODY and PARAMS from src block."</span>
  (<span style="font-weight: bold;">let*</span> ((out-file (<span style="font-weight: bold;">or</span> (cdr (assoc <span style="font-weight: bold;">:file</span> params))
                       (<span style="font-weight: bold;">error</span> <span style="font-style: italic;">"Mermaid requires a \":file\" header argument"</span>)))
         (temp-file (org-babel-temp-file <span style="font-style: italic;">"mermaid-"</span>))
         (cmd (concat (shell-quote-argument mermaid-mmdc-location)
                      <span style="font-style: italic;">" "</span> (eval mermaid-flags)
                      <span style="font-style: italic;">" -o "</span> (org-babel-process-file-name out-file)
                      <span style="font-style: italic;">" -i "</span> temp-file
                      )))
    (<span style="font-weight: bold;">with-temp-file</span> temp-file (insert body))
    (org-babel-eval cmd <span style="font-style: italic;">""</span>)
    nil))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 76: </span>ファイル名を自動生成するコマンド</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/random-alnum</span> ()
  (<span style="font-weight: bold;">let*</span> ((alnum <span style="font-style: italic;">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>)
         (i (% (abs (random)) (length alnum))))
    (substring alnum i (1+ i))))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/random-letter-string</span> (num)
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((str <span style="font-style: italic;">""</span>))
    (<span style="font-weight: bold;">dotimes</span> (num num)
      (<span style="font-weight: bold;">setq</span> str (concat str (kd/random-alnum)))
      )
    str))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/timestamp</span> ()
  (<span style="font-weight: bold;">let*</span> ((date org-agenda-current-date)
         (y (nth 2 date))
         (d (nth 1 date))
         (m (nth 0 date))
         (time (format-time-string <span style="font-style: italic;">"%H%M%S"</span> (current-time))))
    (format <span style="font-style: italic;">"%04d%02d%02d%s"</span> y m d time)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/insert-rand-png</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (insert (concat <span style="font-style: italic;">"images/"</span> (kd/timestamp) <span style="font-style: italic;">"-"</span> (kd/random-letter-string 10) <span style="font-style: italic;">".png"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 77: </span>実行したあと画像をインライン表示</label><pre class="src src-emacs-lisp">(add-hook 'org-babel-after-execute-hook 'org-redisplay-inline-images)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7a2b903" class="outline-2">
<h2 id="org7a2b903"><span class="section-number-2">3.</span> Font</h2>
<div class="outline-text-2" id="text-3">
<p>
フォント設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 78: </span>OSごとのフォント</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">progn</span>
    (<span style="font-weight: bold;">pcase</span> system-type
      ((<span style="font-weight: bold;">or</span> 'gnu/linux 'windows-nt 'cygwin)
       (set-face-attribute 'default nil
                           <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"Fira Code"</span>
                           <span style="font-weight: bold;">:weight</span> 'regular
                           <span style="font-weight: bold;">:height</span> 110)
       (set-fontset-font
        nil 'japanese-jisx0208
        (font-spec <span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Hiragino Sans"</span>)))
      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Mac</span>
      ('darwin
       (set-face-attribute 'default nil
                           <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"Fira Mono"</span>
                           <span style="font-weight: bold;">:height</span> 150)
       (set-fontset-font
        nil 'japanese-jisx0208
        (font-spec <span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Hiragino Sans"</span>))))))
</pre>
</div>

<p>
いい感じのフォントリスト。
</p>

<ul class="org-ul">
<li>JetBrains Mono</li>
<li>Iosevka SS08</li>
<li>Fira Mono</li>
<li>Fira Code</li>
<li>Hiragino Sans &#x2013; japanese</li>
<li>Hack</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 79: </span>utf-8を使用する</label><pre class="src src-emacs-lisp">(prefer-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 80: </span>utf-8を使用する</label><pre class="src src-emacs-lisp">(set-language-environment 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 81: </span>ターミナルの文字コード</label><pre class="src src-emacs-lisp">(set-terminal-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 82: </span>キーボードから入力される文字コード</label><pre class="src src-emacs-lisp">(set-keyboard-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 83: </span>ファイルのバッファのデフォルト文字コード</label><pre class="src src-emacs-lisp">(set-buffer-file-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 84: </span>バッファのプロセスの文字コード</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> default-buffer-file-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 85: </span>ファイルの文字コード</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> file-name-coding-system 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 86: </span>新規作成ファイルの文字コード</label><pre class="src src-emacs-lisp">(set-default-coding-systems 'utf-8)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 87: </span>絵文字フォント</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">--set-emoji-font</span> (frame)
  <span style="font-style: italic;">"Adjust the font settings of FRAME so Emacs can display emoji properly."</span>
  (<span style="font-weight: bold;">if</span> (eq system-type 'darwin)
      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">For NS/Cocoa</span>
      (set-fontset-font t 'symbol (font-spec <span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Apple Color Emoji"</span>) frame 'prepend)
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">For Linux</span>
    (set-fontset-font t 'symbol (font-spec <span style="font-weight: bold;">:family</span> <span style="font-style: italic;">"Symbola"</span>) frame 'prepend)))

(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">progn</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GUI&#29992;&#35373;&#23450;</span>
    (--set-emoji-font nil)
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Hook for when a frame is created with emacsclient</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">see https://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Frames.html</span>
    (add-hook 'after-make-frame-functions '--set-emoji-font)

    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">unicodefont</span>
    (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">unicode-fonts</span>)
    (unicode-fonts-setup)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0c0466" class="outline-2">
<h2 id="orgb0c0466"><span class="section-number-2">4.</span> Simple</h2>
<div class="outline-text-2" id="text-4">
<p>
未分類の設定。最初から入っているものの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 88: </span>Emacs Server開始</label><pre class="src src-emacs-lisp">(server-start)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 89: </span>*scratch*で最初に描画されるメッセージを消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> initial-scratch-message <span style="font-style: italic;">""</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 90: </span>終了時に確認しない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> confirm-kill-processes nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 91: </span>メニューバーを消す</label><pre class="src src-emacs-lisp">(menu-bar-mode 0)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 92: </span>対応する括弧をハイライト</label><pre class="src src-emacs-lisp">(show-paren-mode t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 93: </span>起動時のメッセージ非表示</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> inhibit-startup-message t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 94: </span>保存時のmessage非表示</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> save-silently t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 95: </span>font-lockをどこでも有効にする</label><pre class="src src-emacs-lisp">(global-font-lock-mode t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 96: </span>タイトルにフルパス表示</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> frame-title-format <span style="font-style: italic;">"%f"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 97: </span>ビープ音を出さない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ring-bell-function 'ignore)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 98: </span>スクロールバーを消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">scroll-bar</span>)
(scroll-bar-mode 0)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 99: </span>対応カッコを表示する</label><pre class="src src-emacs-lisp">(show-paren-mode t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 100: </span>ツールバーを消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">tool-bar</span>)
(tool-bar-mode 0)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 101: </span>ツールチップを消す</label><pre class="src src-emacs-lisp">(tooltip-mode 0)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 102: </span>１行スクロール</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"M-n"</span>) (<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (scroll-up 1)))
(global-set-key (kbd <span style="font-style: italic;">"M-p"</span>) (<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (scroll-down 1)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 103: </span>バックスペースをC-hに割り当てる</label><pre class="src src-emacs-lisp">(keyboard-translate ?\C-h ?\C-?)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 104: </span>ワードカウントをC-x p に割当</label><pre class="src src-emacs-lisp">(global-set-key <span style="font-style: italic;">"\C-xp"</span> 'count-words)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 105: </span>windowの大きさ変更</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-M-{"</span>) 'shrink-window-horizontally)
(global-set-key (kbd <span style="font-style: italic;">"C-M-}"</span>) 'enlarge-window-horizontally)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 106: </span>yesかnoではなく、yかnかで答えられるようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defalias</span> '<span style="font-weight: bold;">yes-or-no-p</span> 'y-or-n-p)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 107: </span>終了してしまう事故防止</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> confirm-kill-emacs 'y-or-n-p)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 108: </span>リンクを聞かずに開く</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> vc-follow-symlinks t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 109: </span>カッコの補完</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">smartparens</span>)
(add-hook 'prog-mode-hook 'smartparens-mode)
(add-hook 'eshell-mode-hook 'smartparens-mode)
(add-hook 'org-mode-hook 'smartparens-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 110: </span>messageログの記録数</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> message-log-max 1000)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 111: </span>履歴の保存数</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> history-length 500)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 112: </span>重複する履歴は保存しない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> history-delete-duplicates t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 113: </span>バックアップファイルを作らない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> backup-inhibited t)
(<span style="font-weight: bold;">setq</span> make-backup-files nil)
(<span style="font-weight: bold;">setq</span> auto-save-default nil)
(<span style="font-weight: bold;">setq</span> create-lockfiles nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 114: </span>終了時にオートセーブファイルを削除</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> delete-auto-save-files t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 115: </span>オートセーブ</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> auto-save-timeout 2)
(<span style="font-weight: bold;">setq</span> auto-save-visited-interval 2)
(<span style="font-weight: bold;">setq</span> auto-save-no-message t)
(auto-save-visited-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 116: </span>右から左に読む言語に対応させないことで描画高速化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq-default</span> bidi-display-reordering nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 117: </span>splash screenを無効にする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> inhibit-splash-screen t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 118: </span>行番号の表示</label><pre class="src src-emacs-lisp">(display-line-numbers-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 119: </span>ediffを１ウィンドウで表示</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ediff-window-setup-function 'ediff-setup-windows-plain)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 120: </span>オートインデントでスペースを使う</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq-default</span> indent-tabs-mode nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 121: </span>クリップボードと同期</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> x-select-enable-primary t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 122: </span>空白を自動削除</label><pre class="src src-emacs-lisp">(add-hook 'before-save-hook 'delete-trailing-whitespace)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 123: </span>選択状態で入力すると上書き</label><pre class="src src-emacs-lisp">(delete-selection-mode t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 124: </span>メジャーモードのC-tキーバインドを無効化する</label><pre class="src src-emacs-lisp">(eval-after-load <span style="font-style: italic;">"django-mode"</span>
  '(progn
     (define-key django-mode-map (kbd <span style="font-style: italic;">"C-t"</span>) nil)))
(eval-after-load <span style="font-style: italic;">"dired"</span>
  '(progn
     (define-key dired-mode-map (kbd <span style="font-style: italic;">"C-t"</span>) nil)))
(eval-after-load <span style="font-style: italic;">"vterm"</span>
  '(progn
     (define-key vterm-mode-map (kbd <span style="font-style: italic;">"C-t"</span>) nil)
     (define-key vterm-mode-map (kbd <span style="font-style: italic;">"M-&lt;right&gt;"</span>) nil)
     (define-key vterm-mode-map (kbd <span style="font-style: italic;">"M-&lt;left&gt;"</span>) nil)
     (define-key vterm-mode-map (kbd <span style="font-style: italic;">"&lt;f9&gt;"</span>) nil)
     (define-key vterm-mode-map (kbd <span style="font-style: italic;">"C-&lt;f9&gt;"</span>) nil)))
(eval-after-load <span style="font-style: italic;">"magit"</span>
  '(progn
     (mapc (<span style="font-weight: bold;">lambda</span> (i)
             (define-key magit-mode-map (kbd (format <span style="font-style: italic;">"M-%d"</span> i)) nil))
           (number-sequence 1 4))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 125: </span>インクリメンタルサーチの挙動変更</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defadvice</span> <span style="font-weight: bold;">isearch-mode</span> (around isearch-mode-default-string (forward <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> regexp op-fun recursive-edit word-p) activate)
    (<span style="font-weight: bold;">if</span> (<span style="font-weight: bold;">and</span> transient-mark-mode mark-active (not (eq (mark) (point))))
        (<span style="font-weight: bold;">progn</span>
          (isearch-update-ring (buffer-substring-no-properties (mark) (point)))
          (deactivate-mark)
          ad-do-it
          (<span style="font-weight: bold;">if</span> (not forward)
              (isearch-repeat-backward)
            (goto-char (mark))
            (isearch-repeat-forward)))
      ad-do-it))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 126: </span>マウスホイールの挙動</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span>
   <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12507;&#12452;&#12540;&#12523;&#12391;&#12473;&#12463;&#12525;&#12540;&#12523;&#12377;&#12427;&#34892;&#25968;&#12434;&#35373;&#23450;</span>
   mouse-wheel-scroll-amount '(1 ((shift) . 2) ((control)))
   <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#36895;&#24230;&#12434;&#28961;&#35222;&#12377;&#12427;</span>
   mouse-wheel-progressive-speed nil)
  (<span style="font-weight: bold;">setq</span> scroll-preserve-screen-position 'always)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 127: </span>カーソルの点滅無効化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">if</span> (fboundp 'blink-cursor-mode)
      (blink-cursor-mode -1))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 128: </span>upcase-regionを有効化する</label><pre class="src src-emacs-lisp">(put 'upcase-region 'disabled nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 129: </span>非同期でwarningが出てくるのを抑制する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> native-comp-async-report-warnings-errors nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdc72da4" class="outline-2">
<h2 id="orgdc72da4"><span class="section-number-2">5.</span> Packages</h2>
<div class="outline-text-2" id="text-5">
<p>
未分類の設定。拡張設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 130: </span>履歴保存</label><pre class="src src-emacs-lisp">(savehist-mode 1)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 131: </span>永続化する変数を新たに追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">push</span> 'compile-command savehist-additional-variables)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 132: </span>永続化しないミニバッファ履歴の変数を追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">push</span> 'command-history savehist-ignored-variables)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 133: </span>カッコを色付けする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rainbow-delimiters</span>)
(rainbow-delimiters-mode t)
(add-hook 'prog-mode-hook 'rainbow-delimiters-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 134: </span>シンボルをハイライトする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">auto-highlight-symbol</span>)
(global-auto-highlight-symbol-mode t)
(ahs-set-idle-interval 0.4)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 135: </span>ahs-modeのキーバインドを無効化する</label><pre class="src src-emacs-lisp">(define-key auto-highlight-symbol-mode-map (kbd <span style="font-style: italic;">"M-&lt;right&gt;"</span>) nil)
(define-key auto-highlight-symbol-mode-map (kbd <span style="font-style: italic;">"M-&lt;left&gt;"</span>) nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 136: </span>スペース可視化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">whitespace</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#31354;&#30333;</span>
(set-face-foreground 'whitespace-space nil)
(set-face-background 'whitespace-space <span style="font-style: italic;">"gray33"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12501;&#12449;&#12452;&#12523;&#20808;&#38957;&#12392;&#26411;&#23614;&#12398;&#31354;&#34892;</span>
(set-face-background 'whitespace-empty <span style="font-style: italic;">"gray33"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12479;&#12502;</span>
(set-face-foreground 'whitespace-tab nil)
(set-face-background 'whitespace-tab <span style="font-style: italic;">"gray33"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">???</span>
(set-face-background 'whitespace-trailing <span style="font-style: italic;">"gray33"</span>)
(set-face-background 'whitespace-hspace <span style="font-style: italic;">"gray33"</span>)
(<span style="font-weight: bold;">setq</span> whitespace-style '(face           <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">face&#12391;&#21487;&#35222;&#21270;</span>
                         trailing       <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">&#34892;&#26411;</span>
                         tabs           <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">&#12479;&#12502;</span>
                         empty          <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">&#20808;&#38957;/&#26411;&#23614;&#12398;&#31354;&#34892;</span>
                         spaces         <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">&#31354;&#30333;</span>
                         <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">space-mark     ; &#34920;&#31034;&#12398;&#12510;&#12483;&#12500;&#12531;&#12464;</span>
                         tab-mark))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12473;&#12506;&#12540;&#12473;&#12399;&#20840;&#35282;&#12398;&#12415;&#12434;&#21487;&#35222;&#21270;</span>
(<span style="font-weight: bold;">setq</span> whitespace-space-regexp <span style="font-style: italic;">"</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(</span><span style="font-style: italic;">\u3000+</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-style: italic;">"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12479;&#12502;&#12398;&#34920;&#31034;&#12434;&#22793;&#26356;</span>
(<span style="font-weight: bold;">setq</span> whitespace-display-mappings
      '((tab-mark ?\t [?\xBB ?\t])))
(global-whitespace-mode 1)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 137: </span>インデント設定</label><pre class="src src-emacs-lisp">(add-hook 'emacs-lisp-mode-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (<span style="font-weight: bold;">setq</span> indent-tabs-mode nil)))

(<span style="font-weight: bold;">setq-default</span> typescript-indent-level 2)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 138: </span>ハイライトの表示を遅くして高速化する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">hl-line</span>)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">global-hl-line-timer-function</span> ()
  (global-hl-line-unhighlight-all)
  (<span style="font-weight: bold;">let</span> ((global-hl-line-mode t))
    (global-hl-line-highlight)))
(<span style="font-weight: bold;">setq</span> global-hl-line-timer
      (run-with-idle-timer 0.03 t 'global-hl-line-timer-function))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 139: </span>現在行をハイライトする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">hlline-face</span>
  '((((class color)
      (background dark))
     (<span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"DodgerBlue4"</span>))
    (((class color)
      (background light))
     (<span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"gainsboro"</span>))
    (t
     ()))
  <span style="font-style: italic;">"*Face used by hl-line."</span>)

(<span style="font-weight: bold;">setq</span> hl-line-face 'hlline-face)
(global-hl-line-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 140: </span>移動時にハイライトする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> beacon-size 20) <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">default 40</span>
(<span style="font-weight: bold;">setq</span> beacon-color <span style="font-style: italic;">"#827591"</span>)
(<span style="font-weight: bold;">setq</span> beacon-blink-when-focused t)
(beacon-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 141: </span>バッファ内ブックマーク</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq-default</span> bm-buffer-persistence nil)
(<span style="font-weight: bold;">setq</span> bm-restore-repository-on-load t)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">bm</span>)
(add-hook 'find-file-hook 'bm-buffer-restore)
(add-hook 'kill-buffer-hook 'bm-buffer-save)
(add-hook 'after-save-hook 'bm-buffer-save)
(add-hook 'after-revert-hook 'bm-buffer-restore)
(add-hook 'vc-before-checkin-hook 'bm-buffer-save)
(add-hook 'kill-emacs-hook '(lambda nil
                              (bm-buffer-save-all)
                              (bm-repository-save)))
(global-set-key (kbd <span style="font-style: italic;">"C-M-SPC"</span>) 'bm-toggle)
(global-set-key (kbd <span style="font-style: italic;">"M-["</span>) 'bm-previous)
(global-set-key (kbd <span style="font-style: italic;">"M-]"</span>) 'bm-next)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 142: </span>カーソル移動のキーバインド</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"M-&lt;left&gt;"</span>) 'previous-buffer)
(global-set-key (kbd <span style="font-style: italic;">"M-&lt;right&gt;"</span>) 'next-buffer)
(global-set-key (kbd <span style="font-style: italic;">"C-t"</span>) 'other-window)
(global-set-key (kbd <span style="font-style: italic;">"M-t"</span>) (<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (other-window -1)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 143: </span>ace-jump-mode</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ace-jump-mode</span>)
(<span style="font-weight: bold;">setq</span> ace-jump-mode-gray-background nil)
(<span style="font-weight: bold;">setq</span> ace-jump-word-mode-use-query-char nil)
(<span style="font-weight: bold;">setq</span> ace-jump-mode-move-keys
      (append <span style="font-style: italic;">"asdfghjkl;:]qwertyuiop@zxcvbnm,."</span> nil))
(global-set-key (kbd <span style="font-style: italic;">"C-o"</span>) 'ace-jump-word-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 144: </span>ace-link</label><pre class="src src-emacs-lisp">(ace-link-setup-default)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 145: </span>avy</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">avy</span>)
(global-set-key (kbd <span style="font-style: italic;">"C-j"</span>) 'avy-copy-line)
(global-set-key (kbd <span style="font-style: italic;">"M-j"</span>) 'avy-goto-line)
(global-set-key (kbd <span style="font-style: italic;">"C-M-j"</span>) 'avy-goto-whitespace-end)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 146: </span>migemo</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">migemo</span>)
(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">and</span> (executable-find <span style="font-style: italic;">"cmigemo"</span>)
           (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">migemo</span> nil t))
  (<span style="font-weight: bold;">setq</span> migemo-command my-migemo-command)
  (<span style="font-weight: bold;">setq</span> migemo-options '(<span style="font-style: italic;">"-q"</span> <span style="font-style: italic;">"--emacs"</span>))
  (<span style="font-weight: bold;">setq</span> migemo-dictionary my-migemo-dictionary)
  (<span style="font-weight: bold;">setq</span> migemo-user-dictionary nil)
  (<span style="font-weight: bold;">setq</span> migemo-regex-dictionary nil)
  (<span style="font-weight: bold;">setq</span> migemo-coding-system 'utf-8-unix)
  (load-library <span style="font-style: italic;">"migemo"</span>)
  (migemo-init)
  )
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 147: </span>anzu</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">anzu</span>)
(global-anzu-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 148: </span>magit</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">magit</span>)
(global-set-key (kbd <span style="font-style: italic;">"C-x g"</span>) 'magit-status)
</pre>
</div>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 149: </span>git-gutter-mode</label><pre class="src src-emacs-lisp">(global-git-gutter-mode 1)
(global-set-key (kbd <span style="font-style: italic;">"C-c C-v"</span>) 'git-gutter:popup-hunk)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 150: </span>commit時にconvential commitを選択する</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">http://www.modernemacs.com/post/pretty-magit/</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/magit-commit-prompt</span> ()
  <span style="font-style: italic;">"Use ivy to insert conventional commit keyword."</span>
  (<span style="font-weight: bold;">let</span> ((conventional-prompt '((<span style="font-style: italic;">"build"</span> <span style="font-style: italic;">"&#12499;&#12523;&#12489;"</span>)
                               (<span style="font-style: italic;">"chore"</span> <span style="font-style: italic;">"&#38609;&#20107;, &#12459;&#12486;&#12468;&#12521;&#12452;&#12474;&#12377;&#12427;&#24517;&#35201;&#12394;&#12356;&#12424;&#12358;&#12394;&#12418;&#12398;"</span>)
                               (<span style="font-style: italic;">"ci"</span> <span style="font-style: italic;">"CI"</span>)
                               (<span style="font-style: italic;">"docs"</span> <span style="font-style: italic;">"&#12489;&#12461;&#12517;&#12513;&#12531;&#12488;"</span>)
                               (<span style="font-style: italic;">"feat"</span> <span style="font-style: italic;">"&#26032;&#27231;&#33021;"</span>)
                               (<span style="font-style: italic;">"fix"</span> <span style="font-style: italic;">"&#12496;&#12464;&#12501;&#12451;&#12483;&#12463;&#12473;"</span>)
                               (<span style="font-style: italic;">"perf"</span> <span style="font-style: italic;">"&#12497;&#12501;&#12457;&#12540;&#12510;&#12531;&#12473;"</span>)
                               (<span style="font-style: italic;">"refactor"</span> <span style="font-style: italic;">"&#12522;&#12501;&#12449;&#12463;&#12479;&#12522;&#12531;&#12464;"</span>)
                               (<span style="font-style: italic;">"revert"</span> <span style="font-style: italic;">"&#12467;&#12511;&#12483;&#12488;&#21462;&#12426;&#28040;&#12375;"</span>)
                               (<span style="font-style: italic;">"style"</span> <span style="font-style: italic;">"&#12467;&#12540;&#12489;&#12473;&#12479;&#12452;&#12523;&#20462;&#27491;"</span>)
                               (<span style="font-style: italic;">"test"</span> <span style="font-style: italic;">"&#12486;&#12473;&#12488;"</span>))))
    (insert (concat (ivy-read <span style="font-style: italic;">"Commit Type "</span>
                              (mapcar 'car conventional-prompt)
                              <span style="font-weight: bold;">:require-match</span> t
                              <span style="font-weight: bold;">:sort</span> t
                              <span style="font-weight: bold;">:preselect</span> <span style="font-style: italic;">"Add: "</span>)
                    <span style="font-style: italic;">": "</span>))))
(remove-hook 'git-commit-setup-hook 'with-editor-usage-message)
(add-hook 'git-commit-setup-hook 'kd/magit-commit-prompt)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 151: </span>mozc</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">mozc</span>)
(set-language-environment <span style="font-style: italic;">"Japanese"</span>)
(<span style="font-weight: bold;">setq</span> default-input-method <span style="font-style: italic;">"japanese-mozc"</span>)
(global-set-key (kbd <span style="font-style: italic;">"C-SPC"</span>) 'toggle-input-method)

(add-hook 'input-method-activate-hook
          (<span style="font-weight: bold;">lambda</span>() (set-cursor-color <span style="font-style: italic;">"Magenta"</span>)))
(add-hook 'input-method-deactivate-hook
          (<span style="font-weight: bold;">lambda</span>() (set-cursor-color <span style="font-style: italic;">"grey"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 152: </span>mozc-popup</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">mozc-popup</span>)
(<span style="font-weight: bold;">setq</span> mozc-candidate-style 'echo-area)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 153: </span>devdocs-search</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"&lt;f2&gt;"</span>) 'devdocs-search)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 154: </span>fish</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">fish-mode</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 155: </span>auto-insert</label><pre class="src src-emacs-lisp">(auto-insert-mode)
(<span style="font-weight: bold;">setq</span> auto-insert-directory <span style="font-style: italic;">"~/.emacs.d/insert/"</span>)
(<span style="font-weight: bold;">setq</span> auto-insert-alist
      (append '(
                (<span style="font-style: italic;">"\\.sh$"</span> . <span style="font-style: italic;">"shell-template.sh"</span>)
                ) <span style="font-weight: bold;">auto-insert-alist))</span>
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 156: </span>yasnippet</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">yasnippet</span>)
(add-to-list 'yas-snippet-dirs <span style="font-style: italic;">"~/.emacs.d/snippets"</span>)
(auto-insert-mode t)
(yas-global-mode t)
(<span style="font-weight: bold;">setq</span> yas-prompt-functions '(yas-ido-prompt))

(define-key yas-minor-mode-map (kbd <span style="font-style: italic;">"C-x y i"</span>) 'yas-insert-snippet)
(define-key yas-minor-mode-map (kbd <span style="font-style: italic;">"C-x y n"</span>) 'yas-new-snippet)
(define-key yas-minor-mode-map (kbd <span style="font-style: italic;">"C-x y v"</span>) 'yas-visit-snippet-file)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 157: </span>projectile</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">projectile</span>)
(projectile-global-mode)
(define-key projectile-mode-map (kbd <span style="font-style: italic;">"C-c p"</span>) 'projectile-command-map)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 158: </span>バッファ再読込</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">revert-buffer-no-confirm</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> force-reverting)
  <span style="font-style: italic;">"Interactive call to revert-buffer. Ignoring the auto-save</span>
<span style="font-style: italic;"> file and not requesting for confirmation. When the current buffer</span>
<span style="font-style: italic;"> is modified, the command refuses to revert it, unless you specify</span>
<span style="font-style: italic;"> the optional argument: force-reverting to true."</span>
  (<span style="font-weight: bold;">interactive</span> <span style="font-style: italic;">"P"</span>)
  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(message "force-reverting value is %s" force-reverting)</span>
  (<span style="font-weight: bold;">if</span> (<span style="font-weight: bold;">or</span> force-reverting (not (buffer-modified-p)))
      (revert-buffer <span style="font-weight: bold;">:ignore-auto</span> <span style="font-weight: bold;">:noconfirm</span>)
    (<span style="font-weight: bold;">error</span> <span style="font-style: italic;">"The buffer has been modified"</span>)))
(global-set-key (kbd <span style="font-style: italic;">"&lt;f5&gt;"</span>) 'revert-buffer-no-confirm)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 159: </span>変更があったら自動で更新</label><pre class="src src-emacs-lisp">(global-auto-revert-mode 1)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 160: </span>tramp</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">tramp</span>)
(<span style="font-weight: bold;">setq</span> tramp-default-method <span style="font-style: italic;">"ssh"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 161: </span>flycheck</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">flycheck</span>)
(<span style="font-weight: bold;">setq</span> flycheck-indication-mode 'right-fringe)
(add-hook 'flycheck-mode-hook #'flycheck-set-indication-mode)
(eval-after-load 'flycheck
  '(add-hook 'flycheck-mode-hook #'flycheck-cask-setup))

(add-hook 'emacs-lisp-mode-hook 'flycheck-mode)
(add-hook 'python-mode-hook 'flycheck-mode)
(add-hook 'ruby-mode-hook 'flycheck-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#33258;&#21205;&#36215;&#21205;</span>
(<span style="font-weight: bold;">setq</span> flycheck-check-syntax-automatically
      '(save idle-change mode-enabled))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12467;&#12540;&#12489;&#22793;&#26356;&#24460;&#12289;2&#31186;&#24460;&#12395;&#12481;&#12455;&#12483;&#12463;&#12377;&#12427;</span>
(<span style="font-weight: bold;">setq</span> flycheck-idle-change-delay 2)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 162: </span>which-key</label><pre class="src src-emacs-lisp">(which-key-mode)
(which-key-setup-side-window-bottom)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 163: </span>dired</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">dired&#12496;&#12483;&#12501;&#12449;&#12434;&#20081;&#31435;&#12373;&#12379;&#12394;&#12356;</span>
(<span style="font-weight: bold;">setq</span> dired-kill-when-opening-new-dired-buffer t)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">all-the-icons</span>)
(add-hook 'dired-mode-hook 'all-the-icons-dired-mode)
(add-hook 'dired-mode-hook 'dired-hide-details-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 164: </span>easy-kill</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">easy-kill</span>)
(global-set-key [remap kill-ring-save] 'easy-kill)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">easy-kill-extras</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">easy-kill-extras</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Upgrade `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">mark-word</span><span style="font-weight: bold; font-style: italic;">' and `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">mark-sexp</span><span style="font-weight: bold; font-style: italic;">' with easy-mark</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">equivalents.</span>
(global-set-key (kbd <span style="font-style: italic;">"M-@"</span>) 'easy-mark-word)
(global-set-key (kbd <span style="font-style: italic;">"C-M-@"</span>) 'easy-mark-sexp)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">`</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">easy-mark-to-char</span><span style="font-weight: bold; font-style: italic;">' or `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">easy-mark-up-to-char</span><span style="font-weight: bold; font-style: italic;">' could be a good</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">replacement for `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">zap-to-char</span><span style="font-weight: bold; font-style: italic;">'.</span>
(global-set-key [remap zap-to-char] 'easy-mark-to-char)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Add the following tuples to `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">easy-kill-alist</span><span style="font-weight: bold; font-style: italic;">', preferrably by</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">using `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">customize-variable</span><span style="font-weight: bold; font-style: italic;">'.</span>
(add-to-list 'easy-kill-alist '(?^ backward-line-edge <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?$ forward-line-edge <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?b buffer <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?&lt; buffer-before-point <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?&gt; buffer-after-point <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?f string-to-char-forward <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?F string-up-to-char-forward <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?t string-to-char-backward <span style="font-style: italic;">""</span>))
(add-to-list 'easy-kill-alist '(?T string-up-to-char-backward <span style="font-style: italic;">""</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 165: </span>command-log-mode</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">command-log-mode</span>)
(global-command-log-mode)

(<span style="font-weight: bold;">setq</span> clm/log-command-exceptions*
      '(mozc-handle-event self-insert-command))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 166: </span>elfeed</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">elfeed</span>)
(<span style="font-weight: bold;">setq</span> elfeed-feeds
      '((<span style="font-style: italic;">"https://www.sanityinc.com/feed.xml"</span> emacs)
        (<span style="font-style: italic;">"https://sachachua.com/blog/category/weekly/feed/"</span> emacs)
        (<span style="font-style: italic;">"http://pragmaticemacs.com/feed/"</span> emacs)
        (<span style="font-style: italic;">"https://techracho.bpsinc.jp/feed"</span> ruby rails)
        (<span style="font-style: italic;">"https://cprss.s3.amazonaws.com/rubyweekly.com.xml"</span> ruby)
        (<span style="font-style: italic;">"http://b.hatena.ne.jp/t-wada/rss"</span> test)
        (<span style="font-style: italic;">"https://efcl.info/feed/"</span> javascript)
        (<span style="font-style: italic;">"https://api.syosetu.com/writernovel/235132.Atom"</span> novel)
        (<span style="font-style: italic;">"https://anchor.fm/s/7cd923f4/podcast/rss"</span> podcast)
        (<span style="font-style: italic;">"https://hackerstations.com/index.xml"</span> programmer)
        (<span style="font-style: italic;">"https://medium.com/feed/a-journey-with-go"</span> go)
        (<span style="font-style: italic;">"https://dev.to/feed/go"</span> go)
        (<span style="font-style: italic;">"https://go.dev/blog/feed.atom?format=xml"</span> go)
        (<span style="font-style: italic;">"https://systemcrafters.net/rss/news.xml"</span> systemcrafters)
        (<span style="font-style: italic;">"http://benedict.co.jp/feed/"</span> benedict)

        (<span style="font-style: italic;">"https://mattn.kaoriya.net/index.rss"</span> blog)
        (<span style="font-style: italic;">"https://www.ryokatsu.dev/posts-feed.xml"</span> blog)
        (<span style="font-style: italic;">"https://blog.jnito.com/feed"</span> blog)
        (<span style="font-style: italic;">"https://blog.masterka.net/feed"</span> blog)
        (<span style="font-style: italic;">"https://sazak.io/rss.xml"</span> blog go)

        (<span style="font-style: italic;">"https://github.com/golang/go/releases.atom"</span> go release)
        (<span style="font-style: italic;">"https://github.com/moby/moby/releases.atom"</span> docker release)
        (<span style="font-style: italic;">"https://github.com/emacs-mirror/emacs/releases.atom"</span> emacs release)

        (<span style="font-style: italic;">"https://zenn.dev/hsaki/feed"</span> go)
        (<span style="font-style: italic;">"https://zenn.dev/satoru_takeuchi/feed"</span> linux)
        (<span style="font-style: italic;">"https://oraccha.hatenadiary.org/feed"</span> plan9)

        (<span style="font-style: italic;">"https://qiita.com/tenntenn/feed"</span> go)

        (<span style="font-style: italic;">"https://www.rfc-editor.org/rfcrss.xml"</span> rfc)
        (<span style="font-style: italic;">"https://www.docker.com/feed/"</span> docker)
        ))

(<span style="font-weight: bold;">setq</span> elfeed-search-title-max-width 120)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">default-browser</span>
(<span style="font-weight: bold;">setq</span> browse-url-browser-function 'browse-url-generic
      browse-url-generic-program <span style="font-style: italic;">"google-chrome"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 167: </span>色付け</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#38738;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-go</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#28f"</span>))
  <span style="font-style: italic;">"go tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(go elfeed-face-tag-go)
      elfeed-search-face-alist)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#28611;&#38738;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-docker</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#46d"</span>))
  <span style="font-style: italic;">"docker tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(docker elfeed-face-tag-docker)
      elfeed-search-face-alist)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#36196;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-ruby</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#d12e59"</span>))
  <span style="font-style: italic;">"ruby tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(ruby elfeed-face-tag-ruby)
      elfeed-search-face-alist)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32043;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-emacs</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#9933ff"</span>))
  <span style="font-style: italic;">"emacs tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(emacs elfeed-face-tag-emacs)
      elfeed-search-face-alist)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#40644;&#32209;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-systemcrafters</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#9933ff"</span>))
  <span style="font-style: italic;">"systemcrafters tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(systemcrafters elfeed-face-tag-systemcrafters)
      elfeed-search-face-alist)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32209;</span>
(<span style="font-weight: bold;">defface</span> <span style="font-weight: bold; font-style: italic;">elfeed-face-tag-rfc</span>
  '((t <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#008000"</span>))
  <span style="font-style: italic;">"rfc tag face in Elfeed."</span>)
(<span style="font-weight: bold;">push</span> '(rfc elfeed-face-tag-rfc)
      elfeed-search-face-alist)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 168: </span>google-this</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">google-this</span>)
(google-this-mode 1)
(<span style="font-weight: bold;">setq</span> google-this-location-suffix <span style="font-style: italic;">"co.jp"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 169: </span>define-word</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">define-word</span>)
(global-set-key (kbd <span style="font-style: italic;">"&lt;end&gt;"</span>) 'define-word-at-point)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 170: </span>eww</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#25913;&#34892;&#12377;&#12427;&#12424;&#12358;&#12395;&#12377;&#12427;</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">shr-insert-document--for-eww</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;rest</span> them)
  (<span style="font-weight: bold;">let</span> ((shr-width 70)) (apply them)))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-display-html--fill-column</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;rest</span> them)
  (advice-add 'shr-insert-document <span style="font-weight: bold;">:around</span> 'shr-insert-document--for-eww)
  (<span style="font-weight: bold;">unwind-protect</span>
      (apply them)
    (advice-remove 'shr-insert-document 'shr-insert-document--for-eww)))
(advice-add 'eww-display-html <span style="font-weight: bold;">:around</span> 'eww-display-html--fill-column)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#33394;&#35373;&#23450;</span>
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">eww-disable-colorize</span> t)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">shr-colorize-region--disable</span> (orig start end fg <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> bg <span style="font-weight: bold; text-decoration: underline;">&amp;rest</span> _)
  (<span style="font-weight: bold;">unless</span> eww-disable-colorize
    (funcall orig start end fg)))
(advice-add 'shr-colorize-region <span style="font-weight: bold;">:around</span> 'shr-colorize-region--disable)
(advice-add 'eww-colorize-region <span style="font-weight: bold;">:around</span> 'shr-colorize-region--disable)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-disable-color</span> ()
  <span style="font-style: italic;">"eww &#12391;&#25991;&#23383;&#33394;&#12434;&#21453;&#26144;&#12373;&#12379;&#12394;&#12356;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">setq-local</span> eww-disable-colorize t)
  (eww-reload))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-enable-color</span> ()
  <span style="font-style: italic;">"eww &#12391;&#25991;&#23383;&#33394;&#12434;&#21453;&#26144;&#12373;&#12379;&#12427;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">setq-local</span> eww-disable-colorize nil)
  (eww-reload))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12487;&#12501;&#12457;&#12523;&#12488;&#12456;&#12531;&#12472;&#12531;</span>
(<span style="font-weight: bold;">setq</span> eww-search-prefix <span style="font-style: italic;">"https://www.google.co.jp/search?q="</span>)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-tag-pre</span> (dom)
  (<span style="font-weight: bold;">let</span> ((shr-folding-mode 'none)
        (shr-current-font 'default))
    (shr-ensure-newline)
    (insert (eww-fontify-pre dom))
    (shr-ensure-newline)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-fontify-pre</span> (dom)
  (<span style="font-weight: bold;">with-temp-buffer</span>
    (shr-generic dom)
    (<span style="font-weight: bold;">let</span> ((mode (eww-buffer-auto-detect-mode)))
      (<span style="font-weight: bold;">when</span> mode
        (eww-fontify-buffer mode)))
    (buffer-string)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-fontify-buffer</span> (mode)
  (<span style="font-weight: bold;">delay-mode-hooks</span> (funcall mode))
  (font-lock-default-function mode)
  (font-lock-default-fontify-region (point-min)
                                    (point-max)
                                    nil))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eww-buffer-auto-detect-mode</span> ()
  (<span style="font-weight: bold;">let*</span> ((map '((ada ada-mode)
                (awk awk-mode)
                (c c-mode)
                (cpp c++-mode)
                (clojure clojure-mode lisp-mode)
                (csharp csharp-mode java-mode)
                (css css-mode)
                (delphi delphi-mode)
                (emacslisp emacs-lisp-mode)
                (erlang erlang-mode)
                (fortran fortran-mode)
                (fsharp fsharp-mode)
                (go go-mode)
                (groovy groovy-mode)
                (haskell haskell-mode)
                (html html-mode)
                (java java-mode)
                (javascript javascript-mode)
                (json json-mode javascript-mode)
                (latex latex-mode)
                (lisp lisp-mode)
                (lua lua-mode)
                (matlab matlab-mode octave-mode)
                (objc objc-mode c-mode)
                (perl perl-mode)
                (php php-mode)
                (prolog prolog-mode)
                (python python-mode)
                (r r-mode)
                (ruby ruby-mode)
                (rust rust-mode)
                (scala scala-mode)
                (shell shell-script-mode)
                (smalltalk smalltalk-mode)
                (sql sql-mode)
                (swift swift-mode)
                (visualbasic visual-basic-mode)
                (xml sgml-mode)))
         (language (language-detection-string
                    (buffer-substring-no-properties (point-min) (point-max))))
         (modes (cdr (assoc language map)))
         (mode (<span style="font-weight: bold;">cl-loop</span> for mode in modes
                        when (fboundp mode)
                        return mode)))
    (message (format <span style="font-style: italic;">"%s"</span> language))
    (<span style="font-weight: bold;">when</span> (fboundp mode)
      mode)))

(<span style="font-weight: bold;">setq</span> shr-external-rendering-functions
      '((pre . eww-tag-pre)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 171: </span>flycheck + textlint</label><pre class="src src-emacs-lisp">(flycheck-define-checker textlint
  <span style="font-style: italic;">"A linter for Markdown."</span>
  <span style="font-weight: bold;">:command</span> (<span style="font-style: italic;">"textlint"</span> <span style="font-style: italic;">"--format"</span> <span style="font-style: italic;">"unix"</span> source)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">:command ("docker" "run" "-v" "/home/silver/roam:/home/silver/roam" "--rm" "ghcr.io/kijimad/roam_textlint" "textlint" "-c" "/home/silver/roam/.textlintrc" "--format" "unix" source)</span>
  <span style="font-weight: bold;">:error-patterns</span>
  ((warning line-start (file-name) <span style="font-style: italic;">":"</span> line <span style="font-style: italic;">":"</span> column <span style="font-style: italic;">": "</span>
            (id (one-or-more (not (any <span style="font-style: italic;">" "</span>))))
            (message (one-or-more not-newline)
                     (zero-or-more <span style="font-style: italic;">"\n"</span> (any <span style="font-style: italic;">" "</span>) (one-or-more not-newline)))
            line-end))
  <span style="font-weight: bold;">:modes</span> (text-mode markdown-mode gfm-mode org-mode))

(add-hook 'markdown-mode-hook
          '(lambda ()
             (add-node-modules-path)
             (<span style="font-weight: bold;">setq</span> flycheck-checker 'textlint)
             (current-word-highlight-mode)
             (flycheck-mode 1)))

(add-hook 'org-mode-hook
          '(lambda ()
             (add-node-modules-path)
             (<span style="font-weight: bold;">setq</span> flycheck-checker 'textlint)
             (flycheck-mode 1)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 172: </span>正規表現</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-M-%"</span>) 'vr/query-replace)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 173: </span>git-link</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> git-link-default-branch <span style="font-style: italic;">"main"</span>)
(<span style="font-weight: bold;">setq</span> git-link-use-commit t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 174: </span>undo-tree-mode</label><pre class="src src-emacs-lisp">(global-undo-tree-mode)
(<span style="font-weight: bold;">setq</span> undo-tree-auto-save-history nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 175: </span>eradio</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> eradio-channels '((<span style="font-style: italic;">"def con - soma fm"</span> . <span style="font-style: italic;">"https://somafm.com/defcon256.pls"</span>)
                          (<span style="font-style: italic;">"metal - soma fm"</span>   . <span style="font-style: italic;">"https://somafm.com/metal130.pls"</span>)
                          (<span style="font-style: italic;">"cyberia - lainon"</span>  . <span style="font-style: italic;">"https://lainon.life/radio/cyberia.ogg.m3u"</span>)
                          (<span style="font-style: italic;">"cafe - lainon"</span>     . <span style="font-style: italic;">"https://lainon.life/radio/cafe.ogg.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - HBR1.com"</span> . <span style="font-style: italic;">"http://ubuntu.hbr1.com:19800/ambient.ogg"</span>)
                          (<span style="font-style: italic;">"ambient - RADIO ESTILO LEBLON"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us4.internet-radio.com:8193/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - Pink Noise Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk1.internet-radio.com:8004/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - Deeply Beautiful Chillout Music - A Heavenly World of Sound"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk2.internet-radio.com:31491/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - Chill Lounge Florida"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us5.internet-radio.com:8283/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - PARTY VIBE RADIO : AMBIENT"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://www.partyviberadio.com:8056/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"healing - Healing Music Radio - The music of Peter Edwards"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us3.internet-radio.com:8169/live.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - Real World Sounds"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk5.internet-radio.com:8260/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"meditation - SilentZazen"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk5.internet-radio.com:8167/live.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"meditation - Zero Beat Zone (MRG.fm)"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://62.149.196.16:8800/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"meditation - Meditation Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://213.239.218.99:7241/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - AmbientRadio (MRG.fm)"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://62.149.196.16:8888/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"jungle - Konflict Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk3.internet-radio.com:8192/live.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"jungle - Future Pressure Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk3.internet-radio.com:8108/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"jungle - PARTY VIBE RADIO : JUNGLE"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://www.partyviberadio.com:8004/listen.pls?sid=2&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"jazz - Smooth Jazz Florida"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us4.internet-radio.com:8266/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"rock - Classic Rock Florida HD"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us4.internet-radio.com:8258/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"dance - Dance UK Radio danceradiouk"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk2.internet-radio.com:8024/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"rock - Majestic Jukebox Radio #HIGH QUALITY SOUND"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://uk3.internet-radio.com:8405/live.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"ambient - LIFE CHILL MUSIC"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://aska.ru-hoster.com:8053/autodj.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"dance - PulseEDM Dance Music Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://pulseedm.cdnstream1.com:8124/1373_128.m3u&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"piano - Matt Johnson Radio"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://us2.internet-radio.com:8046/listen.pls&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"piano - Music Lake - Relaxation Music, Meditation, Focus, Chill, Nature Sounds"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://104.251.118.50:8626/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"piano - Bru Zane Classical Radio - Rediscovering French Romantic Music"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://116.202.241.212:7001/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"piano - CALMRADIO.COM - Most Beautiful Piano Ever"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://209.58.147.84:19991/listen.pls?sid=1&amp;t=.m3u"</span>)
                          (<span style="font-style: italic;">"piano - CALMRADIO.COM - Light Jazz Piano"</span> . <span style="font-style: italic;">"https://www.internet-radio.com/servers/tools/playlistgenerator/?u=http://23.82.11.88:10800/listen.pls?sid=1&amp;t=.m3u"</span>)
                          ))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 176: </span>タイピングゲームの保存ファイル</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> toe-highscore-file <span style="font-style: italic;">"~/.emacs.d/games/.toe-scores"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 177: </span>create-link</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> create-link-default-format 'create-link-format-org)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 178: </span>lispxmp</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">lispxmp</span>)
(define-key emacs-lisp-mode-map (kbd <span style="font-style: italic;">"C-&lt;return&gt;"</span>) 'lispxmp)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 179: </span>graphql</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">graphql-mode</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ob-graphql</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org568aaaa" class="outline-2">
<h2 id="org568aaaa"><span class="section-number-2">6.</span> Rails</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 180: </span>projectile-rails</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">projectile-rails</span>)
(projectile-rails-global-mode)
(add-hook 'projectile-mode-hook 'projectile-rails-on)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 181: </span>rspec</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rspec-mode</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Rspec&#12398;&#23455;&#34892;&#32080;&#26524;&#12434;&#12473;&#12463;&#12525;&#12540;&#12523;&#12375;&#12390;&#20986;&#21147;&#12377;&#12427;</span>
(<span style="font-weight: bold;">setq</span> compilation-scroll-output t)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Docker&#12398;&#12392;&#12365;&#12398;&#35373;&#23450;&#12290;&#12503;&#12525;&#12472;&#12455;&#12463;&#12488;&#12372;&#12392;&#12395;&#35373;&#23450;&#12375;&#12383;&#12356;&#12364;&#8230;</span>
(<span style="font-weight: bold;">setq</span> rspec-use-docker-when-possible 1)
(<span style="font-weight: bold;">setq</span> rspec-docker-container <span style="font-style: italic;">"rails"</span>)
(<span style="font-weight: bold;">setq</span> rspec-docker-command <span style="font-style: italic;">"docker-compose -f docker-compose.yml -f docker-compose-app.yml -f docker-compose-app.override.yml exec"</span>)
(<span style="font-weight: bold;">setq</span> rspec-docker-cwd <span style="font-style: italic;">""</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 182: </span>RAILS<sub>ENV</sub>=testを追加</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">rspec-runner</span> ()
  <span style="font-style: italic;">"Return command line to run rspec."</span>
  (<span style="font-weight: bold;">let</span> ((bundle-command (<span style="font-weight: bold;">if</span> (rspec-bundle-p) <span style="font-style: italic;">"RAILS_ENV=test bundle exec "</span> <span style="font-style: italic;">""</span>))
        (zeus-command (<span style="font-weight: bold;">if</span> (rspec-zeus-p) <span style="font-style: italic;">"zeus "</span> nil))
        (spring-command (<span style="font-weight: bold;">if</span> (rspec-spring-p) <span style="font-style: italic;">"spring "</span> nil)))
    (concat (<span style="font-weight: bold;">or</span> zeus-command spring-command bundle-command)
            (<span style="font-weight: bold;">if</span> (rspec-rake-p)
                (concat rspec-rake-command <span style="font-style: italic;">" spec"</span>)
              rspec-spec-command))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 183: </span>springを有効化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> rspec-use-spring-when-possible t)
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">rspec-spring-p</span> ()
    (<span style="font-weight: bold;">and</span> rspec-use-spring-when-possible
         (stringp (executable-find <span style="font-style: italic;">"spring"</span>))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 184: </span>rubocopとflycheck連携</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rubocop</span>)
(add-hook 'ruby-mode-hook 'rubocop-mode)
(add-hook 'ruby-mode-hook
          '(lambda ()
             (<span style="font-weight: bold;">setq</span> flycheck-checker 'ruby-rubocop)))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">See: https://qiita.com/watson1978/items/debafdfc49511fb173e9</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#29420;&#33258;&#12395; checker &#12434;&#23450;&#32681;&#12377;&#12427;&#65288;&#12362;&#22909;&#12415;&#12391;&#65289;</span>
(flycheck-define-checker ruby-rubocop
  <span style="font-style: italic;">"A Ruby syntax and style checker using the RuboCop tool."</span>
  <span style="font-weight: bold;">:command</span> (<span style="font-style: italic;">"rubocop"</span> <span style="font-style: italic;">"--format"</span> <span style="font-style: italic;">"emacs"</span>
            (config-file <span style="font-style: italic;">"--config"</span> flycheck-rubocoprc) source)
  <span style="font-weight: bold;">:error-patterns</span>
  ((warning line-start
            (file-name) <span style="font-style: italic;">":"</span> line <span style="font-style: italic;">":"</span> column <span style="font-style: italic;">": "</span> (<span style="font-weight: bold;">or</span> <span style="font-style: italic;">"C"</span> <span style="font-style: italic;">"W"</span>) <span style="font-style: italic;">": "</span> (message) line-end)
   (<span style="font-weight: bold;">error</span> line-start
          (file-name) <span style="font-style: italic;">":"</span> line <span style="font-style: italic;">":"</span> column <span style="font-style: italic;">": "</span> (<span style="font-weight: bold;">or</span> <span style="font-style: italic;">"E"</span> <span style="font-style: italic;">"F"</span>) <span style="font-style: italic;">": "</span> (message) line-end))
  <span style="font-weight: bold;">:modes</span> (ruby-mode motion-mode))

(<span style="font-weight: bold;">setq</span> flycheck-ruby-rubocop-executable <span style="font-style: italic;">"bundle exec rubocop"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 185: </span>rinari</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span> nil 'noerror)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span>)
  (add-hook 'ruby-mode-hook 'rinari-minor-mode))

(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span> nil 'noerror)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rspec-mode</span>)
  (eval-after-load 'rspec-mode
    '(rspec-install-snippets)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 186: </span>補完</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ruby-electric</span>)
(add-hook 'ruby-mode-hook '(lambda ()
                             (ruby-electric-mode t)))

</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 187: </span>inf-ruby</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">inf-ruby</span>)
(<span style="font-weight: bold;">setq</span> inf-ruby-default-implementation <span style="font-style: italic;">"pry"</span>)
(<span style="font-weight: bold;">setq</span> inf-ruby-eval-binding <span style="font-style: italic;">"Pry.toplevel_binding"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">ri&#12394;&#12393;&#12398;&#12456;&#12473;&#12465;&#12540;&#12503;&#12471;&#12540;&#12465;&#12531;&#12473;&#12434;&#20966;&#29702;&#12375;&#12289;&#33394;&#20184;&#12369;&#12377;&#12427;</span>
(add-hook 'inf-ruby-mode-hook 'ansi-color-for-comint-mode-on)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 188: </span>slim-mode</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">unless</span> (package-installed-p 'slim-mode)
  (package-refresh-contents) (package-install 'slim-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.slim?\\'"</span> . slim-mode))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 189: </span>マジックコメントを挿入しない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ruby-insert-encoding-magic-comment nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 190: </span>対応ブロックを光らせる時間を短くする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">ruby-block-delay</span> 0
    <span style="font-style: italic;">"*Time in seconds to delay before showing a matching paren."</span>
    <span style="font-weight: bold;">:type</span>  'number
    <span style="font-weight: bold;">:group</span> 'ruby-block)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 191: </span>実行結果アノテーション</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rcodetools</span>)
(define-key ruby-mode-map (kbd <span style="font-style: italic;">"C-&lt;return&gt;"</span>) 'xmp)
</pre>
</div>
</div>
</div>

<div id="outline-container-org650ee1d" class="outline-2">
<h2 id="org650ee1d"><span class="section-number-2">7.</span> Go</h2>
<div class="outline-text-2" id="text-7">
<p>
goの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 192: </span>require</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">go-mode</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ob-go</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 193: </span>デバッガ</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">dap-mode</span>
  <span style="font-weight: bold;">:config</span>
  (dap-mode 1)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dap-hydra</span>)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dap-dlv-go</span>))
(<span style="font-weight: bold;">setq</span> dap-print-io t)
(<span style="font-weight: bold;">setq</span> dap-dlv-go-delve-path <span style="font-style: italic;">"~/go/bin/dlv"</span>)

(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">posframe</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Posframe is a pop-up tool that must be manually installed for dap-mode</span>
  )

(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">dap-ui</span>
  <span style="font-weight: bold;">:config</span>
  (dap-ui-mode 1))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 194: </span>go-eldoc</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">go-eldoc</span>)
(add-hook 'go-mode-hook 'go-eldoc-setup)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 195: </span>go fmt</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> gofmt-command <span style="font-style: italic;">"goimports"</span>)
(add-hook 'before-save-hook 'gofmt-before-save)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 196: </span>Goアセンブリを表示するorg-babel</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">ob-go-asm</span>
  <span style="font-weight: bold;">:straight</span> (<span style="font-weight: bold;">:host</span> github <span style="font-weight: bold;">:repo</span> <span style="font-style: italic;">"kijimaD/ob-go-asm"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b1f695" class="outline-2">
<h2 id="org3b1f695"><span class="section-number-2">8.</span> Haskell</h2>
<div class="outline-text-2" id="text-8">
<p>
haskellの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 197: </span>基本設定</label><pre class="src src-emacs-lisp">(add-hook 'haskell-mode-hook 'turn-on-haskell-doc-mode)
(add-hook 'haskell-mode-hook 'turn-on-haskell-indent)

(custom-set-variables
 '(haskell-indent-after-keywords (<span style="font-weight: bold;">quote</span> ((<span style="font-style: italic;">"where"</span> 4 0) (<span style="font-style: italic;">"of"</span> 4) (<span style="font-style: italic;">"do"</span> 4) (<span style="font-style: italic;">"mdo"</span> 4) (<span style="font-style: italic;">"rec"</span> 4) (<span style="font-style: italic;">"in"</span> 4 0) (<span style="font-style: italic;">"{"</span> 4) <span style="font-style: italic;">"if"</span> <span style="font-style: italic;">"then"</span> <span style="font-style: italic;">"else"</span> <span style="font-style: italic;">"let"</span>)))
 '(haskell-indent-offset 4)
 '(haskell-indent-spaces 4))
</pre>
</div>
</div>
</div>
<div id="outline-container-org2935b4a" class="outline-2">
<h2 id="org2935b4a"><span class="section-number-2">9.</span> Yaml</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 198: </span>yaml-mode</label><pre class="src src-emacs-lisp">(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.ya?ml$"</span> . yaml-mode))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 199: </span>origami</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">origami</span>)
(<span style="font-weight: bold;">define-minor-mode</span> <span style="font-weight: bold;">origami-view-mode</span>
  <span style="font-style: italic;">"TAB&#12395;origami&#12398;&#25240;&#30067;&#12415;&#12434;&#21106;&#12426;&#24403;&#12390;&#12427;"</span>
  nil <span style="font-style: italic;">"&#25240;&#32025;"</span>
  '((<span style="font-style: italic;">"\C-i"</span> . origami-cycle))
  (<span style="font-weight: bold;">or</span> origami-mode (origami-mode 1)))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">origami-cycle</span> (recursive)
  <span style="font-style: italic;">"origami&#12398;&#27231;&#33021;&#12434;org&#39080;&#12395;&#12414;&#12392;&#12417;&#12427;"</span>
  (<span style="font-weight: bold;">interactive</span> <span style="font-style: italic;">"P"</span>)
  (call-interactively
   (<span style="font-weight: bold;">if</span> recursive 'origami-toggle-all-nodes 'origami-toggle-node)))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">yaml-mode-hook--origami</span> ()
  (<span style="font-weight: bold;">when</span> (eq major-mode 'yaml-mode)
    (origami-view-mode)))
(add-hook 'yaml-mode-hook 'yaml-mode-hook--origami)
</pre>
</div>

<ul class="org-ul">
<li><a href="http://emacs.rubikitch.com/origami/">http://emacs.rubikitch.com/origami/</a></li>
</ul>
</div>
</div>

<div id="outline-container-org8886896" class="outline-2">
<h2 id="org8886896"><span class="section-number-2">10.</span> Web</h2>
<div class="outline-text-2" id="text-10">
<p>
web-modeはhtmlライクな複数の言語に対応するモード。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">web-mode</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">web-mode</span>)
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.js[x]?$"</span> . web-mode))<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">js + jsx</span>
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.tsx$"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.phtml\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.[gj]sp\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.as[cp]x\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.erb\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.mustache\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.djhtml\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.html\\'"</span> . web-mode))
(<span style="font-weight: bold;">setq</span> web-mode-engines-alist
      '((<span style="font-style: italic;">"php"</span>    . <span style="font-style: italic;">"\\.phtml\\'"</span>)
        (<span style="font-style: italic;">"blade"</span>  . <span style="font-style: italic;">"\\.blade\\."</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">JS+JSX&#35373;&#23450; ================</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12467;&#12513;&#12531;&#12488;&#12450;&#12454;&#12488;&#12398;&#35373;&#23450;</span>
(add-hook 'web-mode-hook
          '(lambda ()
             (add-to-list 'web-mode-comment-formats '(<span style="font-style: italic;">"jsx"</span> . <span style="font-style: italic;">"//"</span> ))))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">.js &#12391;&#12418; JSX &#32232;&#38598;&#12514;&#12540;&#12489;&#12395;</span>
(<span style="font-weight: bold;">setq</span> web-mode-content-types-alist
      '((<span style="font-style: italic;">"jsx"</span> . <span style="font-style: italic;">"\\.js[x]?\\'"</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">JS&#12471;&#12531;&#12479;&#12483;&#12463;&#12473;&#12481;&#12455;&#12483;&#12463; ================</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">ESlint</span>
(eval-after-load 'flycheck
  '(custom-set-variables
    '(flycheck-disabled-checkers '(javascript-jshint javascript-jscs))
    ))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">eslint &#29992;&#12398; linter &#12434;&#30331;&#37682;</span>
(flycheck-add-mode 'javascript-eslint 'web-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#20316;&#26989;&#12375;&#12390;&#12356;&#12427; project &#12398; node-module &#12434;&#12415;&#12390;&#12289;&#36969;&#20999;&#12395;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">linter &#12398;&#35373;&#23450;&#12434;&#35501;&#12415;&#36796;&#12416;</span>
(eval-after-load 'web-mode
  '(progn
     (add-hook 'web-mode-hook #'add-node-modules-path)
     (add-hook 'web-mode-hook #'prettier-js-mode)))
(eval-after-load 'web-mode
  '(add-hook 'rjsx-mode-hook #'add-node-modules-path))
(add-hook 'web-mode-hook 'flycheck-mode)
(add-hook 'rjsx-mode-hook 'flycheck-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;: M-x eslint-fix-file</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eslint-fix-file</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (call-process-shell-command
   (mapconcat 'shell-quote-argument
              (list <span style="font-style: italic;">"eslint"</span> <span style="font-style: italic;">"--fix"</span> (buffer-file-name)) <span style="font-style: italic;">" "</span>) <span style="font-weight: bold;">nil 0))</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;&#24460;&#12289;buffer &#12434; revert &#12377;&#12427;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;: M-x eslint-fix-file-and-revert</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eslint-fix-file-and-revert</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (eslint-fix-file)
  (revert-buffer t t))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12452;&#12531;&#12487;&#12531;&#12488;&#31561;&#35519;&#25972; ================</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-web-mode-hook</span> ()
  <span style="font-style: italic;">"Hooks for Web mode."</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-attr-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-markup-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-css-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-code-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-sql-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq sql-indent-offset 0)</span>
  (<span style="font-weight: bold;">setq</span> indent-tabs-mode nil)
  (<span style="font-weight: bold;">setq</span> tab-width 2)
  (<span style="font-weight: bold;">setq</span> json-reformat:indent-width 2)

  (<span style="font-weight: bold;">setq</span> web-mode-attr-indent-offset nil)
  (<span style="font-weight: bold;">setq</span> web-mode-enable-auto-closing t)
  (<span style="font-weight: bold;">setq</span> web-mode-enable-auto-pairing t)
  (<span style="font-weight: bold;">setq</span> web-mode-auto-close-style 2)
  (<span style="font-weight: bold;">setq</span> web-mode-tag-auto-close-style 2))
(add-hook 'web-mode-hook 'my-web-mode-hook)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">CSS ================</span>
(<span style="font-weight: bold;">setq</span> css-indent-offset 2)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">SQL ================</span>
(add-hook 'ejc-sql-minor-mode-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (ejc-eldoc-setup)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12467;&#12510;&#12531;&#12489;&#12434;&#22823;&#25991;&#23383;&#12395;&#12377;&#12427;</span>
(add-hook 'sql-mode-hook 'sqlup-mode)
(add-hook 'sql-interactive-mode-hook 'sqlup-mode)
(global-set-key (kbd <span style="font-style: italic;">"C-c u"</span>) 'sqlup-capitalize-keywords-in-region)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32080;&#26524;&#12434;&#25240;&#12426;&#36820;&#12373;&#12394;&#12356;&#12424;&#12358;&#12395;&#12377;&#12427;</span>
(add-hook 'sql-interactive-mode-hook
          '(lambda()
             (<span style="font-weight: bold;">setq</span> truncate-lines nil
                   truncate-partial-width-windows t)))

(<span style="font-weight: bold;">setq</span> erc-server <span style="font-style: italic;">"irc.libera.chat"</span>
      erc-nick <span style="font-style: italic;">"kijimad"</span>
      erc-user-full-name <span style="font-style: italic;">"Kijima Daigo"</span>
      erc-track-shorten-start 8
      erc-autojoin-channels-alist '((<span style="font-style: italic;">"irc-libera.chat"</span> <span style="font-style: italic;">"#systemcrafters"</span> <span style="font-style: italic;">"#emacs"</span>))
      erc-kill-buffer-on-part t
      erc-auto-query 'bufy)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Typescript ================</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">typescript-mode</span>)
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.ts\\'"</span> . typescript-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgde99e02" class="outline-2">
<h2 id="orgde99e02"><span class="section-number-2">11.</span> corfu</h2>
<div class="outline-text-2" id="text-11">
<p>
corfuはシンプルな補完を提供するパッケージ。
</p>

<ul class="org-ul">
<li><a href="https://tam5917.hatenablog.com/entry/2022/02/05/141115">corfuまわりの設定（vertico, marginalia, orderless, cape, kind-icon, affe） - 備忘録</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 200: </span>起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">corfu</span>)
(global-corfu-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 201: </span>補完の隣にドキュメント表示する</label><pre class="src src-emacs-lisp">(corfu-popupinfo-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 202: </span>基本設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> corfu-auto t)
(<span style="font-weight: bold;">setq</span> corfu-auto-prefix 3)
(<span style="font-weight: bold;">setq</span> corfu-count 15)
(<span style="font-weight: bold;">setq</span> corfu-cycle t)
(<span style="font-weight: bold;">setq</span> corfu-preselect-first nil) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#33258;&#21205;&#30340;&#12395;&#26368;&#21021;&#12398;&#20505;&#35036;&#12434;&#36984;&#25246;&#12377;&#12427;</span>
(<span style="font-weight: bold;">setq</span> corfu-preselect 'prompt)
(<span style="font-weight: bold;">setq</span> corfu-quit-at-boundary t) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12473;&#12506;&#12540;&#12473;&#12434;&#20837;&#12428;&#12427;&#12392;quit</span>
(<span style="font-weight: bold;">setq</span> corfu-quit-no-match t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 203: </span>候補選択を循環させる</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> completion-cycle-threshold 3)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">corfu-beginning-of-prompt</span> ()
  <span style="font-style: italic;">"Move to beginning of completion input."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (corfu--goto -1)
  (goto-char (car completion-in-region--data)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">corfu-end-of-prompt</span> ()
  <span style="font-style: italic;">"Move to end of completion input."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (corfu--goto -1)
  (goto-char (cadr completion-in-region--data)))

(define-key corfu-map [remap move-beginning-of-line] #'corfu-beginning-of-prompt)
(define-key corfu-map [remap move-end-of-line] #'corfu-end-of-prompt)
</pre>
</div>
</div>
</div>

<div id="outline-container-org482fe09" class="outline-2">
<h2 id="org482fe09"><span class="section-number-2">12.</span> vertico</h2>
<div class="outline-text-2" id="text-12">
<p>
verticoは検索UIを提供するパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 204: </span>前の画面に復帰する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">vertico-repeat</span>
  <span style="font-weight: bold;">:after</span> vertico
  <span style="font-weight: bold;">:hook</span> (minibuffer-setup . vertico-repeat-save))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 205: </span>その他の連携パッケージ</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#35036;&#23436;&#12452;&#12531;&#12479;&#12540;&#12501;&#12455;&#12540;&#12473;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vertico</span>)
(vertico-mode)
(<span style="font-weight: bold;">setq</span> vertico-count 20)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#19978;&#12487;&#12451;&#12524;&#12463;&#12488;&#12522;&#12395;&#31227;&#21205;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#12377;&#12427;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vertico-directory</span>)
(define-key vertico-map (kbd <span style="font-style: italic;">"C-l"</span>) #'vertico-directory-up)
(define-key vertico-map <span style="font-style: italic;">"\r"</span> #'vertico-directory-enter)  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">enter dired</span>
(define-key vertico-map <span style="font-style: italic;">"\d"</span> #'vertico-directory-delete-char)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">vertico&#12395;&#24773;&#22577;&#36861;&#21152;&#12377;&#12427;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">marginalia</span>)
(marginalia-mode +1)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">marginalia-annotators&#12434;&#12469;&#12452;&#12463;&#12523;&#12377;&#12427;</span>
(define-key minibuffer-local-map (kbd <span style="font-style: italic;">"C-M-a"</span>) #'marginalia-cycle)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32094;&#12426;&#36796;&#12415;&#12525;&#12472;&#12483;&#12463;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">orderless</span>)
(<span style="font-weight: bold;">setq</span> completion-styles '(orderless partial-completion))
(orderless-define-completion-style orderless+initialism
  (orderless-matching-styles '(orderless-initialism <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">&#19968;&#30058;&#26368;&#21021;&#12395;initializm</span>
                               orderless-literal  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">&#27425;&#12395;&#12522;&#12486;&#12521;&#12523;&#12510;&#12483;&#12481;</span>
                               orderless-regexp)))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq completion-category-overrides</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">'((eglot (styles orderless+initialism))</span>
<span style="font-weight: bold; font-style: italic;">;;         </span><span style="font-weight: bold; font-style: italic;">(command (styles orderless+initialism))</span>
<span style="font-weight: bold; font-style: italic;">;;         </span><span style="font-weight: bold; font-style: italic;">(symbol (styles orderless+initialism))</span>
<span style="font-weight: bold; font-style: italic;">;;         </span><span style="font-weight: bold; font-style: italic;">(variable (styles orderless+initialism))))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq orderless-component-separator #'orderless-escapable-split-on-space)</span>

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">cape</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 206: </span>eglot</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">eglot</span>
  <span style="font-weight: bold;">:bind</span> (nil
         <span style="font-weight: bold;">:map</span> eglot-mode-map
         (<span style="font-style: italic;">"C-c a"</span> . eglot-code-actions))
  <span style="font-weight: bold;">:hook</span>
  (go-mode . eglot-ensure)
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/eglot-capf</span> ()
    (<span style="font-weight: bold;">setq-local</span> completion-at-point-functions
                (list (cape-capf-super
                      #'eglot-completion-at-point)
                      #'cape-keyword
                      #'cape-dabbrev
                      #'cape-file)
                ))
  (add-hook 'eglot-managed-mode-hook #'my/eglot-capf))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 207: </span>kind-icon</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Emacs&#12398;SVG&#23550;&#24540;&#12467;&#12531;&#12497;&#12452;&#12523;&#12364;&#24517;&#35201;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">kind-icon</span>)
(<span style="font-weight: bold;">setq</span> kind-icon-default-face 'corfu-default)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">If 4k, big size icon displayed.</span>
(add-to-list 'corfu-margin-formatters #'kind-icon-margin-formatter)
(<span style="font-weight: bold;">pop</span> corfu-margin-formatters)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Available commands</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">affe-grep: Filters the content of all text files in the current directory</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">affe-find: Filters the file paths of all files in the current directory</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">affe</span>)
(consult-customize affe-grep <span style="font-weight: bold;">:preview-key</span> (kbd <span style="font-style: italic;">"M-."</span>))
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">affe-orderless-regexp</span> <span style="font-style: italic;">""</span>)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">affe-orderless-regexp-compiler</span> (input _type)
  (<span style="font-weight: bold;">setq</span> affe-orderless-regexp (orderless-pattern-compiler input))
  (cons affe-orderless-regexp
        (<span style="font-weight: bold;">lambda</span> (str) (orderless--highlight affe-orderless-regexp str))))
(<span style="font-weight: bold;">setq</span> affe-regexp-compiler #'affe-orderless-regexp-compiler)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 208: </span>キーバインドを設定する</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-x C-b"</span>) 'consult-buffer)
(global-set-key (kbd <span style="font-style: italic;">"C-x C-u"</span>) 'vertico-repeat)
(global-set-key (kbd <span style="font-style: italic;">"C-x C-g"</span>) 'consult-git-grep)
(global-set-key (kbd <span style="font-style: italic;">"M-y"</span>) 'consult-yank-pop)
(global-set-key (kbd <span style="font-style: italic;">"M-i"</span>) 'consult-line)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 209: </span>idoが有効化されているとfind-fileが縦に表示されないので無効化する。最後に実行しないと反映されない</label><pre class="src src-emacs-lisp">(add-hook 'after-init-hook '(lambda ()
                              (ido-mode 0)
                              (ido-everywhere 0)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 210: </span>補完にアイコンを表示させる</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">all-the-icons-completion</span>
  <span style="font-weight: bold;">:straight</span> t
  <span style="font-weight: bold;">:hook</span> (marginalia-mode . all-the-icons-completion-marginalia-setup)
  <span style="font-weight: bold;">:init</span>
  (all-the-icons-completion-mode +1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org19262cb" class="outline-2">
<h2 id="org19262cb"><span class="section-number-2">13.</span> tabnine</h2>
<div class="outline-text-2" id="text-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">tabnine</span>
  <span style="font-weight: bold;">:commands</span> (tabnine-start-process)
  <span style="font-weight: bold;">:hook</span> (prog-mode . tabnine-mode)
  <span style="font-weight: bold;">:straight</span> t
  <span style="font-weight: bold;">:diminish</span> <span style="font-style: italic;">"&#9004;"</span>
  <span style="font-weight: bold;">:custom</span>
  (tabnine-wait 1)
  (tabnine-minimum-prefix-length 0)
  <span style="font-weight: bold;">:hook</span> (kill-emacs . tabnine-kill-process)
  <span style="font-weight: bold;">:bind</span>
  (<span style="font-weight: bold;">:map</span>  tabnine-completion-map
         (<span style="font-style: italic;">"&lt;tab&gt;"</span> . tabnine-accept-completion)
         (<span style="font-style: italic;">"TAB"</span> . tabnine-accept-completion)
         (<span style="font-style: italic;">"M-f"</span> . tabnine-accept-completion-by-word)
         (<span style="font-style: italic;">"M-&lt;return&gt;"</span> . tabnine-accept-completion-by-line)
         (<span style="font-style: italic;">"C-g"</span> . tabnine-clear-overlay)
         (<span style="font-style: italic;">"M-["</span> . tabnine-previous-completion)
         (<span style="font-style: italic;">"M-]"</span> . tabnine-next-completion)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org298557d" class="outline-2">
<h2 id="org298557d"><span class="section-number-2">14.</span> emacs Lisp</h2>
<div class="outline-text-2" id="text-14">
</div>
<div id="outline-container-org7398117" class="outline-3">
<h3 id="org7398117"><span class="section-number-3">14.1.</span> rispy</h3>
<div class="outline-text-3" id="text-14-1">
<p>
rispyはリストの操作をやりやすくするパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 211: </span>hook</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">lispy</span>)
(add-hook 'emacs-lisp-mode-hook (<span style="font-weight: bold;">lambda</span> () (lispy-mode 1)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 212: </span>キーバインド</label><pre class="src src-emacs-lisp">(define-key lispy-mode-map (kbd <span style="font-style: italic;">"M-&lt;right&gt;"</span>) 'next-buffer)
(define-key lispy-mode-map (kbd <span style="font-style: italic;">"M-&lt;left&gt;"</span>) 'previous-buffer)
(define-key lispy-mode-map (kbd <span style="font-style: italic;">"M-i"</span>) 'swiper-thing-at-point)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcbd40af" class="outline-2">
<h2 id="orgcbd40af"><span class="section-number-2">15.</span> eldoc</h2>
<div class="outline-text-2" id="text-15">
<p>
eldocは関数ドキュメントを表示するパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 213: </span>eldocをミニバッファに表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> <span style="font-style: italic;">"eldoc"</span>
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">ad:eldoc-message</span> (f <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> string)
    (<span style="font-weight: bold;">unless</span> (active-minibuffer-window)
      (funcall f string)))
  (advice-add 'eldoc-message <span style="font-weight: bold;">:around</span> #'ad:eldoc-message))
</pre>
</div>
</div>
</div>
<div id="outline-container-org2a554c5" class="outline-2">
<h2 id="org2a554c5"><span class="section-number-2">16.</span> eshell</h2>
<div class="outline-text-2" id="text-16">
<p>
eshellはEmacs Lispで実装されたシェル。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 214: </span>eshellの設定を追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">efs/configure-eshell</span> ()
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Save command history when commands are entered</span>
  (add-hook 'eshell-pre-command-hook 'eshell-save-some-history)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Truncate buffer for performance</span>
  (add-to-list 'eshell-output-filter-functions 'eshell-truncate-buffer)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Bind some useful keys for evil-mode</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(define-key eshell-mode-map (kbd "M-r") 'helm-eshell-history)</span>
  (<span style="font-weight: bold;">setq</span> eshell-history-size         10000
        eshell-buffer-maximum-lines 10000
        eshell-hist-ignoredups t
        eshell-scroll-to-bottom-on-input t
        eshell-git-prompt-use-theme 'multiline
        eshell-toggle-height-fraction 2
        eshell-toggle-use-projectile-root t))
(add-hook 'eshell-first-time-mode-hook 'efs/configure-eshell)
</pre>
</div>

<ul class="org-ul">
<li>ベース設定は <a href="https://github.com/daviwil/emacs-from-scratch/blob/master/show-notes/Emacs-09.org">https://github.com/daviwil/emacs-from-scratch/blob/master/show-notes/Emacs-09.org</a> から取ってきた</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 215: </span>キーバインドを設定する</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-M-;"</span>) 'eshell-toggle)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 216: </span>eshellのサジェストを設定する</label><pre class="src src-emacs-lisp">(add-hook 'eshell-first-time-mode-hook 'esh-autosuggest-mode)
(<span style="font-weight: bold;">setq</span> esh-autosuggest-delay 0.5)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0e15c2" class="outline-2">
<h2 id="orgb0e15c2"><span class="section-number-2">17.</span> Vterm</h2>
<div class="outline-text-2" id="text-17">
<p>
vtermはCで実装されたシェル。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 217: </span>各種設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vterm</span>)
  (<span style="font-weight: bold;">setq</span> term-prompt-regexp <span style="font-style: italic;">"^[</span><span style="font-style: italic;">^</span><span style="font-style: italic;">#$%&gt;\n]*[#$%&gt;] *"</span>)
  (<span style="font-weight: bold;">setq</span> vterm-toggle-scope 'project)
  (<span style="font-weight: bold;">setq</span> vterm-toggle-project-root t)
  (<span style="font-weight: bold;">setq</span> vterm-max-scrollback 10000)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">toggle</span>
  (global-set-key [f9] 'vterm-toggle)
  (global-set-key (kbd <span style="font-style: italic;">"C-M-:"</span>) 'vterm-toggle)
  (global-set-key [C-f9] 'vterm-toggle-cd)

  (<span style="font-weight: bold;">setq</span> vterm-toggle-fullscreen-p nil)
  (add-to-list 'display-buffer-alist
               '((<span style="font-weight: bold;">lambda</span>(bufname _) (<span style="font-weight: bold;">with-current-buffer</span> bufname
                                      (<span style="font-weight: bold;">or</span> (equal major-mode 'vterm-mode)
                                          (string-prefix-p vterm-buffer-name bufname))))
                 (display-buffer-reuse-window display-buffer-at-bottom)
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(display-buffer-reuse-window display-buffer-in-direction)</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">display-buffer-in-direction/direction/dedicated is added in emacs27</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(direction . bottom)</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(dedicated . t) ;dedicated is supported in emacs27</span>
                 (reusable-frames . visible)
                 (window-height . 0.3))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcbc0b76" class="outline-2">
<h2 id="orgcbc0b76"><span class="section-number-2">18.</span> Theme</h2>
<div class="outline-text-2" id="text-18">
<p>
いい感じのテーマを設定する。割と白いテーマと黒いテーマを切り替えるのですぐ切り替えられるようにする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 218: </span>doom themeを読み込み</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">doom-themes</span>)
(doom-themes-org-config)
(<span style="font-weight: bold;">setq</span> custom-safe-themes t)
(<span style="font-weight: bold;">setq-default</span> custom-enabled-themes '(modus-operandi))
</pre>
</div>

<p>
doom themeはモダンなテーマ集。
</p>

<ul class="org-ul">
<li>ダーク系
<ul class="org-ul">
<li>doom-vibrant</li>
<li>spacemacs-dark</li>
<li>doom-dracula</li>
<li>modus-vivendi</li>
<li>leuven-dark</li>
</ul></li>
<li>ライト系
<ul class="org-ul">
<li>leuven</li>
<li>doom-acario-light</li>
<li>doom-homage-white</li>
<li>modus-operandi</li>
</ul></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 219: </span>再適用する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">reapply-themes</span> ()
  <span style="font-style: italic;">"Forcibly load the themes listed in `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">custom-enabled-themes</span><span style="font-style: italic;">'."</span>
  (<span style="font-weight: bold;">dolist</span> (theme custom-enabled-themes)
    (<span style="font-weight: bold;">unless</span> (custom-theme-p theme)
      (load-theme theme)))
  (custom-set-variables `(custom-enabled-themes (<span style="font-weight: bold;">quote</span> ,custom-enabled-themes)))
  (efs/org-font-setup)
  (kd/set-modus-face))

(add-hook 'after-init-hook 'reapply-themes)
</pre>
</div>

<p>
テーマ適用を最後に実行しないと、設定が上書きされることがあるため。
</p>
<ul class="org-ul">
<li><a href="https://github.com/purcell/emacs.d">https://github.com/purcell/emacs.d</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 220: </span>モードライン設定</label><pre class="src src-emacs-lisp">(doom-modeline-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#34920;&#31034;&#38917;&#30446;&#12398;&#35373;&#23450;</span>
(<span style="font-weight: bold;">setq</span> doom-modeline-buffer-file-name-style 'truncate-with-project)
(<span style="font-weight: bold;">setq</span> doom-modeline-major-mode-icon t)
(<span style="font-weight: bold;">setq</span> doom-modeline-minor-modes nil)
(<span style="font-weight: bold;">setq</span> doom-modeline-buffer-encoding nil)
(line-number-mode)
(column-number-mode)
(doom-modeline-def-modeline
  'my-simple-line
  '(bar matches buffer-info remote-host input-method major-mode process buffer-position)
  '(misc-info vcs))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32294;&#35519;&#25972;</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-doom-modeline--font-height</span> ()
  (- (frame-char-height) 20))
(advice-add #'doom-modeline--font-height <span style="font-weight: bold;">:override</span> #'my-doom-modeline--font-height)
(<span style="font-weight: bold;">setq</span> doom-modeline-height 20)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">setup-custom-doom-modeline</span> ()
  (doom-modeline-set-modeline 'my-simple-line 'default))
(add-hook 'doom-modeline-mode-hook 'setup-custom-doom-modeline)

(setup-custom-doom-modeline)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 221: </span>modus themeのカスタマイズ設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-modus-face</span> ()
  (<span style="font-weight: bold;">setq</span> modus-themes-slanted-constructs t
        modus-themes-bold-constructs t
        modus-themes-no-mixed-fonts t
        modus-themes-subtle-line-numbers t
        modus-themes-mode-line '(moody borderless)
        modus-themes-syntax 'faint
        modus-themes-paren-match 'intense-bold
        modus-themes-region 'bg-only
        modus-themes-diffs 'deuteranopia
        modus-themes-org-blocks 'gray-background
        modus-themes-variable-pitch-ui t
        modus-themes-variable-pitch-headings t
        modus-themes-scale-headings t
        modus-themes-scale-1 1.1
        modus-themes-scale-2 1.15
        modus-themes-scale-3 1.21
        modus-themes-scale-4 1.27
        modus-themes-scale-title 1.33)

  (set-face-foreground 'vertical-border <span style="font-style: italic;">"white"</span>)

  (set-face-attribute 'mode-line nil
                      <span style="font-weight: bold;">:background</span> nil
                      <span style="font-weight: bold;">:overline</span> <span style="font-style: italic;">"black"</span>
                      <span style="font-weight: bold;">:underline</span> nil
                      <span style="font-weight: bold;">:box</span> nil)

  (set-face-attribute 'mode-line-inactive nil
                      <span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"white"</span>
                      <span style="font-weight: bold;">:overline</span> <span style="font-style: italic;">"gray"</span>
                      <span style="font-weight: bold;">:underline</span> nil
                      <span style="font-weight: bold;">:box</span> nil)

  (window-divider-mode 0))
</pre>
</div>

<p>
マイナーモードは describe-minor-mode-from-indicator で調べられる。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 222: </span>モードラインからマイナーモードを消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> my-hidden-minor-modes
      '(
        abbrev-mode
        auto-highlight-symbol-mode
        auto-revert-mode
        back-button-mode
        beacon-mode
        command-log-mode
        ctags-auto-update-mode
        eldoc-mode
        flycheck-mode
        flyspell-mode
        global-whitespace-mode
        google-this-mode
        highlight-indent-guides-mode
        magit-auto-revert-mode
        projectile-mode
        projectile-rails-mode
        rinari-minor-mode
        rubocop-mode
        ruby-electric-mode
        undo-tree-mode
        which-key-mode
        yas-minor-mode
        ))
(mapc (<span style="font-weight: bold;">lambda</span> (mode)
        (<span style="font-weight: bold;">setq</span> minor-mode-alist
              (cons (list mode <span style="font-style: italic;">""</span>) (assq-delete-all mode minor-mode-alist))))
      my-hidden-minor-modes)
(<span style="font-weight: bold;">setq</span> minor-mode-alist nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 223: </span>モードラインやウィンドウのpaddingをいい感じにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">spacious-padding</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">These is the default value, but I keep it here for visiibility.</span>
(<span style="font-weight: bold;">setq</span> spacious-padding-widths
      '( <span style="font-weight: bold;">:internal-border-width</span> 10
         <span style="font-weight: bold;">:header-line-width</span> 4
         <span style="font-weight: bold;">:mode-line-width</span> 6
         <span style="font-weight: bold;">:tab-width</span> 4
         <span style="font-weight: bold;">:right-divider-width</span> 30
         <span style="font-weight: bold;">:fringe-width</span> 8))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Read the doc string of `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">spacious-padding-subtle-mode-line</span><span style="font-weight: bold; font-style: italic;">' as it</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">is very flexible and provides several examples.</span>
(<span style="font-weight: bold;">setq</span> spacious-padding-subtle-mode-line
      `( <span style="font-weight: bold;">:mode-line-active</span> 'default
         <span style="font-weight: bold;">:mode-line-inactive</span> vertical-border))
(spacious-padding-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-org779a508" class="outline-2">
<h2 id="org779a508"><span class="section-number-2">19.</span> EXWM</h2>
<div class="outline-text-2" id="text-19">
<p>
EXWMはEmacs上で動くウィンドウマネージャ。
</p>
<ul class="org-ul">
<li><a href="https://github.com/daviwil/emacs-from-scratch/blob/39f63fe133cd4c41e13bbd1551c6517162851411/show-notes/Emacs-Desktop-03.org">https://github.com/daviwil/emacs-from-scratch/blob/39f63fe133cd4c41e13bbd1551c6517162851411/show-notes/Emacs-Desktop-03.org</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 224: </span>require</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">exwm</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 225: </span>ライブラリから外されたのでコピーが推奨されている。<a href="https://github.com/emacs-exwm/exwm/blob/fa3393806c3e7e3d6dc767cd7c0e29b8d4d0a716/exwm-config.el">https://github.com/emacs-exwm/exwm/blob/fa3393806c3e7e3d6dc767cd7c0e29b8d4d0a716/exwm-config.el</a></label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">exwm-config.el --- Predefined configurations  -*- lexical-binding: t -*-</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Copyright (C) 2015-2024 Free Software Foundation, Inc.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Author: Chris Feng <a href="mailto:chris.w.feng%40gmail.com">&lt;chris.w.feng@gmail.com&gt;</a></span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This file is part of GNU Emacs.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GNU Emacs is free software: you can redistribute it and/or modify</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">it under the terms of the GNU General Public License as published by</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">the Free Software Foundation, either version 3 of the License, or</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(at your option) any later version.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GNU Emacs is distributed in the hope that it will be useful,</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GNU General Public License for more details.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">You should have received a copy of the GNU General Public License</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">along with GNU Emacs.  If not, see <a href="http://www.gnu.org/licenses/">&lt;http://www.gnu.org/licenses/&gt;</a>.</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Commentary:</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This module contains an example configuration of EXWM.  Do not require this</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">file directly in your user configuration.  Instead take it as inspiration and</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">copy the relevant settings to your user configuration.</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Code:</span>

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">exwm</span>)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">exwm-config-example</span> ()
  <span style="font-style: italic;">"Default configuration of EXWM."</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the initial workspace number.</span>
  (<span style="font-weight: bold;">unless</span> (get 'exwm-workspace-number 'saved-value)
    (<span style="font-weight: bold;">setq</span> exwm-workspace-number 4))
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Make class name the buffer name</span>
  (add-hook 'exwm-update-class-hook
            (<span style="font-weight: bold;">lambda</span> ()
              (exwm-workspace-rename-buffer exwm-class-name)))
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Global keybindings.</span>
  (<span style="font-weight: bold;">unless</span> (get 'exwm-input-global-keys 'saved-value)
    (<span style="font-weight: bold;">setq</span> exwm-input-global-keys
          `(
            <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">'</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">s-r</span><span style="font-weight: bold; font-style: italic;">': Reset (to line-mode).</span>
            ([?\s-r] . exwm-reset)
            <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">'</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">s-w</span><span style="font-weight: bold; font-style: italic;">': Switch workspace.</span>
            ([?\s-w] . exwm-workspace-switch)
            <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">'</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">s-&amp;</span><span style="font-weight: bold; font-style: italic;">': Launch application.</span>
            ([?\s-&amp;] . (<span style="font-weight: bold;">lambda</span> (command)
                         (<span style="font-weight: bold;">interactive</span> (list (read-shell-command <span style="font-style: italic;">"$ "</span>)))
                         (start-process-shell-command command nil command)))
            <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">'</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">s-N</span><span style="font-weight: bold; font-style: italic;">': Switch to certain workspace.</span>
            ,@(mapcar (<span style="font-weight: bold;">lambda</span> (i)
                        `(,(kbd (format <span style="font-style: italic;">"s-%d"</span> i)) .
                          (<span style="font-weight: bold;">lambda</span> ()
                            (<span style="font-weight: bold;">interactive</span>)
                            (exwm-workspace-switch-create ,i))))
                      (number-sequence 0 9)))))
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Line-editing shortcuts</span>
  (<span style="font-weight: bold;">unless</span> (get 'exwm-input-simulation-keys 'saved-value)
    (<span style="font-weight: bold;">setq</span> exwm-input-simulation-keys
          '(([?\C-b] . [left])
            ([?\C-f] . [right])
            ([?\C-p] . [up])
            ([?\C-n] . [down])
            ([?\C-a] . [home])
            ([?\C-e] . [end])
            ([?\M-v] . [prior])
            ([?\C-v] . [next])
            ([?\C-d] . [delete])
            ([?\C-k] . [S-end delete]))))
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Enable EXWM</span>
  (exwm-enable))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 226: </span>ほかのウィンドウマネージャを置き換えて起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> exwm-replace t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 227: </span>ほかのワークスペースのバッファに移動できるようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> exwm-layout-show-all-buffers t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 228: </span>マウス設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> mouse-autoselect-window nil
        focus-follows-mouse t
        exwm-workspace-warp-cursor t
        exwm-workspace-number 5)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 229: </span>ワークスペースのバッファに名前をつける</label><pre class="src src-emacs-lisp">(add-hook 'exwm-update-class-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (exwm-workspace-rename-buffer exwm-class-name)))
(add-hook 'exwm-update-title-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (<span style="font-weight: bold;">pcase</span> exwm-class-name
              (<span style="font-style: italic;">"qutebrowser"</span> (exwm-workspace-rename-buffer (format <span style="font-style: italic;">"Qutebrowser: %s"</span> exwm-title)))
              (<span style="font-style: italic;">"chrome"</span> (exwm-workspace-rename-buffer (format <span style="font-style: italic;">"Chrome: %s"</span> exwm-title))))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 230: </span>ウィンドウのセットを起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-init</span> ()
  <span style="font-style: italic;">"Window Manager&#38306;&#20418;&#12398;&#21508;&#31278;&#12503;&#12525;&#12464;&#12521;&#12512;&#12434;&#36215;&#21205;&#12377;&#12427;."</span>
  (<span style="font-weight: bold;">interactive</span>)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(kd/set-background)</span>

  (call-process-shell-command <span style="font-style: italic;">"shepherd"</span>)
  (call-process-shell-command <span style="font-style: italic;">"~/dotfiles/.config/polybar/launch.sh"</span>)

  (exwm-workspace-switch-create 0)
  (start-process-shell-command <span style="font-style: italic;">"google-chrome"</span> nil <span style="font-style: italic;">"google-chrome"</span>)
  (sleep-for 2)
  (start-process-shell-command <span style="font-style: italic;">"spotify"</span> nil <span style="font-style: italic;">"spotify"</span>)
  (sleep-for 1)

  (persp-switch <span style="font-style: italic;">"1"</span>)
  (delete-other-windows)
  (<span style="font-weight: bold;">if</span> (file-exists-p org-journal-dir)
      (org-journal-new-entry nil))
  (vterm-toggle)
  (vterm-toggle)
  (persp-switch <span style="font-style: italic;">"2"</span>)
  (find-file <span style="font-style: italic;">"~/roam"</span>)
  (vterm-toggle)
  (vterm-toggle)
  (org-agenda nil <span style="font-style: italic;">"z"</span>)
  (persp-switch <span style="font-style: italic;">"3"</span>)
  (split-window-right)
  (switch-to-buffer <span style="font-style: italic;">"Google-chrome"</span>)
  (persp-switch <span style="font-style: italic;">"4"</span>)
  (switch-to-buffer <span style="font-style: italic;">"Google-chrome"</span>)
  (vterm-toggle)
  (vterm-toggle)
  (persp-switch <span style="font-style: italic;">"5"</span>)
  (find-file <span style="font-style: italic;">"~/dotfiles"</span>)
  (vterm-toggle)
  (vterm-toggle)
  (magit-status)
  (persp-switch <span style="font-style: italic;">"6"</span>)
  (find-file <span style="font-style: italic;">"~/.emacs.d/conf"</span>)
  (vterm-toggle)
  (vterm-toggle)
  (magit-status)
  (persp-switch <span style="font-style: italic;">"7"</span>)
  (find-file <span style="font-style: italic;">"~/ProjectOrg"</span>)
  (persp-switch <span style="font-style: italic;">"8"</span>)
  (find-file <span style="font-style: italic;">"~/Project"</span>)
  (persp-switch <span style="font-style: italic;">"9"</span>)
  (elfeed)

  (exwm-workspace-switch-create 1)
  (persp-switch <span style="font-style: italic;">"1"</span>)
  (persp-switch <span style="font-style: italic;">"2"</span>)
  (find-file <span style="font-style: italic;">"~/roam"</span>)
  (org-agenda nil <span style="font-style: italic;">"z"</span>)
  (persp-switch <span style="font-style: italic;">"4"</span>)
  (switch-to-buffer <span style="font-style: italic;">"Google-chrome"</span>)
  (persp-switch <span style="font-style: italic;">"8"</span>)
  (find-file <span style="font-style: italic;">"~/Project"</span>)

  (exwm-workspace-switch-create 2)
  (switch-to-buffer <span style="font-style: italic;">"Spotify"</span>)

  (exwm-workspace-switch-create 0)
  (persp-switch <span style="font-style: italic;">"4"</span>)

  (message <span style="font-style: italic;">"settings done!"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 231: </span>背景を設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-background</span> ()
  <span style="font-style: italic;">"&#32972;&#26223;&#12434;&#12475;&#12483;&#12488;&#12377;&#12427;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"compton"</span> nil <span style="font-style: italic;">"compton --config ~/dotfiles/.config/compton/compton.conf"</span>)
  (start-process-shell-command <span style="font-style: italic;">"fehbg"</span> nil <span style="font-style: italic;">"~/dotfiles/.fehbg"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 232: </span>ワークスペースをトグルする。ワークスペースは0,1しかない想定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/exwm-workspace-switch-last</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((dest 0))
    (<span style="font-weight: bold;">cond</span> ((= exwm-workspace-current-index 0) (<span style="font-weight: bold;">setq</span> dest 1))
          ((= exwm-workspace-current-index 1) (<span style="font-weight: bold;">setq</span> dest 0)))
    (exwm-workspace-switch dest)))
</pre>
</div>

<p>
マルチディスプレイ時に簡易にトグルで切り替える用。ワークスペース切り替え時のbefore hookがないので、他のコマンドで切り替えたときに対応してない。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 233: </span>キーバインド設定</label><pre class="src src-emacs-lisp">(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-:"</span>) 'vterm-toggle)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-&lt;right&gt;"</span>) 'persp-next)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-&lt;left&gt;"</span>) 'persp-prev)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"&lt;henkan&gt;"</span>) 'pretty-hydra-henkan/body)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 234: </span>設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">progn</span>
    (exwm-config-example)

    (tabnine-start-process)
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(kd/set-init)</span>
    ))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 235: </span>マルチディスプレイ設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">exwm-randr</span>)
(<span style="font-weight: bold;">setq</span> exwm-randr-workspace-output-plist '(1 <span style="font-style: italic;">"HDMI-1"</span>))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">arandr&#12391;&#35373;&#23450;&#12379;&#12424;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(remove-hook 'exwm-randr-screen-change-hook</span>
<span style="font-weight: bold; font-style: italic;">;;           </span><span style="font-weight: bold; font-style: italic;">(lambda ()</span>
<span style="font-weight: bold; font-style: italic;">;;             </span><span style="font-weight: bold; font-style: italic;">(start-process-shell-command</span>
<span style="font-weight: bold; font-style: italic;">;;              </span><span style="font-weight: bold; font-style: italic;">"xrandr" nil "xrandr --output HDMI-1 --mode 1920x1080 --same-as eDP-1 --auto")))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(exwm-randr-enable)</span>
</pre>
</div>

<p>
randr関係の修正をしたときは、 <code>(exwm-randr-refresh)</code> を実行して反映する。例えば、画面と対応したワークスペースを変更したとき。
</p>
</div>
</div>

<div id="outline-container-org61c3264" class="outline-2">
<h2 id="org61c3264"><span class="section-number-2">20.</span> Polybar</h2>
<div class="outline-text-2" id="text-20">
<p>
polybarは柔軟にカスタマイズできるメニューバーを表示するソフトウェア。polybarとの連携を記載する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 236: </span>polybarプロセスを保持する変数</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">kd/polybar-process</span> nil
  <span style="font-style: italic;">"Holds the process of the running Polybar instance, if any"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 237: </span>バーを起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/start-panel</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (kd/kill-panel)
  (<span style="font-weight: bold;">setq</span> kd/polybar-process (start-process-shell-command <span style="font-style: italic;">"polybar"</span> nil <span style="font-style: italic;">"~/dotfiles/.config/polybar/launch.sh"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 238: </span>バーを停止する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/kill-panel</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">when</span> kd/polybar-process
    (<span style="font-weight: bold;">ignore-errors</span>
      (kill-process kd/polybar-process)))
  (<span style="font-weight: bold;">setq</span> kd/polybar-process nil))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 239: </span>ワークスペースをpolybarで表示する設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/polybar-exwm-workspace</span> ()
  (<span style="font-weight: bold;">pcase</span> exwm-workspace-current-index
    (0 <span style="font-style: italic;">"%{F#797D7F}Work%{F-} Home"</span>)
    (1 <span style="font-style: italic;">"Work %{F#797D7F}Home%{F-}"</span>)
    (2 <span style="font-style: italic;">"&#59540;"</span>)
    (3 <span style="font-style: italic;">"&#59641;"</span>)
    (4 <span style="font-style: italic;">"&#57418;"</span>)
    (9 <span style="font-style: italic;">"&#61820;"</span>)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/send-polybar-exwm-workspace</span> ()
  (kd/send-polybar-hook <span style="font-style: italic;">"exwm-workspace"</span> 1))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/send-polybar-hook</span> (module-name hook-index)
  (start-process-shell-command <span style="font-style: italic;">"polybar-msg"</span> nil (format <span style="font-style: italic;">"polybar-msg hook %s %s"</span> module-name hook-index)))

(add-hook 'exwm-workspace-switch-hook #'kd/send-polybar-exwm-workspace)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc75cf50" class="outline-2">
<h2 id="orgc75cf50"><span class="section-number-2">21.</span> Workspace</h2>
<div class="outline-text-2" id="text-21">
<p>
1~9のワークスペースを作成し、番号で切り替えられるようにする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 240: </span>モード初期化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">perspective</span>)
(<span style="font-weight: bold;">setq</span> persp-initial-frame-name <span style="font-style: italic;">"1"</span>)
(<span style="font-weight: bold;">setq</span> persp-modestring-dividers '(<span style="font-style: italic;">""</span> <span style="font-style: italic;">""</span> <span style="font-style: italic;">" "</span>))
(persp-mode 1)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 241: </span>ワークスペースを生成する</label><pre class="src src-emacs-lisp">(mapc (<span style="font-weight: bold;">lambda</span> (i)
        (persp-switch (int-to-string i)))
      (number-sequence 0 9))
(persp-switch <span style="font-style: italic;">"1"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org21ae592" class="outline-2">
<h2 id="org21ae592"><span class="section-number-2">22.</span> Hydra</h2>
<div class="outline-text-2" id="text-22">
<p>
Hydraはカスタマイズ可能なキー表示を追加するパッケージ。キーバインド空間を制限しつつ、入力のヒントを表示して使いやすくする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 242: </span>グローバルに便利なメニューを追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> 'pretty-hydra
  (pretty-hydra-define pretty-hydra-henkan (<span style="font-weight: bold;">:color</span> blue <span style="font-weight: bold;">:foreign-keys</span> warn <span style="font-weight: bold;">:title</span> <span style="font-style: italic;">"Convenient Tools"</span>)
    (<span style="font-style: italic;">"Media"</span>
     ((<span style="font-style: italic;">"&lt;prior&gt;"</span> kd/mint-volume-up <span style="font-style: italic;">"up"</span>)
      (<span style="font-style: italic;">"&lt;next&gt;"</span> kd/mint-volume-down <span style="font-style: italic;">"down"</span>)
      (<span style="font-style: italic;">"&lt;home&gt;"</span> kd/player-toggle <span style="font-style: italic;">"media toggle"</span>)
      (<span style="font-style: italic;">"&lt;SPC&gt;"</span> eradio-toggle <span style="font-style: italic;">"eradio"</span>))

     <span style="font-style: italic;">"Find"</span>
     ((<span style="font-style: italic;">"a"</span> counsel-apropos <span style="font-style: italic;">"apropos"</span>)
      (<span style="font-style: italic;">"f"</span> consult-find <span style="font-style: italic;">"find"</span>)
      (<span style="font-style: italic;">"p"</span> consult-project-buffer <span style="font-style: italic;">"project-buffer"</span>)
      (<span style="font-style: italic;">"r"</span> consult-register <span style="font-style: italic;">"list register"</span>)
      (<span style="font-style: italic;">"s"</span> consult-register-store <span style="font-style: italic;">"store register"</span>))

     <span style="font-style: italic;">"Execute"</span>
     ((<span style="font-style: italic;">"d"</span> denote-template <span style="font-style: italic;">"denote-template"</span>)
      (<span style="font-style: italic;">"e"</span> counsel-linux-app <span style="font-style: italic;">"run"</span>)
      (<span style="font-style: italic;">"c"</span> recompile <span style="font-style: italic;">"recompile"</span>)
      (<span style="font-style: italic;">"!"</span> org-pomodoro <span style="font-style: italic;">"start pomodoro"</span>)
      (<span style="font-style: italic;">"n"</span> elfeed <span style="font-style: italic;">"elfeed"</span>)
      (<span style="font-style: italic;">"u"</span> kd/set-proxy-mode-manual <span style="font-style: italic;">"use proxy"</span>)
      (<span style="font-style: italic;">"h"</span> eldoc-doc-buffer <span style="font-style: italic;">"eldoc at pos"</span>))

     <span style="font-style: italic;">"Git"</span>
     ((<span style="font-style: italic;">"g"</span> git-link)
      (<span style="font-style: italic;">"&gt;"</span> git-gutter:next-hunk)
      (<span style="font-style: italic;">"&lt;"</span> git-gutter:previous-hunk)
      (<span style="font-style: italic;">"@"</span> git-timemachine))

     <span style="font-style: italic;">"Edit"</span>
     ((<span style="font-style: italic;">"q"</span> query-replace <span style="font-style: italic;">"replace"</span>)
      (<span style="font-style: italic;">"y"</span> ivy-yasnippet <span style="font-style: italic;">"yas"</span>)
      (<span style="font-style: italic;">"R"</span> revert-buffer-no-confirm <span style="font-style: italic;">"reload"</span>))

     <span style="font-style: italic;">"Window"</span>
     ((<span style="font-style: italic;">"l"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch-last)) <span style="font-style: italic;">"Last"</span>)
      (<span style="font-style: italic;">"1"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 1))) <span style="font-style: italic;">"Journal"</span>)
      (<span style="font-style: italic;">"2"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 2))) <span style="font-style: italic;">"Roam"</span>)
      (<span style="font-style: italic;">"3"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 3))) <span style="font-style: italic;">"Browser(Half)"</span>)
      (<span style="font-style: italic;">"4"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 4))) <span style="font-style: italic;">"Browser(Full)"</span>)
      (<span style="font-style: italic;">"5"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 5))) <span style="font-style: italic;">"Dotfiles"</span>)
      (<span style="font-style: italic;">"6"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 6))) <span style="font-style: italic;">"Emacs"</span>)
      (<span style="font-style: italic;">"7"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 7))) <span style="font-style: italic;">"Sub"</span>)
      (<span style="font-style: italic;">"8"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 8))) <span style="font-style: italic;">"Main"</span>)
      (<span style="font-style: italic;">"9"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 9))) <span style="font-style: italic;">"Elfeed"</span>)
      (<span style="font-style: italic;">"0"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 0))) <span style="font-style: italic;">"Sub"</span>))

     <span style="font-style: italic;">"Workspace"</span>
     ((<span style="font-style: italic;">"w"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (kd/exwm-workspace-switch-last)) <span style="font-style: italic;">"Last"</span>))))

  (define-key global-map (kbd <span style="font-style: italic;">"&lt;henkan&gt;"</span>) 'pretty-hydra-henkan/body))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 243: </span>Railsに便利なメニューを定義する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> 'pretty-hydra
  (pretty-hydra-define pretty-hydra-projectile-rails-find (<span style="font-weight: bold;">:color</span> blue <span style="font-weight: bold;">:foreign-keys</span> warn <span style="font-weight: bold;">:title</span> <span style="font-style: italic;">"Projectile Rails"</span>)
    (<span style="font-style: italic;">"Current"</span>
     ((<span style="font-style: italic;">"M"</span> projectile-rails-find-current-model      <span style="font-style: italic;">"Current model"</span>)
      (<span style="font-style: italic;">"V"</span> projectile-rails-find-current-view       <span style="font-style: italic;">"Current view"</span>)
      (<span style="font-style: italic;">"C"</span> projectile-rails-find-current-controller <span style="font-style: italic;">"Current controller"</span>)
      (<span style="font-style: italic;">"H"</span> projectile-rails-find-current-helper     <span style="font-style: italic;">"Current helper"</span>)
      (<span style="font-style: italic;">"P"</span> projectile-rails-find-current-spec       <span style="font-style: italic;">"Current spec"</span>)
      (<span style="font-style: italic;">"Z"</span> projectile-rails-find-current-serializer <span style="font-style: italic;">"Current serializer"</span>))

     <span style="font-style: italic;">"App"</span>
     ((<span style="font-style: italic;">"m"</span> projectile-rails-find-model           <span style="font-style: italic;">"Model"</span>)
      (<span style="font-style: italic;">"v"</span> projectile-rails-find-view            <span style="font-style: italic;">"View"</span>)
      (<span style="font-style: italic;">"c"</span> projectile-rails-find-controller      <span style="font-style: italic;">"Controller"</span>)
      (<span style="font-style: italic;">"h"</span> projectile-rails-find-helper          <span style="font-style: italic;">"Helper"</span>)
      (<span style="font-style: italic;">"@"</span> projectile-rails-find-mailer          <span style="font-style: italic;">"Mailer"</span>)
      (<span style="font-style: italic;">"y"</span> projectile-rails-find-layout       <span style="font-style: italic;">"Layout"</span>)
      (<span style="font-style: italic;">"z"</span> projectile-rails-find-serializer      <span style="font-style: italic;">"Serializer"</span>))

     <span style="font-style: italic;">"Assets"</span>
     ((<span style="font-style: italic;">"j"</span> projectile-rails-find-javascript  <span style="font-style: italic;">"Javascript"</span>)
      (<span style="font-style: italic;">"s"</span> projectile-rails-find-stylesheet  <span style="font-style: italic;">"CSS"</span>))

     <span style="font-style: italic;">"Other"</span>
     ((<span style="font-style: italic;">"n"</span> projectile-rails-find-migration    <span style="font-style: italic;">"Migration"</span>)
      (<span style="font-style: italic;">"r"</span> projectile-rails-find-rake-task    <span style="font-style: italic;">"Rake task"</span>)
      (<span style="font-style: italic;">"i"</span> projectile-rails-find-initializer  <span style="font-style: italic;">"Initializer"</span>)
      (<span style="font-style: italic;">"l"</span> projectile-rails-find-lib          <span style="font-style: italic;">"Lib"</span>)
      (<span style="font-style: italic;">"p"</span> projectile-rails-find-spec         <span style="font-style: italic;">"Spec"</span>)
      (<span style="font-style: italic;">"t"</span> projectile-rails-find-locale       <span style="font-style: italic;">"Translation"</span>))

     <span style="font-style: italic;">"Single Files"</span>
     ((<span style="font-style: italic;">"R"</span> projectile-rails-goto-routes   <span style="font-style: italic;">"routes.rb"</span>)
      (<span style="font-style: italic;">"G"</span> projectile-rails-goto-gemfile  <span style="font-style: italic;">"Gemfile"</span>)
      (<span style="font-style: italic;">"D"</span> projectile-rails-goto-schema   <span style="font-style: italic;">"schema.rb"</span>)))))
</pre>
</div>

<ul class="org-ul">
<li><a href="https://mugijiru.github.io/.emacs.d/programming/rails/">https://mugijiru.github.io/.emacs.d/programming/rails/</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 244: </span>major-mode-hydra</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"M-SPC"</span>) #'major-mode-hydra)

(<span style="font-weight: bold;">with-eval-after-load</span> 'major-mode-hydra
  (major-mode-hydra-define emacs-lisp-mode nil
    (<span style="font-style: italic;">"Eval"</span>
     ((<span style="font-style: italic;">"b"</span> eval-buffer <span style="font-style: italic;">"buffer"</span>)
      (<span style="font-style: italic;">"e"</span> eval-defun <span style="font-style: italic;">"defun"</span>))
     <span style="font-style: italic;">"REPL"</span>
     ((<span style="font-style: italic;">"I"</span> ielm <span style="font-style: italic;">"ielm"</span>))
     <span style="font-style: italic;">"Test"</span>
     ((<span style="font-style: italic;">"r"</span> (ert-run-tests-interactively (car ert--selector-history)) <span style="font-style: italic;">"rerun"</span>)
      (<span style="font-style: italic;">"t"</span> ert <span style="font-style: italic;">"prompt"</span>)
      (<span style="font-style: italic;">"T"</span> (ert t) <span style="font-style: italic;">"all"</span>)
      (<span style="font-style: italic;">"F"</span> (ert <span style="font-weight: bold;">:failed</span>) <span style="font-style: italic;">"failed"</span>))
     <span style="font-style: italic;">"Doc"</span>
     ((<span style="font-style: italic;">"f"</span> describe-function <span style="font-style: italic;">"function"</span>)
      (<span style="font-style: italic;">"v"</span> describe-variable <span style="font-style: italic;">"variable"</span>)
      (<span style="font-style: italic;">"i"</span> info-lookup-symbol <span style="font-style: italic;">"info lookup"</span>)))))

(<span style="font-weight: bold;">with-eval-after-load</span> 'major-mode-hydra
  (major-mode-hydra-define org-agenda-mode nil
    (<span style="font-style: italic;">"pomodoro"</span>
     ((<span style="font-style: italic;">"s"</span> org-pomodoro <span style="font-style: italic;">"start org-pomodoro"</span>)))))
</pre>
</div>

<p>
メジャーモードに対するhydraを設定する。
</p>
</div>
</div>

<div id="outline-container-org5df1844" class="outline-2">
<h2 id="org5df1844"><span class="section-number-2">23.</span> Display Manager</h2>
<div class="outline-text-2" id="text-23">
<p>
OS操作の便利関数。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 245: </span>音量調整する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/mint-volume-up</span> ()
  <span style="font-style: italic;">"Linux Mint&#12391;&#12398;&#38899;&#37327;&#12450;&#12483;&#12503;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"volume up"</span> nil <span style="font-style: italic;">"pactl set-sink-volume @DEFAULT_SINK@ +5%"</span>))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/mint-volume-down</span> ()
  <span style="font-style: italic;">"Linux Mint&#12391;&#12398;&#38899;&#37327;&#12480;&#12454;&#12531;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"volume up"</span> nil <span style="font-style: italic;">"pactl set-sink-volume @DEFAULT_SINK@ -5%"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 246: </span>再生を切り替える</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/player-toggle</span> ()
  <span style="font-style: italic;">"&#20877;&#29983;&#20572;&#27490;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"player stop"</span> nil <span style="font-style: italic;">"playerctl play-pause"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 247: </span>ネットワークを接続・切断する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/up-network</span> ()
  <span style="font-style: italic;">"&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#25509;&#32154;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((passwd))
    (<span style="font-weight: bold;">setq</span> passwd (read-passwd <span style="font-style: italic;">"Password? "</span>))
    (shell-command  (concat <span style="font-style: italic;">"for intf in /sys/class/net/*; do echo "</span>
                            (shell-quote-argument passwd)
                            <span style="font-style: italic;">" | sudo -S ifconfig `basename $intf` up; done"</span>))))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/down-network</span> ()
  <span style="font-style: italic;">"&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#20999;&#26029;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((passwd))
    (<span style="font-weight: bold;">setq</span> passwd (read-passwd <span style="font-style: italic;">"Password? "</span>))
    (shell-command  (concat <span style="font-style: italic;">"for intf in /sys/class/net/*; do echo "</span>
                            (shell-quote-argument passwd)
                            <span style="font-style: italic;">" | sudo -S ifconfig `basename $intf` down; done"</span>))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 248: </span>プロキシ設定を変更する(Ubuntu)</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-proxy-mode-manual</span> ()
  <span style="font-style: italic;">"&#12503;&#12525;&#12461;&#12471;&#12434;manual mode&#12395;&#12377;&#12427;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (shell-command <span style="font-style: italic;">"gsettings set org.gnome.system.proxy mode '</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">manual</span><span style="font-style: italic;">'"</span>)
  (message <span style="font-style: italic;">"use proxy..."</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 249: </span>英語辞書をインストールする。あまり使ってないのでコメントアウトしている</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package ej-dict</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:straight (:host github :repo "kijimaD/ej-dict"))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(ej-dict-install-dict)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3bf0faf" class="outline-2">
<h2 id="org3bf0faf"><span class="section-number-2">24.</span> Helper</h2>
<div class="outline-text-2" id="text-24">
<p>
その他の便利関数。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 250: </span>前のマークに戻る</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-exchange-point-and-mark</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (exchange-point-and-mark)
  (deactivate-mark))
(global-set-key (kbd <span style="font-style: italic;">"C-x C-x"</span>) 'my-exchange-point-and-mark)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 251: </span>行全体を削除する</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-c C-k"</span>) 'kill-whole-line)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 252: </span>カレントパスを取得する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">current-path</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((file-path buffer-file-name)
        (dir-path default-directory))
    (<span style="font-weight: bold;">cond</span> (file-path
           (kill-new (expand-file-name file-path))
           (message <span style="font-style: italic;">"Add Kill Ring: %s"</span> (expand-file-name file-path)))
          (dir-path
           (kill-new (expand-file-name dir-path))
           (message <span style="font-style: italic;">"Add Kill Ring: %s"</span> (expand-file-name dir-path)))
          (t
           (error-message-string <span style="font-style: italic;">"Fail to get path name."</span>)))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 253: </span>i-searchで逆側にカーソルをセットする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-isearch-done-opposite</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> nopush edit)
  <span style="font-style: italic;">"End current search in the opposite side of the match."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (funcall #'isearch-done nopush edit)
  (<span style="font-weight: bold;">when</span> isearch-other-end (goto-char isearch-other-end)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 254: </span>カーソルを真ん中に保ちつつ行を1つ移動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-next-line</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (next-line)
  (recenter))
(global-set-key (kbd <span style="font-style: italic;">"&lt;down&gt;"</span>) 'my-next-line)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-previous-line</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (previous-line)
  (recenter))
(global-set-key (kbd <span style="font-style: italic;">"&lt;up&gt;"</span>) 'my-previous-line)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 255: </span>ewwのキーバインドを設定する</label><pre class="src src-emacs-lisp">(eval-after-load <span style="font-style: italic;">"eww"</span>
  '(progn
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-1&gt;"</span>) 'my-next-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-2&gt;"</span>) 'define-word-at-point)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-4&gt;"</span>) 'my-previous-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;down-mouse-4&gt;"</span>) 'nil)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-5&gt;"</span>) 'my-next-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;down-mouse-5&gt;"</span>) 'nil)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-3&gt;"</span>) 'my-previous-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-8&gt;"</span>) 'backward-word)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-9&gt;"</span>) 'forward-word)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 256: </span>最後のタイマーをキャンセルする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/cancel-last-timer</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (cancel-timer (car (last timer-list))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 257: </span>Cの関数に定義ジャンプできるようにする</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Emacs C source directory</span>
(<span style="font-weight: bold;">let</span> ((src-dir <span style="font-style: italic;">"~/ProjectOrg/emacs/emacs/src"</span>))
  (<span style="font-weight: bold;">if</span> (file-directory-p src-dir)
      (<span style="font-weight: bold;">setq</span> source-directory src-dir)))
</pre>
</div>

<p>
前提: <code>~/ProjectOrg/emacs</code> にEmacsのソースコードを配置しておく。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/junk-image</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let*</span> ((date-string (format-time-string <span style="font-style: italic;">"%Y%m%d"</span>))
         (name (read-from-minibuffer <span style="font-style: italic;">"filename? "</span>))
         (format-string (format <span style="font-style: italic;">"%s-%s.drawio.svg"</span> date-string name)))
    (kill-new format-string)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org26501b7" class="outline-2">
<h2 id="org26501b7"><span class="section-number-2">25.</span> delve-mode</h2>
<div class="outline-text-2" id="text-25">
<p>
delve-mode は <code>M-x gdb</code> と同じインターフェースで扱えるパッケージ。<a href="https://github.com/benma/go-dlv.el/">benma/go-dlv.el</a>で配布されているものを持ってきた。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 258: </span>コピペ</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">go-dlv.el --- Go Delve - Debug Go programs interactively with the GUD.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Copyright (C) 2015, 2019 Marko Bencun</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Author: Marko Bencun <a href="mailto:mbencun%40gmail.com">&lt;mbencun@gmail.com&gt;</a></span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">URL: https://github.com/benma/go-dlv.el/</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Version: 0.6</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Package-Requires: ((go-mode "1.3.1"))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Keywords: Go, debug, debugger, delve, interactive, gud</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">This file is part of go-dlv.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">go-dlv is free software: you can redistribute it and/or modify</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">it under the terms of the GNU General Public License as published by</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">the Free Software Foundation, either version 3 of the License, or</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(at your option) any later version.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">go-dlv is distributed in the hope that it will be useful,</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">GNU General Public License for more details.</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">You should have received a copy of the GNU General Public License</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">along with go-dlv.  If not, see <a href="http://www.gnu.org/licenses/">&lt;http://www.gnu.org/licenses/&gt;</a>.</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Installation</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">If you are using Emacs 24 or later, you can get go-dlv from [melpa](https://melpa.org/) with the package manager.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Add the following code to your init file.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">----------------------------------------------------------</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-to-list 'load-path "folder-in-which-go-dlv-files-are-in/") ;; if the files are not already in the load path</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(require 'go-dlv)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">----------------------------------------------------------</span>

<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">Code:</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">The code below is based on gud's pdb debugger, adapted to dlv:</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">https://github.com/emacs-mirror/emacs/blob/8badbad184c75d6a9b17b72900ca091a1bd11397/lisp/progmodes/gud.el#L1594-1698</span>

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">gud</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">go-mode</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Sample marker lines:</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&gt; main.main() ./test.go:10 (hits goroutine(5):1 total:1)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&gt; [unrecovered-panic] runtime.fatalpanic() /usr/lib/golang/src/runtime/panic.go:681 (hits goroutine(16):1 total:1) (PC: 0x435140)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Frame 2: /usr/lib/golang/src/testing/testing.go:792 (PC: 50fc82)</span>
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">go-dlv-marker-regexp</span>
  <span style="font-style: italic;">"^</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(?:</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(?:</span><span style="font-style: italic;">&gt; .+?(.*?) </span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">|</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(?:</span><span style="font-style: italic;">Frame [0-9]+: </span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(</span><span style="font-style: italic;">.+?</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-style: italic;">\\:</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">(</span><span style="font-style: italic;">[0-9]+</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">)</span><span style="font-style: italic;">"</span>)

(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">go-dlv-marker-regexp-file-group</span> 1)
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">go-dlv-marker-regexp-line-group</span> 2)

(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">go-dlv-marker-regexp-start</span> <span style="font-style: italic;">"^&gt; "</span>)

(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">go-dlv-marker-acc</span> <span style="font-style: italic;">""</span>)
(make-variable-buffer-local 'go-dlv-marker-acc)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">There's no guarantee that Emacs will hand the filter the entire</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">marker at once; it could be broken up across several strings.  We</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">might even receive a big chunk with several markers in it.  If we</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">receive a chunk of text which looks like it might contain the</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">beginning of a marker, we save it here between calls to the</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">filter.</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">go-dlv-marker-filter</span> (string)
  (<span style="font-weight: bold;">setq</span> go-dlv-marker-acc (concat go-dlv-marker-acc string))
  (<span style="font-weight: bold;">let</span> ((output <span style="font-style: italic;">""</span>))
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Process all the complete markers in this chunk.</span>
    (<span style="font-weight: bold;">while</span> (string-match go-dlv-marker-regexp go-dlv-marker-acc)
      (<span style="font-weight: bold;">setq</span>

       <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Extract the frame position from the marker.</span>
       gud-last-frame
       (<span style="font-weight: bold;">let</span> ((file (match-string go-dlv-marker-regexp-file-group
                                 go-dlv-marker-acc))
             (line (string-to-number
                    (match-string go-dlv-marker-regexp-line-group
                                  go-dlv-marker-acc))))
         (cons file line))

       <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Output everything instead of the below</span>
       output (concat output (substring go-dlv-marker-acc 0 (match-end 0)))
       <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">         ;; Append any text before the marker to the output we're going</span>
       <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">         ;; to return - we don't include the marker in this text.</span>
       <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">         output (concat output</span>
       <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">                     (substring go-dlv-marker-acc 0 (match-beginning 0)))</span>

       <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the accumulator to the remaining text.</span>
       go-dlv-marker-acc (substring go-dlv-marker-acc (match-end 0))))

    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Does the remaining text look like it might end with the</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">beginning of another marker?  If it does, then keep it in</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">go-dlv-marker-acc until we receive the rest of it.  Since we</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">know the full marker regexp above failed, it's pretty simple to</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">test for marker starts.</span>
    (<span style="font-weight: bold;">if</span> (string-match go-dlv-marker-regexp-start go-dlv-marker-acc)
        (<span style="font-weight: bold;">progn</span>
          <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Everything before the potential marker start can be output.</span>
          (<span style="font-weight: bold;">setq</span> output (concat output (substring go-dlv-marker-acc
                                                 0 (match-beginning 0))))

          <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Everything after, we save, to combine with later input.</span>
          (<span style="font-weight: bold;">setq</span> go-dlv-marker-acc
                (substring go-dlv-marker-acc (match-beginning 0))))

      (<span style="font-weight: bold;">setq</span> output (concat output go-dlv-marker-acc)
            go-dlv-marker-acc <span style="font-style: italic;">""</span>))

    output))

(<span style="font-weight: bold;">define-obsolete-variable-alias</span> 'go-dlv-command-name
  'gud-dlv-command-name
  <span style="font-style: italic;">"0.4"</span>)

(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">gud-dlv-command-name</span> <span style="font-style: italic;">"dlv"</span>
  <span style="font-style: italic;">"File name for executing the Go Delve debugger.</span>
<span style="font-style: italic;">This should be an executable on your path, or an absolute file name."</span>
  <span style="font-weight: bold;">:type</span> 'string
  <span style="font-weight: bold;">:group</span> 'gud)

<span style="font-weight: bold; font-style: italic;">;;;</span><span style="font-weight: bold; font-style: italic;">###</span><span style="font-weight: bold; font-style: italic;">autoload</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dlv</span> (command-line)
  <span style="font-style: italic;">"Run dlv on program FILE in buffer `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">*gud-FILE*</span><span style="font-style: italic;">'.</span>
<span style="font-style: italic;">The directory containing FILE becomes the initial working directory</span>
<span style="font-style: italic;">and source-file directory for your debugger."</span>
  (<span style="font-weight: bold;">interactive</span>
   (list (gud-query-cmdline 'dlv <span style="font-style: italic;">"debug"</span>)))

  (gud-common-init command-line nil 'go-dlv-marker-filter)
  (set (make-local-variable 'gud-minor-mode) 'dlv)

  (gud-def gud-break  <span style="font-style: italic;">"break %d%f:%l"</span>    <span style="font-style: italic;">"\C-b"</span> <span style="font-style: italic;">"Set breakpoint at current line."</span>)
  (gud-def gud-trace  <span style="font-style: italic;">"trace %d%f:%l"</span>    <span style="font-style: italic;">"\C-t"</span> <span style="font-style: italic;">"Set trace at current line."</span>)
  (gud-def gud-remove <span style="font-style: italic;">"clearall %d%f:%l"</span> <span style="font-style: italic;">"\C-d"</span> <span style="font-style: italic;">"Remove breakpoint at current line"</span>)
  (gud-def gud-step   <span style="font-style: italic;">"step"</span>             <span style="font-style: italic;">"\C-s"</span> <span style="font-style: italic;">"Step one source line with display."</span>)
  (gud-def gud-finish <span style="font-style: italic;">"stepout"</span>          <span style="font-style: italic;">"\C-f"</span> <span style="font-style: italic;">"Finish executing current function."</span>)
  (gud-def gud-next   <span style="font-style: italic;">"next"</span>             <span style="font-style: italic;">"\C-n"</span> <span style="font-style: italic;">"Step one line (skip functions)."</span>)
  (gud-def gud-cont   <span style="font-style: italic;">"continue"</span>         <span style="font-style: italic;">"\C-r"</span> <span style="font-style: italic;">"Continue running program."</span>)
  (gud-def gud-until  <span style="font-style: italic;">"continue %d%f:%l"</span> <span style="font-style: italic;">"\C-u"</span> <span style="font-style: italic;">"Continue to current line."</span>)
  (gud-def gud-print  <span style="font-style: italic;">"print %e"</span>         <span style="font-style: italic;">"\C-p"</span> <span style="font-style: italic;">"Evaluate Go expression at point."</span>)
  (gud-def gud-watch  <span style="font-style: italic;">"display -a %e"</span>    <span style="font-style: italic;">"\C-w"</span> <span style="font-style: italic;">"Print expression at point on every step."</span>)
  (gud-def gud-up     <span style="font-style: italic;">"up %p"</span>            <span style="font-style: italic;">"&lt;"</span>    <span style="font-style: italic;">"Up N stack frames (numeric arg)."</span>)
  (gud-def gud-down   <span style="font-style: italic;">"down %p"</span>          <span style="font-style: italic;">"&gt;"</span>    <span style="font-style: italic;">"Down N stack frames (numeric arg)."</span>)

  (<span style="font-weight: bold;">setq</span> comint-prompt-regexp <span style="font-style: italic;">"^(Dlv) *"</span>)
  (<span style="font-weight: bold;">setq</span> paragraph-start comint-prompt-regexp)
  (run-hooks 'go-dlv-mode-hook))

<span style="font-weight: bold; font-style: italic;">;;;</span><span style="font-weight: bold; font-style: italic;">###</span><span style="font-weight: bold; font-style: italic;">autoload</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dlv-current-func</span> ()
  <span style="font-style: italic;">"Debug the current program or test stopping at the beginning of the current function."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> (current-test-name current-bench-name current-func-loc)
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">find the location of the current function and (if it is a test function) its name</span>
    (<span style="font-weight: bold;">save-excursion</span>
      (<span style="font-weight: bold;">when</span> (go-beginning-of-defun)
        (<span style="font-weight: bold;">setq</span> current-func-loc (format <span style="font-style: italic;">"%s:%d"</span> buffer-file-name (line-number-at-pos)))
        <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Check for Test or Benchmark function, set current-test-name/current-bench-name</span>
        (<span style="font-weight: bold;">when</span> (looking-at go-func-regexp)
          (<span style="font-weight: bold;">let</span> ((func-name (match-string 1)))
            (<span style="font-weight: bold;">when</span> (string-match-p <span style="font-style: italic;">"_test</span><span style="font-weight: bold; font-style: italic;">\</span><span style="font-style: italic;">.go$"</span> buffer-file-name)
              (<span style="font-weight: bold;">cond</span>
               ((string-match-p <span style="font-style: italic;">"^Test</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">|</span><span style="font-style: italic;">^Example"</span> func-name)
                (<span style="font-weight: bold;">setq</span> current-test-name func-name))
               ((string-match-p <span style="font-style: italic;">"^Benchmark"</span> func-name)
                (<span style="font-weight: bold;">setq</span> current-bench-name func-name))))))))

    (<span style="font-weight: bold;">if</span> current-func-loc
        (<span style="font-weight: bold;">let</span> (gud-buffer-name dlv-command)
          (<span style="font-weight: bold;">cond</span>
           (current-test-name
            (<span style="font-weight: bold;">setq</span> gud-buffer-name <span style="font-style: italic;">"*gud-test*"</span>)
            (<span style="font-weight: bold;">setq</span> dlv-command (concat gud-dlv-command-name <span style="font-style: italic;">" test -- -test.run "</span> current-test-name)))
           (current-bench-name
            (<span style="font-weight: bold;">setq</span> gud-buffer-name <span style="font-style: italic;">"*gud-test*"</span>)
            (<span style="font-weight: bold;">setq</span> dlv-command (concat gud-dlv-command-name <span style="font-style: italic;">" test -- -test.run='</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">^$</span><span style="font-style: italic;">' -test.bench="</span> current-bench-name)))
           (t
            (<span style="font-weight: bold;">setq</span> gud-buffer-name <span style="font-style: italic;">"*gud-debug*"</span>)
            (<span style="font-weight: bold;">setq</span> dlv-command (concat gud-dlv-command-name <span style="font-style: italic;">" debug"</span>))))

          <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">stop the current active dlv session if any</span>
          (<span style="font-weight: bold;">let</span> ((gud-buffer (get-buffer gud-buffer-name)))
            (<span style="font-weight: bold;">when</span> gud-buffer (kill-buffer gud-buffer)))

          <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">run dlv and stop at the beginning of the current function</span>
          (dlv dlv-command)
          (gud-call (format <span style="font-style: italic;">"break %s"</span> current-func-loc))
          (gud-call <span style="font-style: italic;">"continue"</span>))
      (<span style="font-weight: bold;">error</span> <span style="font-style: italic;">"Not in function"</span>))))

(<span style="font-weight: bold;">provide</span> '<span style="font-weight: bold; text-decoration: underline;">go-dlv</span>)
<span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">go-dlv.el ends here</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf530457" class="outline-2">
<h2 id="orgf530457"><span class="section-number-2">26.</span> spray</h2>
<div class="outline-text-2" id="text-26">
<p>
sprayは速読表示してくれる拡張。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">spray</span>)
(<span style="font-weight: bold;">setq</span> spray-wpm 200)
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Anka</p>
<p class="date">Created: 2025-02-11 Tue 06:47</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
