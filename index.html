<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-18 Sun 11:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>kijimad Emacs Config</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">kijimad Emacs Config</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org7afa53d">1. Emacs</a></li>
<li><a href="#org826241d">2. Rails</a></li>
<li><a href="#org9e147c6">3. go-mode</a></li>
<li><a href="#orgced963b">4. python-mode</a></li>
<li><a href="#orgf78932d">5. haskell-mode</a></li>
<li><a href="#orgc194dae">6. web-mode</a></li>
<li><a href="#org53b50af">7. LSP</a></li>
<li><a href="#org3696332">8. corfu</a></li>
<li><a href="#org118a846">9. ivy</a></li>
<li><a href="#orgadec970">10. counsel</a></li>
<li><a href="#org912ba55">11. ag</a></li>
<li><a href="#orgc0ea29d">12. eldoc</a></li>
<li><a href="#org09f6a7a">13. eshell</a></li>
<li><a href="#orgee33673">14. Vterm</a></li>
<li><a href="#org8f23871">15. Theme</a></li>
<li><a href="#org38aa6ec">16. EXWM</a></li>
<li><a href="#org4e971e2">17. Polybar</a></li>
<li><a href="#org41171ef">18. Workspace</a></li>
<li><a href="#org1a07bf9">19. Hydra</a></li>
<li><a href="#orgcf8cf04">20. Display Manager</a></li>
<li><a href="#org2130db7">21. Helper</a></li>
</ul>
</div>
</div>

<div id="outline-container-org7afa53d" class="outline-2">
<h2 id="org7afa53d"><span class="section-number-2">1.</span> Emacs</h2>
<div class="outline-text-2" id="text-1">
<p>
Emacsの文芸的設定。
</p>

<ul class="org-ul">
<li><a href="https://github.com/kijimaD/.emacs.d">Repository</a></li>
</ul>
</div>
</div>

<div id="outline-container-org826241d" class="outline-2">
<h2 id="org826241d"><span class="section-number-2">2.</span> Rails</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>基本設定</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;;; </span><span style="font-weight: bold; font-style: italic;">ruby_on_rails&#12514;&#12540;&#12489;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">projectile-rails</span>)
(projectile-rails-global-mode)
(add-hook 'projectile-mode-hook 'projectile-rails-on)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">rspec ================</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rspec-mode</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Rspec&#12398;&#23455;&#34892;&#32080;&#26524;&#12434;&#12473;&#12463;&#12525;&#12540;&#12523;&#12375;&#12390;&#20986;&#21147;&#12377;&#12427;</span>
(<span style="font-weight: bold;">setq</span> compilation-scroll-output t)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Docker&#12398;&#12392;&#12365;&#12398;&#35373;&#23450;&#12290;&#12503;&#12525;&#12472;&#12455;&#12463;&#12488;&#12372;&#12392;&#12395;&#35373;&#23450;&#12375;&#12383;&#12356;&#12364;&#8230;</span>
(<span style="font-weight: bold;">setq</span> rspec-use-docker-when-possible 1)
(<span style="font-weight: bold;">setq</span> rspec-docker-container <span style="font-style: italic;">"rails"</span>)
(<span style="font-weight: bold;">setq</span> rspec-docker-command <span style="font-style: italic;">"docker-compose -f docker-compose.yml -f docker-compose-app.yml -f docker-compose-app.override.yml exec"</span>)
(<span style="font-weight: bold;">setq</span> rspec-docker-cwd <span style="font-style: italic;">""</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">RAILS_ENV=test&#12434;&#36861;&#21152;</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">rspec-runner</span> ()
  <span style="font-style: italic;">"Return command line to run rspec."</span>
  (<span style="font-weight: bold;">let</span> ((bundle-command (<span style="font-weight: bold;">if</span> (rspec-bundle-p) <span style="font-style: italic;">"RAILS_ENV=test bundle exec "</span> <span style="font-style: italic;">""</span>))
        (zeus-command (<span style="font-weight: bold;">if</span> (rspec-zeus-p) <span style="font-style: italic;">"zeus "</span> nil))
        (spring-command (<span style="font-weight: bold;">if</span> (rspec-spring-p) <span style="font-style: italic;">"spring "</span> nil)))
    (concat (<span style="font-weight: bold;">or</span> zeus-command spring-command bundle-command)
            (<span style="font-weight: bold;">if</span> (rspec-rake-p)
                (concat rspec-rake-command <span style="font-style: italic;">" spec"</span>)
              rspec-spec-command))))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq rspec-use-spring-when-possible nil)</span>
(<span style="font-weight: bold;">setq</span> rspec-use-spring-when-possible t)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">rspec-spring-p</span> ()
  (<span style="font-weight: bold;">and</span> rspec-use-spring-when-possible
       (stringp (executable-find <span style="font-style: italic;">"spring"</span>))))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">spring</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">bin/rspec</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12471;&#12531;&#12479;&#12483;&#12463;&#12473;&#12481;&#12455;&#12483;&#12463; ================</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">flycheck &#12392; rubocop &#12434;&#36899;&#25658;&#12373;&#12379;&#12427;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rubocop</span>)
(add-hook 'ruby-mode-hook 'rubocop-mode)
(add-hook 'ruby-mode-hook
          '(lambda ()
             (<span style="font-weight: bold;">setq</span> flycheck-checker 'ruby-rubocop)))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">See: https://qiita.com/watson1978/items/debafdfc49511fb173e9</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#29420;&#33258;&#12395; checker &#12434;&#23450;&#32681;&#12377;&#12427;&#65288;&#12362;&#22909;&#12415;&#12391;&#65289;</span>
(flycheck-define-checker ruby-rubocop
  <span style="font-style: italic;">"A Ruby syntax and style checker using the RuboCop tool."</span>
  <span style="font-weight: bold;">:command</span> (<span style="font-style: italic;">"rubocop"</span> <span style="font-style: italic;">"--format"</span> <span style="font-style: italic;">"emacs"</span>
            (config-file <span style="font-style: italic;">"--config"</span> flycheck-rubocoprc) source)
  <span style="font-weight: bold;">:error-patterns</span>
  ((warning line-start
            (file-name) <span style="font-style: italic;">":"</span> line <span style="font-style: italic;">":"</span> column <span style="font-style: italic;">": "</span> (<span style="font-weight: bold;">or</span> <span style="font-style: italic;">"C"</span> <span style="font-style: italic;">"W"</span>) <span style="font-style: italic;">": "</span> (message) line-end)
   (<span style="font-weight: bold;">error</span> line-start
          (file-name) <span style="font-style: italic;">":"</span> line <span style="font-style: italic;">":"</span> column <span style="font-style: italic;">": "</span> (<span style="font-weight: bold;">or</span> <span style="font-style: italic;">"E"</span> <span style="font-style: italic;">"F"</span>) <span style="font-style: italic;">": "</span> (message) line-end))
  <span style="font-weight: bold;">:modes</span> (ruby-mode motion-mode))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">rinari</span>
(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span> nil 'noerror)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span>)
  (add-hook 'ruby-mode-hook 'rinari-minor-mode))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">rspec-mode &#29992;&#12398; snippet &#12434;&#35469;&#35672;&#12373;&#12379;&#12427;</span>
(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rinari</span> nil 'noerror)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rspec-mode</span>)
  (eval-after-load 'rspec-mode
    '(rspec-install-snippets)))

(<span style="font-weight: bold;">setq</span> flycheck-ruby-rubocop-executable <span style="font-style: italic;">"bundle exec rubocop"</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#35036;&#23436; ================</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ruby-electric</span>)
(add-hook 'ruby-mode-hook '(lambda ()
                             (ruby-electric-mode t)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;&#29872;&#22659; ================</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">quickrun</span>)
(global-set-key (kbd <span style="font-style: italic;">"&lt;f8&gt;"</span>) 'quickrun)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">pry</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">inf-ruby</span>)
(<span style="font-weight: bold;">setq</span> inf-ruby-default-implementation <span style="font-style: italic;">"pry"</span>)
(<span style="font-weight: bold;">setq</span> inf-ruby-eval-binding <span style="font-style: italic;">"Pry.toplevel_binding"</span>)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">ri&#12394;&#12393;&#12398;&#12456;&#12473;&#12465;&#12540;&#12503;&#12471;&#12540;&#12465;&#12531;&#12473;&#12434;&#20966;&#29702;&#12375;&#12289;&#33394;&#20184;&#12369;&#12377;&#12427;</span>
(add-hook 'inf-ruby-mode-hook 'ansi-color-for-comint-mode-on)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">slim-mode ================</span>
(<span style="font-weight: bold;">unless</span> (package-installed-p 'slim-mode)
  (package-refresh-contents) (package-install 'slim-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.slim?\\'"</span> . slim-mode))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">yaml-mode ================</span>
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.ya?ml$"</span> . yaml-mode))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12510;&#12472;&#12483;&#12463;&#12467;&#12513;&#12531;&#12488;&#12434;&#25407;&#20837;&#12375;&#12394;&#12356;</span>
(<span style="font-weight: bold;">setq</span> ruby-insert-encoding-magic-comment nil)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23550;&#24540;&#12502;&#12525;&#12483;&#12463;&#12434;&#20809;&#12425;&#12379;&#12427;&#26178;&#38291;&#12434;&#30701;&#12367;&#12377;&#12427;</span>
(<span style="font-weight: bold;">defcustom</span> <span style="font-weight: bold; font-style: italic;">ruby-block-delay</span> 0
  <span style="font-style: italic;">"*Time in seconds to delay before showing a matching paren."</span>
  <span style="font-weight: bold;">:type</span>  'number
  <span style="font-weight: bold;">:group</span> 'ruby-block)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">xmp(&#23455;&#34892;&#32080;&#26524;&#12450;&#12494;&#12486;&#12540;&#12471;&#12519;&#12531;)</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">rcodetools</span>)
(define-key ruby-mode-map (kbd <span style="font-style: italic;">"C-&lt;return&gt;"</span>) 'xmp)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">activate robe</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">CI&#12391;&#12399;&#23455;&#34892;&#12375;&#12394;&#12356;</span>
(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">progn</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(inf-ruby)</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(robe-start)</span>
    ))
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e147c6" class="outline-2">
<h2 id="org9e147c6"><span class="section-number-2">3.</span> go-mode</h2>
<div class="outline-text-2" id="text-3">
<p>
goの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>基本設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">go-mode</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ob-go</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Go &#12487;&#12496;&#12483;&#12460;&#12540;</span>
(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">dap-mode</span>
  <span style="font-weight: bold;">:after</span> lsp-mode
  <span style="font-weight: bold;">:hook</span>
  (lsp-mode . dap-mode)
  (lsp-mode . dap-ui-mode)
  <span style="font-weight: bold;">:config</span>
  (dap-mode 1)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dap-hydra</span>)
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dap-dlv-go</span>))

(<span style="font-weight: bold;">setq</span> dap-print-io t)
(<span style="font-weight: bold;">setq</span> lsp-gopls-server-path <span style="font-style: italic;">"~/go/bin/gopls"</span>)
(<span style="font-weight: bold;">setq</span> dap-dlv-go-delve-path <span style="font-style: italic;">"~/go/bin/dlv"</span>)

(<span style="font-weight: bold;">setq</span> dap-print-io t)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">go-eldoc</span>)
(add-hook 'go-mode-hook 'go-eldoc-setup)

(<span style="font-weight: bold;">setq</span> gofmt-command <span style="font-style: italic;">"goimports"</span>)
(add-hook 'before-save-hook 'gofmt-before-save)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgced963b" class="outline-2">
<h2 id="orgced963b"><span class="section-number-2">4.</span> python-mode</h2>
<div class="outline-text-2" id="text-4">
<p>
pythonの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>基本設定</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-hook 'python-mode-hook 'jedi:setup)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq jedi:complete-on-dot t)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(jedi:setup)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">;; (define-key jedi-mode-map (kbd "&lt;C-tab&gt;") nil) ;;C-tab&#12399;&#12454;&#12451;&#12531;&#12489;&#12454;&#12398;&#31227;&#21205;&#12395;&#29992;&#12356;&#12427;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq jedi:complete-on-dot t)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq ac-sources</span>
<span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(delete 'ac-source-words-in-same-mode-buffers ac-sources)) ;;jedi&#12398;&#35036;&#23436;&#20505;&#35036;&#12384;&#12369;&#12391;&#12356;&#12356;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-to-list 'ac-sources 'ac-source-filename)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-to-list 'ac-sources 'ac-source-jedi-direct)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf78932d" class="outline-2">
<h2 id="orgf78932d"><span class="section-number-2">5.</span> haskell-mode</h2>
<div class="outline-text-2" id="text-5">
<p>
haskellの設定。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>基本設定</label><pre class="src src-emacs-lisp">(add-hook 'haskell-mode-hook 'turn-on-haskell-doc-mode)
(add-hook 'haskell-mode-hook 'turn-on-haskell-indent)

(custom-set-variables
 '(haskell-indent-after-keywords (<span style="font-weight: bold;">quote</span> ((<span style="font-style: italic;">"where"</span> 4 0) (<span style="font-style: italic;">"of"</span> 4) (<span style="font-style: italic;">"do"</span> 4) (<span style="font-style: italic;">"mdo"</span> 4) (<span style="font-style: italic;">"rec"</span> 4) (<span style="font-style: italic;">"in"</span> 4 0) (<span style="font-style: italic;">"{"</span> 4) <span style="font-style: italic;">"if"</span> <span style="font-style: italic;">"then"</span> <span style="font-style: italic;">"else"</span> <span style="font-style: italic;">"let"</span>)))
 '(haskell-indent-offset 4)
 '(haskell-indent-spaces 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc194dae" class="outline-2">
<h2 id="orgc194dae"><span class="section-number-2">6.</span> web-mode</h2>
<div class="outline-text-2" id="text-6">
<p>
web-modeはhtmlライクな複数の言語に対応するモード。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">web-mode</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">web-mode</span>)
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.js[x]?$"</span> . web-mode))<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">js + jsx</span>
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.tsx$"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.phtml\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.php\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.[gj]sp\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.as[cp]x\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.erb\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.mustache\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.djhtml\\'"</span> . web-mode))
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.html\\'"</span> . web-mode))
(<span style="font-weight: bold;">setq</span> web-mode-engines-alist
      '((<span style="font-style: italic;">"php"</span>    . <span style="font-style: italic;">"\\.phtml\\'"</span>)
        (<span style="font-style: italic;">"blade"</span>  . <span style="font-style: italic;">"\\.blade\\."</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">JS+JSX&#35373;&#23450; ================</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12467;&#12513;&#12531;&#12488;&#12450;&#12454;&#12488;&#12398;&#35373;&#23450;</span>
(add-hook 'web-mode-hook
          '(lambda ()
             (add-to-list 'web-mode-comment-formats '(<span style="font-style: italic;">"jsx"</span> . <span style="font-style: italic;">"//"</span> ))))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">.js &#12391;&#12418; JSX &#32232;&#38598;&#12514;&#12540;&#12489;&#12395;</span>
(<span style="font-weight: bold;">setq</span> web-mode-content-types-alist
      '((<span style="font-style: italic;">"jsx"</span> . <span style="font-style: italic;">"\\.js[x]?\\'"</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">JS&#12471;&#12531;&#12479;&#12483;&#12463;&#12473;&#12481;&#12455;&#12483;&#12463; ================</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">ESlint</span>
(eval-after-load 'flycheck
  '(custom-set-variables
    '(flycheck-disabled-checkers '(javascript-jshint javascript-jscs))
    ))
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">eslint &#29992;&#12398; linter &#12434;&#30331;&#37682;</span>
(flycheck-add-mode 'javascript-eslint 'web-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#20316;&#26989;&#12375;&#12390;&#12356;&#12427; project &#12398; node-module &#12434;&#12415;&#12390;&#12289;&#36969;&#20999;&#12395;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">linter &#12398;&#35373;&#23450;&#12434;&#35501;&#12415;&#36796;&#12416;</span>
(eval-after-load 'web-mode
  '(progn
     (add-hook 'web-mode-hook #'add-node-modules-path)
     (add-hook 'web-mode-hook #'prettier-js-mode)))
(eval-after-load 'web-mode
  '(add-hook 'rjsx-mode-hook #'add-node-modules-path))
(add-hook 'web-mode-hook 'flycheck-mode)
(add-hook 'rjsx-mode-hook 'flycheck-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;: M-x eslint-fix-file</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eslint-fix-file</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (call-process-shell-command
   (mapconcat 'shell-quote-argument
              (list <span style="font-style: italic;">"eslint"</span> <span style="font-style: italic;">"--fix"</span> (buffer-file-name)) <span style="font-style: italic;">" "</span>) <span style="font-weight: bold;">nil 0))</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;&#24460;&#12289;buffer &#12434; revert &#12377;&#12427;</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#23455;&#34892;: M-x eslint-fix-file-and-revert</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eslint-fix-file-and-revert</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (eslint-fix-file)
  (revert-buffer t t))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12452;&#12531;&#12487;&#12531;&#12488;&#31561;&#35519;&#25972; ================</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-web-mode-hook</span> ()
  <span style="font-style: italic;">"Hooks for Web mode."</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-attr-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-markup-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-css-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-code-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq web-mode-sql-indent-offset 0)</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq sql-indent-offset 0)</span>
  (<span style="font-weight: bold;">setq</span> indent-tabs-mode nil)
  (<span style="font-weight: bold;">setq</span> tab-width 2)
  (<span style="font-weight: bold;">setq</span> json-reformat:indent-width 2)

  (<span style="font-weight: bold;">setq</span> web-mode-attr-indent-offset nil)
  (<span style="font-weight: bold;">setq</span> web-mode-enable-auto-closing t)
  (<span style="font-weight: bold;">setq</span> web-mode-enable-auto-pairing t)
  (<span style="font-weight: bold;">setq</span> web-mode-auto-close-style 2)
  (<span style="font-weight: bold;">setq</span> web-mode-tag-auto-close-style 2))
(add-hook 'web-mode-hook 'my-web-mode-hook)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">CSS ================</span>
(<span style="font-weight: bold;">setq</span> css-indent-offset 2)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">SQL ================</span>
(add-hook 'ejc-sql-minor-mode-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (ejc-eldoc-setup)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12467;&#12510;&#12531;&#12489;&#12434;&#22823;&#25991;&#23383;&#12395;&#12377;&#12427;</span>
(add-hook 'sql-mode-hook 'sqlup-mode)
(add-hook 'sql-interactive-mode-hook 'sqlup-mode)
(global-set-key (kbd <span style="font-style: italic;">"C-c u"</span>) 'sqlup-capitalize-keywords-in-region)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32080;&#26524;&#12434;&#25240;&#12426;&#36820;&#12373;&#12394;&#12356;&#12424;&#12358;&#12395;&#12377;&#12427;</span>
(add-hook 'sql-interactive-mode-hook
          '(lambda()
             (<span style="font-weight: bold;">setq</span> truncate-lines nil
                   truncate-partial-width-windows t)))

(<span style="font-weight: bold;">setq</span> erc-server <span style="font-style: italic;">"irc.libera.chat"</span>
      erc-nick <span style="font-style: italic;">"kijimad"</span>
      erc-user-full-name <span style="font-style: italic;">"Kijima Daigo"</span>
      erc-track-shorten-start 8
      erc-autojoin-channels-alist '((<span style="font-style: italic;">"irc-libera.chat"</span> <span style="font-style: italic;">"#systemcrafters"</span> <span style="font-style: italic;">"#emacs"</span>))
      erc-kill-buffer-on-part t
      erc-auto-query 'bufy)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Typescript ================</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">typescript-mode</span>)
(add-to-list 'auto-mode-alist '(<span style="font-style: italic;">"\\.ts\\'"</span> . typescript-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org53b50af" class="outline-2">
<h2 id="org53b50af"><span class="section-number-2">7.</span> LSP</h2>
<div class="outline-text-2" id="text-7">
<p>
lsp-modeはLSPを使えるようにするパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>metalがインストールできないので確認を無効化する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> lsp-verify-signature nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>言語共通設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">flycheck</span>
  <span style="font-weight: bold;">:init</span> (global-flycheck-mode))

(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">lsp-mode</span>
  <span style="font-weight: bold;">:custom</span>
  (lsp-completion-provider <span style="font-weight: bold;">:none</span>)
  (lsp-prefer-flymake nil)
  (lsp-print-io nil)
  (lsp-trace nil)
  (lsp-print-performance nil)
  (lsp-auto-guess-root t)
  (lsp-document-sync-method 'incremental)
  (lsp-response-timeout 5)
  <span style="font-weight: bold;">:init</span>
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my/lsp-mode-setup-completion</span> ()
    (<span style="font-weight: bold;">setf</span> (alist-get 'styles (alist-get 'lsp-capf completion-category-defaults))
          '(orderless))) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Configure orderless</span>
  <span style="font-weight: bold;">:hook</span>
  (scala-mode . lsp)
  (clojure-mode . lsp)
  (c-mode . lsp)
  (c++-mode . lsp)
  (rust-mode . lsp)
  (go-mode . lsp)
  (lsp-mode . lsp-lens-mode)
  (lsp-mode . lsp-completion-mode)
  (lsp-mode . lsp-ui-mode)
  (lsp-completion-mode . my/lsp-mode-setup-completion)
  <span style="font-weight: bold;">:config</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Uncomment following section if you would like to tune lsp-mode performance according to</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">https://emacs-lsp.github.io/lsp-mode/page/performance/</span>
  <span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq gc-cons-threshold 100000000) ;; 100mb</span>
  <span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq read-process-output-max (* 1024 1024)) ;; 1mb</span>
  <span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq lsp-idle-delay 0.500)</span>
  <span style="font-weight: bold; font-style: italic;">;;       </span><span style="font-weight: bold; font-style: italic;">(setq lsp-log-io nil)</span>
  )
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>scala用を設定する</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package scala-mode</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:interpreter</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">("scala" . scala-mode))</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">;; Enable sbt mode for executing sbt commands</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package sbt-mode</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:commands sbt-start sbt-command</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:config</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; WORKAROUND: https://github.com/ensime/emacs-sbt-mode/issues/31</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; allows using SPACE when in the minibuffer</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">(substitute-key-definition</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">'minibuffer-complete-word</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">'self-insert-command</span>
<span style="font-weight: bold; font-style: italic;">;;    </span><span style="font-weight: bold; font-style: italic;">minibuffer-local-completion-map)</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; sbt-supershell kills sbt-mode:  https://github.com/hvesalai/emacs-sbt-mode/issues/152</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">(setq sbt:program-options '("-Dsbt.supershell=false"))</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">)</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package lsp-metals</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:ensure t</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:custom</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; Metals claims to support range formatting by default but it supports range</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; formatting of multiline strings only. You might want to disable it so that</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">;; emacs can use indentation provided by scala-mode.</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">(lsp-metals-server-args '("-J-Dmetals.allow-multiline-string-formatting=off"))</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:hook (scala-mode . lsp))</span>
</pre>
</div>

<p>
使ってない。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ドキュメントをホバー表示できるようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">lsp-ui</span>
  <span style="font-weight: bold;">:custom</span>
  (lsp-ui-doc-enable t)
  (lsp-ui-doc-header t)
  (lsp-ui-doc-include-signature t)
  (lsp-ui-doc-max-width 150)
  (lsp-ui-doc-max-height 30)
  (lsp-ui-peek-enable t))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>snippetを挿入する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">yasnippet</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>DAPデバッガーを使えるようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">posframe</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Posframe is a pop-up tool that must be manually installed for dap-mode</span>
  )

(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">dap-ui</span>
  <span style="font-weight: bold;">:config</span>
  (dap-ui-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3696332" class="outline-2">
<h2 id="org3696332"><span class="section-number-2">8.</span> corfu</h2>
<div class="outline-text-2" id="text-8">
<p>
corfuはシンプルな補完を提供するパッケージ。
</p>

<ul class="org-ul">
<li><a href="https://tam5917.hatenablog.com/entry/2022/02/05/141115">corfuまわりの設定（vertico, marginalia, orderless, cape, kind-icon, affe） - 備忘録</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">corfu</span>)
(global-corfu-mode)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>基本設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> corfu-auto t)
(<span style="font-weight: bold;">setq</span> corfu-auto-prefix 3)
(<span style="font-weight: bold;">setq</span> corfu-count 15)
(<span style="font-weight: bold;">setq</span> corfu-cycle t)
(<span style="font-weight: bold;">setq</span> corfu-preselect-first t) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#33258;&#21205;&#30340;&#12395;&#26368;&#21021;&#12398;&#20505;&#35036;&#12434;&#36984;&#25246;&#12377;&#12427;</span>
(<span style="font-weight: bold;">setq</span> corfu-quit-at-boundary t) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#12473;&#12506;&#12540;&#12473;&#12434;&#20837;&#12428;&#12427;&#12392;quit</span>
(<span style="font-weight: bold;">setq</span> corfu-quit-no-match t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>候補選択を循環させる</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> completion-cycle-threshold 3)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">corfu-beginning-of-prompt</span> ()
  <span style="font-style: italic;">"Move to beginning of completion input."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (corfu--goto -1)
  (goto-char (car completion-in-region--data)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">corfu-end-of-prompt</span> ()
  <span style="font-style: italic;">"Move to end of completion input."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (corfu--goto -1)
  (goto-char (cadr completion-in-region--data)))

(define-key corfu-map [remap move-beginning-of-line] #'corfu-beginning-of-prompt)
(define-key corfu-map [remap move-end-of-line] #'corfu-end-of-prompt)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>その他の連携パッケージ</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vertico</span>)
(vertico-mode)
(<span style="font-weight: bold;">setq</span> vertico-count 20)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vertico-directory</span>)
(define-key vertico-map (kbd <span style="font-style: italic;">"C-l"</span>) #'vertico-directory-up)
(define-key vertico-map <span style="font-style: italic;">"\r"</span> #'vertico-directory-enter)  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">enter dired</span>
(define-key vertico-map <span style="font-style: italic;">"\d"</span> #'vertico-directory-delete-char)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">marginalia</span>)
(marginalia-mode +1)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">marginalia-annotators&#12434;&#12469;&#12452;&#12463;&#12523;&#12377;&#12427;</span>
(define-key minibuffer-local-map (kbd <span style="font-style: italic;">"C-M-a"</span>) #'marginalia-cycle)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">orderless</span>)
(<span style="font-weight: bold;">setq</span> completion-styles '(orderless partial-completion))
(<span style="font-weight: bold;">setq</span> completion-category-defaults nil)
(<span style="font-weight: bold;">setq</span> completion-category-overrides nil)

(orderless-define-completion-style orderless+initialism
  (orderless-matching-styles '(orderless-initialism <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">&#19968;&#30058;&#26368;&#21021;&#12395;initializm</span>
                               orderless-literal  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">&#27425;&#12395;&#12522;&#12486;&#12521;&#12523;&#12510;&#12483;&#12481;</span>
                               orderless-regexp)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq completion-category-defaults nil)</span>
(<span style="font-weight: bold;">setq</span> completion-category-overrides
      '((eglot (styles orderless+initialism))
        (command (styles orderless+initialism))
        (symbol (styles orderless+initialism))
        (variable (styles orderless+initialism))))
(<span style="font-weight: bold;">setq</span> orderless-component-separator #'orderless-escapable-split-on-space)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">cape</span>)
(add-to-list 'completion-at-point-functions #'cape-file)
(add-to-list 'completion-at-point-functions #'cape-tex)
(add-to-list 'completion-at-point-functions #'cape-dabbrev)
(add-to-list 'completion-at-point-functions #'cape-keyword)
(add-to-list 'completion-at-point-functions #'cape-abbrev)
(add-to-list 'completion-at-point-functions #'cape-ispell)
(add-to-list 'completion-at-point-functions #'cape-symbol)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Emacs&#12398;SVG&#23550;&#24540;&#12467;&#12531;&#12497;&#12452;&#12523;&#12364;&#24517;&#35201;</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">kind-icon</span>)
(<span style="font-weight: bold;">setq</span> kind-icon-default-face 'corfu-default)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">If 4k, big size icon displayed.</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(add-to-list 'corfu-margin-formatters #'kind-icon-margin-formatter)</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(pop corfu-margin-formatters)</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Available commands</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">affe-grep: Filters the content of all text files in the current directory</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">affe-find: Filters the file paths of all files in the current directory</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">affe</span>)
(consult-customize affe-grep <span style="font-weight: bold;">:preview-key</span> (kbd <span style="font-style: italic;">"M-."</span>))
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">affe-orderless-regexp</span> <span style="font-style: italic;">""</span>)
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">affe-orderless-regexp-compiler</span> (input _type)
  (<span style="font-weight: bold;">setq</span> affe-orderless-regexp (orderless-pattern-compiler input))
  (cons affe-orderless-regexp
        (<span style="font-weight: bold;">lambda</span> (str) (orderless--highlight affe-orderless-regexp str))))
(<span style="font-weight: bold;">setq</span> affe-regexp-compiler #'affe-orderless-regexp-compiler)

(<span style="font-weight: bold;">use-package</span> <span style="font-weight: bold; text-decoration: underline;">corfu-doc</span>
  <span style="font-weight: bold;">:hook</span> (corfu-mode . corfu-doc-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org118a846" class="outline-2">
<h2 id="org118a846"><span class="section-number-2">9.</span> ivy</h2>
<div class="outline-text-2" id="text-9">
<p>
ivyはさまざまなインクリメンタル検索を追加するパッケージ。
</p>

<ul class="org-ul">
<li>参考設定
<ul class="org-ul">
<li><a href="https://qiita.com/takaxp/items/2fde2c119e419713342b">https://qiita.com/takaxp/items/2fde2c119e419713342b</a></li>
</ul></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>M-o をivy-hydra-read-action に割り当てる</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">ivy-hydra</span> nil t)
  (<span style="font-weight: bold;">setq</span> ivy-read-action-function #'ivy-hydra-read-action))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Magitとの連携</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> magit-completing-read-function 'ivy-completing-read)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ミニバッファでコマンド発行を認める。何階層入ったかプロンプトに表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">setq</span> enable-recursive-minibuffers t)
  (minibuffer-depth-indicate-mode 1))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ESC連打でミニバッファを閉じる</label><pre class="src src-emacs-lisp">(define-key ivy-minibuffer-map (kbd <span style="font-style: italic;">"&lt;escape&gt;"</span>) 'minibuffer-keyboard-quit)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>プロンプトの表示が長い時に折り返す（選択候補も折り返される）</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ivy-truncate-lines nil)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>リスト先頭で `C-p' するとき，リストの最後に移動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ivy-wrap t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>表示設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ivy-count-format <span style="font-style: italic;">"%d -&gt; %d "</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>新規作成プロンプトを表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> ivy-use-selectable-prompt t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>counsel-mark-ring のリストをソートさせない</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> <span style="font-style: italic;">"ivy"</span>
  (<span style="font-weight: bold;">setf</span> (alist-get 'counsel-mark-ring ivy-sort-functions-alist) nil))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>外観設定する</label><pre class="src src-emacs-lisp">(all-the-icons-ivy-rich-mode 1)
(ivy-rich-mode 1)

(custom-set-faces
 '(ivy-current-match
   ((((class color) (background light))
     <span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"#FFF3F3"</span> <span style="font-weight: bold;">:distant-foreground</span> <span style="font-style: italic;">"#000000"</span>)
    (((class color) (background dark))
     <span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"#404040"</span> <span style="font-weight: bold;">:distant-foreground</span> <span style="font-style: italic;">"#abb2bf"</span>)))
 '(ivy-minibuffer-match-face-1
   ((((class color) (background light)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#666666"</span>)
    (((class color) (background dark)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#999999"</span>)))
 '(ivy-minibuffer-match-face-2
   ((((class color) (background light)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#c03333"</span> <span style="font-weight: bold;">:underline</span> t)
    (((class color) (background dark)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#e04444"</span> <span style="font-weight: bold;">:underline</span> t)))
 '(ivy-minibuffer-match-face-3
   ((((class color) (background light)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#8585ff"</span> <span style="font-weight: bold;">:underline</span> t)
    (((class color) (background dark)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#7777ff"</span> <span style="font-weight: bold;">:underline</span> t)))
 '(ivy-minibuffer-match-face-4
   ((((class color) (background light)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#439943"</span> <span style="font-weight: bold;">:underline</span> t)
    (((class color) (background dark)) <span style="font-weight: bold;">:foreground</span> <span style="font-style: italic;">"#33bb33"</span> <span style="font-weight: bold;">:underline</span> t))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>履歴表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">smex</span> nil t)
  (<span style="font-weight: bold;">setq</span> smex-history-length 35)
  (<span style="font-weight: bold;">setq</span> smex-completion-method 'ivy))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>有効化</label><pre class="src src-emacs-lisp">(ivy-mode 1)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgadec970" class="outline-2">
<h2 id="orgadec970"><span class="section-number-2">10.</span> counsel</h2>
<div class="outline-text-2" id="text-10">
<p>
counselはさまざまなインクリメンタル検索を可能にするパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>キーバインド</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-x C-b"</span>) 'counsel-switch-buffer)
(global-set-key (kbd <span style="font-style: italic;">"C-x C-f"</span>) 'counsel-find-file)
(global-set-key (kbd <span style="font-style: italic;">"C-x C-u"</span>) 'ivy-resume)
(global-set-key (kbd <span style="font-style: italic;">"C-x C-g"</span>) 'counsel-git-grep)
(global-set-key (kbd <span style="font-style: italic;">"C-x r i"</span>) 'counsel-register)
(global-set-key (kbd <span style="font-style: italic;">"M-y"</span>) 'counsel-yank-pop)
(global-set-key (kbd <span style="font-style: italic;">"M-i"</span>) 'swiper-thing-at-point)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>検索エンジンをGoogleに設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> counsel-search-engine 'google)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>有効化</label><pre class="src src-emacs-lisp">(counsel-mode 1)
</pre>
</div>
</div>
</div>
<div id="outline-container-org912ba55" class="outline-2">
<h2 id="org912ba55"><span class="section-number-2">11.</span> ag</h2>
<div class="outline-text-2" id="text-11">
<p>
agはgrepより高速な検索ツール。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>agのデフォルト入力値をthing-at-pointにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">ad:counsel-ag</span> (f <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> initial-input initial-directory extra-ag-args ag-prompt caller)
  (apply f (<span style="font-weight: bold;">or</span> initial-input (ivy-thing-at-point))
         (<span style="font-weight: bold;">unless</span> current-prefix-arg
           (<span style="font-weight: bold;">or</span> initial-directory default-directory))
         extra-ag-args ag-prompt caller))

(advice-add 'counsel-ag <span style="font-weight: bold;">:around</span> #'ad:counsel-ag)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc0ea29d" class="outline-2">
<h2 id="orgc0ea29d"><span class="section-number-2">12.</span> eldoc</h2>
<div class="outline-text-2" id="text-12">
<p>
eldocは関数ドキュメントを表示するパッケージ。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>eldocをミニバッファに表示する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> <span style="font-style: italic;">"eldoc"</span>
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">ad:eldoc-message</span> (f <span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> string)
    (<span style="font-weight: bold;">unless</span> (active-minibuffer-window)
      (funcall f string)))
  (advice-add 'eldoc-message <span style="font-weight: bold;">:around</span> #'ad:eldoc-message))
</pre>
</div>
</div>
</div>
<div id="outline-container-org09f6a7a" class="outline-2">
<h2 id="org09f6a7a"><span class="section-number-2">13.</span> eshell</h2>
<div class="outline-text-2" id="text-13">
<p>
eshellはEmacs Lispで実装されたシェル。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>eshellの設定を追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">efs/configure-eshell</span> ()
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Save command history when commands are entered</span>
  (add-hook 'eshell-pre-command-hook 'eshell-save-some-history)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Truncate buffer for performance</span>
  (add-to-list 'eshell-output-filter-functions 'eshell-truncate-buffer)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Bind some useful keys for evil-mode</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(define-key eshell-mode-map (kbd "M-r") 'helm-eshell-history)</span>
  (<span style="font-weight: bold;">setq</span> eshell-history-size         10000
        eshell-buffer-maximum-lines 10000
        eshell-hist-ignoredups t
        eshell-scroll-to-bottom-on-input t
        eshell-git-prompt-use-theme 'multiline
        eshell-toggle-height-fraction 2
        eshell-toggle-use-projectile-root t))
(add-hook 'eshell-first-time-mode-hook 'efs/configure-eshell)
</pre>
</div>

<ul class="org-ul">
<li>ベース設定は <a href="https://github.com/daviwil/emacs-from-scratch/blob/master/show-notes/Emacs-09.org">https://github.com/daviwil/emacs-from-scratch/blob/master/show-notes/Emacs-09.org</a> から取ってきた</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>キーバインドを設定する</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-M-;"</span>) 'eshell-toggle)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>eshellのサジェストを設定する</label><pre class="src src-emacs-lisp">(add-hook 'eshell-first-time-mode-hook 'esh-autosuggest-mode)
(<span style="font-weight: bold;">setq</span> esh-autosuggest-delay 0.5)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee33673" class="outline-2">
<h2 id="orgee33673"><span class="section-number-2">14.</span> Vterm</h2>
<div class="outline-text-2" id="text-14">
<p>
vtermはCで実装されたシェル。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>各種設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">vterm</span>)
  (<span style="font-weight: bold;">setq</span> term-prompt-regexp <span style="font-style: italic;">"^[</span><span style="font-style: italic;">^</span><span style="font-style: italic;">#$%&gt;\n]*[#$%&gt;] *"</span>)
  (<span style="font-weight: bold;">setq</span> vterm-toggle-scope 'project)
  (<span style="font-weight: bold;">setq</span> vterm-toggle-project-root t)
  (<span style="font-weight: bold;">setq</span> vterm-max-scrollback 10000)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">toggle</span>
  (global-set-key [f9] 'vterm-toggle)
  (global-set-key (kbd <span style="font-style: italic;">"C-M-:"</span>) 'vterm-toggle)
  (global-set-key [C-f9] 'vterm-toggle-cd)

  (<span style="font-weight: bold;">setq</span> vterm-toggle-fullscreen-p nil)
  (add-to-list 'display-buffer-alist
               '((<span style="font-weight: bold;">lambda</span>(bufname _) (<span style="font-weight: bold;">with-current-buffer</span> bufname
                                      (<span style="font-weight: bold;">or</span> (equal major-mode 'vterm-mode)
                                          (string-prefix-p vterm-buffer-name bufname))))
                 (display-buffer-reuse-window display-buffer-at-bottom)
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(display-buffer-reuse-window display-buffer-in-direction)</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">display-buffer-in-direction/direction/dedicated is added in emacs27</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(direction . bottom)</span>
                 <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(dedicated . t) ;dedicated is supported in emacs27</span>
                 (reusable-frames . visible)
                 (window-height . 0.3))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org8f23871" class="outline-2">
<h2 id="org8f23871"><span class="section-number-2">15.</span> Theme</h2>
<div class="outline-text-2" id="text-15">
<p>
いい感じのテーマを設定する。割と白いテーマと黒いテーマを切り替えるのですぐ切り替えられるようにする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>doom themeを読み込み</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">doom-themes</span>)
(doom-themes-org-config)
(<span style="font-weight: bold;">setq</span> custom-safe-themes t)
(<span style="font-weight: bold;">setq-default</span> custom-enabled-themes '(modus-operandi))
</pre>
</div>

<p>
doom themeはモダンなテーマ集。
</p>

<ul class="org-ul">
<li>ダーク系
<ul class="org-ul">
<li>doom-vibrant</li>
<li>spacemacs-dark</li>
<li>doom-dracula</li>
<li>modus-vivendi</li>
<li>leuven-dark</li>
</ul></li>
<li>ライト系
<ul class="org-ul">
<li>leuven</li>
<li>doom-acario-light</li>
<li>doom-homage-white</li>
<li>modus-operandi</li>
</ul></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>再適用する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">reapply-themes</span> ()
  <span style="font-style: italic;">"Forcibly load the themes listed in `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">custom-enabled-themes</span><span style="font-style: italic;">'."</span>
  (<span style="font-weight: bold;">dolist</span> (theme custom-enabled-themes)
    (<span style="font-weight: bold;">unless</span> (custom-theme-p theme)
      (load-theme theme)))
  (custom-set-variables `(custom-enabled-themes (<span style="font-weight: bold;">quote</span> ,custom-enabled-themes)))
  (efs/org-font-setup)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(kd/set-modus-face)</span>
  )

(add-hook 'after-init-hook 'reapply-themes)
</pre>
</div>

<p>
テーマ適用を最後に実行しないと、設定が上書きされることがあるため。
</p>
<ul class="org-ul">
<li><a href="https://github.com/purcell/emacs.d">https://github.com/purcell/emacs.d</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>モードライン設定</label><pre class="src src-emacs-lisp">(doom-modeline-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#34920;&#31034;&#38917;&#30446;&#12398;&#35373;&#23450;</span>
(<span style="font-weight: bold;">setq</span> doom-modeline-buffer-file-name-style 'truncate-with-project)
(<span style="font-weight: bold;">setq</span> doom-modeline-icon t)
(<span style="font-weight: bold;">setq</span> doom-modeline-major-mode-icon t)
(<span style="font-weight: bold;">setq</span> doom-modeline-minor-modes nil)
(<span style="font-weight: bold;">setq</span> doom-modeline-buffer-encoding nil)
(line-number-mode)
(column-number-mode)
(doom-modeline-def-modeline
  'my-simple-line
  '(bar matches buffer-info remote-host input-method major-mode process buffer-position)
  '(misc-info vcs checker))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">&#32294;&#35519;&#25972;</span>
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-doom-modeline--font-height</span> ()
  (- (frame-char-height) 20))
(advice-add #'doom-modeline--font-height <span style="font-weight: bold;">:override</span> #'my-doom-modeline--font-height)
(<span style="font-weight: bold;">setq</span> doom-modeline-height 20)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">setup-custom-doom-modeline</span> ()
  (doom-modeline-set-modeline 'my-simple-line 'default))
(add-hook 'doom-modeline-mode-hook 'setup-custom-doom-modeline)

(setup-custom-doom-modeline)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>modus themeのカスタマイズ設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-modus-face</span> ()
  (<span style="font-weight: bold;">setq</span> modus-themes-slanted-constructs t
        modus-themes-bold-constructs t
        modus-themes-no-mixed-fonts t
        modus-themes-subtle-line-numbers t
        modus-themes-mode-line '(moody borderless)
        modus-themes-syntax 'faint
        modus-themes-paren-match 'intense-bold
        modus-themes-region 'bg-only
        modus-themes-diffs 'deuteranopia
        modus-themes-org-blocks 'gray-background
        modus-themes-variable-pitch-ui t
        modus-themes-variable-pitch-headings t
        modus-themes-scale-headings t
        modus-themes-scale-1 1.1
        modus-themes-scale-2 1.15
        modus-themes-scale-3 1.21
        modus-themes-scale-4 1.27
        modus-themes-scale-title 1.33)

  (set-face-foreground 'vertical-border <span style="font-style: italic;">"gray"</span>)

  (set-face-attribute 'mode-line nil
                      <span style="font-weight: bold;">:background</span> nil
                      <span style="font-weight: bold;">:overline</span> <span style="font-style: italic;">"black"</span>
                      <span style="font-weight: bold;">:underline</span> nil
                      <span style="font-weight: bold;">:box</span> nil)

  (set-face-attribute 'mode-line-inactive nil
                      <span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"white"</span>
                      <span style="font-weight: bold;">:overline</span> <span style="font-style: italic;">"gray"</span>
                      <span style="font-weight: bold;">:underline</span> nil
                      <span style="font-weight: bold;">:box</span> nil)

  (window-divider-mode 0))

(kd/set-modus-face)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>モードラインからマイナーモードを消す</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> my-hidden-minor-modes
      '(
        abbrev-mode
        auto-highlight-symbol-mode
        auto-revert-mode
        back-button-mode
        beacon-mode
        command-log-mode
        ctags-auto-update-mode
        eldoc-mode
        flyspell-mode
        global-whitespace-mode
        google-this-mode
        highlight-indent-guides-mode
        magit-auto-revert-mode
        projectile-mode
        projectile-rails-mode
        rinari-minor-mode
        robe-mode
        rubocop-mode
        ruby-electric-mode
        undo-tree-mode
        which-key-mode
        yas-minor-mode
        ))
(mapc (<span style="font-weight: bold;">lambda</span> (mode)
        (<span style="font-weight: bold;">setq</span> minor-mode-alist
              (cons (list mode <span style="font-style: italic;">""</span>) (assq-delete-all mode minor-mode-alist))))
      my-hidden-minor-modes)
</pre>
</div>

<p>
describe-minor-mode-from-indicator で調べられる。
</p>
</div>
</div>

<div id="outline-container-org38aa6ec" class="outline-2">
<h2 id="org38aa6ec"><span class="section-number-2">16.</span> EXWM</h2>
<div class="outline-text-2" id="text-16">
<p>
EXWMはEmacs上で動くウィンドウマネージャ。
</p>
<ul class="org-ul">
<li><a href="https://github.com/daviwil/emacs-from-scratch/blob/39f63fe133cd4c41e13bbd1551c6517162851411/show-notes/Emacs-Desktop-03.org">https://github.com/daviwil/emacs-from-scratch/blob/39f63fe133cd4c41e13bbd1551c6517162851411/show-notes/Emacs-Desktop-03.org</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>require</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">exwm</span>)
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">exwm-config</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ほかのウィンドウマネージャを置き換えて起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> exwm-replace t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ほかのワークスペースのバッファに移動できるようにする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> exwm-layout-show-all-buffers t)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>マウス設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">setq</span> mouse-autoselect-window nil
        focus-follows-mouse t
        exwm-workspace-warp-cursor t
        exwm-workspace-number 5)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ワークスペースのバッファに名前をつける</label><pre class="src src-emacs-lisp">(add-hook 'exwm-update-class-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (exwm-workspace-rename-buffer exwm-class-name)))
(add-hook 'exwm-update-title-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (<span style="font-weight: bold;">pcase</span> exwm-class-name
              (<span style="font-style: italic;">"qutebrowser"</span> (exwm-workspace-rename-buffer (format <span style="font-style: italic;">"Qutebrowser: %s"</span> exwm-title)))
              (<span style="font-style: italic;">"chrome"</span> (exwm-workspace-rename-buffer (format <span style="font-style: italic;">"Chrome: %s"</span> exwm-title))))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ウィンドウのセットを起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-init</span> ()
  <span style="font-style: italic;">"Window Manager&#38306;&#20418;&#12398;&#21508;&#31278;&#12503;&#12525;&#12464;&#12521;&#12512;&#12434;&#36215;&#21205;&#12377;&#12427;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">progn</span>
    (call-process-shell-command <span style="font-style: italic;">"shepherd"</span>)
    (call-process-shell-command <span style="font-style: italic;">"~/dotfiles/.config/polybar/launch.sh"</span>)
    (call-process-shell-command <span style="font-style: italic;">"blueberry"</span>)

    (exwm-workspace-switch-create 2)
    (start-process-shell-command <span style="font-style: italic;">"google-chrome"</span> nil <span style="font-style: italic;">"google-chrome"</span>)
    (start-process-shell-command <span style="font-style: italic;">"firefox"</span> nil <span style="font-style: italic;">"firefox"</span>)
    (start-process-shell-command <span style="font-style: italic;">"spotify"</span> nil <span style="font-style: italic;">"spotify"</span>)

    (message <span style="font-style: italic;">"please wait..."</span>)
    (sleep-for 2)

    (exwm-workspace-switch-create 0)
    (persp-switch <span style="font-style: italic;">"1"</span>)
    (delete-other-windows)
    (org-journal-new-entry nil)
    (vterm-toggle)
    (vterm-toggle)
    (persp-switch <span style="font-style: italic;">"2"</span>)
    (find-file <span style="font-style: italic;">"~/roam"</span>)
    (vterm-toggle)
    (vterm-toggle)
    (org-agenda nil <span style="font-style: italic;">"z"</span>)
    (persp-switch <span style="font-style: italic;">"3"</span>)
    (split-window-right)
    (switch-to-buffer <span style="font-style: italic;">"firefox"</span>)
    (persp-switch <span style="font-style: italic;">"4"</span>)
    (switch-to-buffer <span style="font-style: italic;">"firefox"</span>)
    (vterm-toggle)
    (vterm-toggle)
    (persp-switch <span style="font-style: italic;">"5"</span>)
    (find-file <span style="font-style: italic;">"~/dotfiles"</span>)
    (vterm-toggle)
    (vterm-toggle)
    (magit-status)
    (persp-switch <span style="font-style: italic;">"6"</span>)
    (find-file <span style="font-style: italic;">"~/.emacs.d/conf"</span>)
    (vterm-toggle)
    (vterm-toggle)
    (magit-status)
    (persp-switch <span style="font-style: italic;">"7"</span>)
    (find-file <span style="font-style: italic;">"~/ProjectOrg"</span>)
    (persp-switch <span style="font-style: italic;">"8"</span>)
    (find-file <span style="font-style: italic;">"~/Project"</span>)
    (persp-switch <span style="font-style: italic;">"9"</span>)
    (elfeed)

    (exwm-workspace-switch-create 1)
    (persp-switch <span style="font-style: italic;">"1"</span>)
    (persp-switch <span style="font-style: italic;">"2"</span>)
    (find-file <span style="font-style: italic;">"~/roam"</span>)
    (org-agenda nil <span style="font-style: italic;">"z"</span>)
    (persp-switch <span style="font-style: italic;">"4"</span>)
    (switch-to-buffer <span style="font-style: italic;">"Google-chrome"</span>)
    (persp-switch <span style="font-style: italic;">"8"</span>)
    (find-file <span style="font-style: italic;">"~/Project"</span>)

    (exwm-workspace-switch-create 2)
    (switch-to-buffer <span style="font-style: italic;">"Spotify"</span>)

    (exwm-workspace-switch-create 0)
    (persp-switch <span style="font-style: italic;">"4"</span>)

    (message <span style="font-style: italic;">"settings done!"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>背景を設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/set-background</span> ()
  <span style="font-style: italic;">"&#32972;&#26223;&#12434;&#12475;&#12483;&#12488;&#12377;&#12427;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"compton"</span> nil <span style="font-style: italic;">"compton --config ~/dotfiles/.config/compton/compton.conf"</span>)
  (start-process-shell-command <span style="font-style: italic;">"fehbg"</span> nil <span style="font-style: italic;">"~/dotfiles/.fehbg"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>キーバインド設定</label><pre class="src src-emacs-lisp">(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-:"</span>) 'vterm-toggle)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-&lt;right&gt;"</span>) 'persp-next)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"C-M-&lt;left&gt;"</span>) 'persp-prev)
(define-key exwm-mode-map (kbd <span style="font-style: italic;">"&lt;henkan&gt;"</span>) 'pretty-hydra-henkan/body)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>設定する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">when</span> window-system
  (<span style="font-weight: bold;">progn</span>
    (exwm-config-example)
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(kd/set-init)</span>
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(kd/set-background)</span>
    ))
</pre>
</div>
</div>
</div>
<div id="outline-container-org4e971e2" class="outline-2">
<h2 id="org4e971e2"><span class="section-number-2">17.</span> Polybar</h2>
<div class="outline-text-2" id="text-17">
<p>
polybarは柔軟にカスタマイズできるメニューバーを表示するソフトウェア。polybarとの連携を記載する。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>polybarプロセスを保持する変数</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">kd/polybar-process</span> nil
  <span style="font-style: italic;">"Holds the process of the running Polybar instance, if any"</span>)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>バーを起動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/start-panel</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (kd/kill-panel)
  (<span style="font-weight: bold;">setq</span> kd/polybar-process (start-process-shell-command <span style="font-style: italic;">"polybar"</span> nil <span style="font-style: italic;">"~/dotfiles/.config/polybar/launch.sh"</span>)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>バーを停止する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/kill-panel</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">when</span> kd/polybar-process
    (<span style="font-weight: bold;">ignore-errors</span>
      (kill-process kd/polybar-process)))
  (<span style="font-weight: bold;">setq</span> kd/polybar-process nil))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ワークスペースをpolybarで表示する設定</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/polybar-exwm-workspace</span> ()
  (<span style="font-weight: bold;">pcase</span> exwm-workspace-current-index
    (0 <span style="font-style: italic;">"%{F#797D7F}Work%{F-} Home"</span>)
    (1 <span style="font-style: italic;">"Work %{F#797D7F}Home%{F-}"</span>)
    (2 <span style="font-style: italic;">"&#59540;"</span>)
    (3 <span style="font-style: italic;">"&#59641;"</span>)
    (4 <span style="font-style: italic;">"&#57418;"</span>)
    (9 <span style="font-style: italic;">"&#61820;"</span>)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/send-polybar-exwm-workspace</span> ()
  (kd/send-polybar-hook <span style="font-style: italic;">"exwm-workspace"</span> 1))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/send-polybar-hook</span> (module-name hook-index)
  (start-process-shell-command <span style="font-style: italic;">"polybar-msg"</span> nil (format <span style="font-style: italic;">"polybar-msg hook %s %s"</span> module-name hook-index)))

(add-hook 'exwm-workspace-switch-hook #'kd/send-polybar-exwm-workspace)
</pre>
</div>
</div>
</div>
<div id="outline-container-org41171ef" class="outline-2">
<h2 id="org41171ef"><span class="section-number-2">18.</span> Workspace</h2>
<div class="outline-text-2" id="text-18">
<p>
1~9のワークスペースを作成し、番号で切り替えられるようにする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>モード初期化</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">perspective</span>)
(<span style="font-weight: bold;">setq</span> persp-initial-frame-name <span style="font-style: italic;">"1"</span>)
(<span style="font-weight: bold;">setq</span> persp-modestring-dividers '(<span style="font-style: italic;">""</span> <span style="font-style: italic;">""</span> <span style="font-style: italic;">" "</span>))
(persp-mode 1)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ワークスペースを生成する</label><pre class="src src-emacs-lisp">(mapc (<span style="font-weight: bold;">lambda</span> (i)
        (persp-switch (int-to-string i)))
      (number-sequence 1 9))
(persp-switch <span style="font-style: italic;">"1"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org1a07bf9" class="outline-2">
<h2 id="org1a07bf9"><span class="section-number-2">19.</span> Hydra</h2>
<div class="outline-text-2" id="text-19">
<p>
Hydraはカスタマイズ可能なキー表示を追加するパッケージ。キーバインド空間を制限しつつ、入力のヒントを表示して使いやすくする。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>グローバルに便利なメニューを追加する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> 'pretty-hydra
  (pretty-hydra-define pretty-hydra-henkan (<span style="font-weight: bold;">:color</span> blue <span style="font-weight: bold;">:foreign-keys</span> warn <span style="font-weight: bold;">:title</span> <span style="font-style: italic;">"Convenient Tools"</span>)
    (<span style="font-style: italic;">"Media"</span>
     ((<span style="font-style: italic;">"&lt;prior&gt;"</span> kd/mint-volume-up <span style="font-style: italic;">"up"</span>)
      (<span style="font-style: italic;">"&lt;next&gt;"</span> kd/mint-volume-down <span style="font-style: italic;">"down"</span>)
      (<span style="font-style: italic;">"&lt;pause&gt;"</span> kd/player-stop <span style="font-style: italic;">"stop"</span>))

     <span style="font-style: italic;">"Find"</span>
     ((<span style="font-style: italic;">"a"</span> counsel-apropos <span style="font-style: italic;">"apropos"</span>)
      (<span style="font-style: italic;">"f"</span> counsel-ag <span style="font-style: italic;">"ag"</span>)
      (<span style="font-style: italic;">"h"</span> counsel-find-library <span style="font-style: italic;">"lib"</span>)
      (<span style="font-style: italic;">"i"</span> counsel-imenu <span style="font-style: italic;">"imenu"</span>)
      (<span style="font-style: italic;">"r"</span> counsel-register <span style="font-style: italic;">"register"</span>)
      (<span style="font-style: italic;">"b"</span> counsel-bookmark <span style="font-style: italic;">"bookmark"</span>)
      (<span style="font-style: italic;">"p"</span> persp-ivy-switch-buffer <span style="font-style: italic;">"persp-buffer"</span>)
      (<span style="font-style: italic;">"w"</span> swiper-all-thing-at-point <span style="font-style: italic;">"all"</span>))

     <span style="font-style: italic;">"Execute"</span>
     ((<span style="font-style: italic;">"e"</span> counsel-linux-app <span style="font-style: italic;">"run"</span>)
      (<span style="font-style: italic;">"c"</span> recompile <span style="font-style: italic;">"recompile"</span>)
      (<span style="font-style: italic;">"s"</span> counsel-search <span style="font-style: italic;">"google"</span>))

     <span style="font-style: italic;">"Git"</span>
     ((<span style="font-style: italic;">"g"</span> magit-blame)
      (<span style="font-style: italic;">"&gt;"</span> git-gutter+-next-hunk)
      (<span style="font-style: italic;">"&lt;"</span> git-gutter+-previous-hunk)
      (<span style="font-style: italic;">"@"</span> git-timemachine)
      (<span style="font-style: italic;">"l"</span> git-link))

     <span style="font-style: italic;">"Edit"</span>
     ((<span style="font-style: italic;">"q"</span> query-replace <span style="font-style: italic;">"replace"</span>)
      (<span style="font-style: italic;">"y"</span> ivy-yasnippet <span style="font-style: italic;">"yas"</span>))

     <span style="font-style: italic;">"Window"</span>
     ((<span style="font-style: italic;">"1"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 1))) <span style="font-style: italic;">"Journal"</span>)
      (<span style="font-style: italic;">"2"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 2))) <span style="font-style: italic;">"Roam"</span>)
      (<span style="font-style: italic;">"3"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 3))) <span style="font-style: italic;">"Browser(Half)"</span>)
      (<span style="font-style: italic;">"4"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 4))) <span style="font-style: italic;">"Browser(Full)"</span>)
      (<span style="font-style: italic;">"5"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 5))) <span style="font-style: italic;">"Dotfiles"</span>)
      (<span style="font-style: italic;">"6"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 6))) <span style="font-style: italic;">"Emacs"</span>)
      (<span style="font-style: italic;">"7"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 7))) <span style="font-style: italic;">"Sub"</span>)
      (<span style="font-style: italic;">"8"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 8))) <span style="font-style: italic;">"Main"</span>)
      (<span style="font-style: italic;">"9"</span> (<span style="font-weight: bold;">lambda</span> nil (<span style="font-weight: bold;">interactive</span>) (persp-switch (int-to-string 9))) <span style="font-style: italic;">"Blueberry"</span>))))

  (define-key global-map (kbd <span style="font-style: italic;">"&lt;henkan&gt;"</span>) 'pretty-hydra-henkan/body))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Railsに便利なメニューを定義する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">with-eval-after-load</span> 'pretty-hydra
  (pretty-hydra-define pretty-hydra-projectile-rails-find (<span style="font-weight: bold;">:color</span> blue <span style="font-weight: bold;">:foreign-keys</span> warn <span style="font-weight: bold;">:title</span> <span style="font-style: italic;">"Projectile Rails"</span>)
    (<span style="font-style: italic;">"Current"</span>
     ((<span style="font-style: italic;">"M"</span> projectile-rails-find-current-model      <span style="font-style: italic;">"Current model"</span>)
      (<span style="font-style: italic;">"V"</span> projectile-rails-find-current-view       <span style="font-style: italic;">"Current view"</span>)
      (<span style="font-style: italic;">"C"</span> projectile-rails-find-current-controller <span style="font-style: italic;">"Current controller"</span>)
      (<span style="font-style: italic;">"H"</span> projectile-rails-find-current-helper     <span style="font-style: italic;">"Current helper"</span>)
      (<span style="font-style: italic;">"P"</span> projectile-rails-find-current-spec       <span style="font-style: italic;">"Current spec"</span>)
      (<span style="font-style: italic;">"Z"</span> projectile-rails-find-current-serializer <span style="font-style: italic;">"Current serializer"</span>))

     <span style="font-style: italic;">"App"</span>
     ((<span style="font-style: italic;">"m"</span> projectile-rails-find-model           <span style="font-style: italic;">"Model"</span>)
      (<span style="font-style: italic;">"v"</span> projectile-rails-find-view            <span style="font-style: italic;">"View"</span>)
      (<span style="font-style: italic;">"c"</span> projectile-rails-find-controller      <span style="font-style: italic;">"Controller"</span>)
      (<span style="font-style: italic;">"h"</span> projectile-rails-find-helper          <span style="font-style: italic;">"Helper"</span>)
      (<span style="font-style: italic;">"@"</span> projectile-rails-find-mailer          <span style="font-style: italic;">"Mailer"</span>)
      (<span style="font-style: italic;">"y"</span> projectile-rails-find-layout       <span style="font-style: italic;">"Layout"</span>)
      (<span style="font-style: italic;">"z"</span> projectile-rails-find-serializer      <span style="font-style: italic;">"Serializer"</span>))

     <span style="font-style: italic;">"Assets"</span>
     ((<span style="font-style: italic;">"j"</span> projectile-rails-find-javascript  <span style="font-style: italic;">"Javascript"</span>)
      (<span style="font-style: italic;">"s"</span> projectile-rails-find-stylesheet  <span style="font-style: italic;">"CSS"</span>))

     <span style="font-style: italic;">"Other"</span>
     ((<span style="font-style: italic;">"n"</span> projectile-rails-find-migration    <span style="font-style: italic;">"Migration"</span>)
      (<span style="font-style: italic;">"r"</span> projectile-rails-find-rake-task    <span style="font-style: italic;">"Rake task"</span>)
      (<span style="font-style: italic;">"i"</span> projectile-rails-find-initializer  <span style="font-style: italic;">"Initializer"</span>)
      (<span style="font-style: italic;">"l"</span> projectile-rails-find-lib          <span style="font-style: italic;">"Lib"</span>)
      (<span style="font-style: italic;">"p"</span> projectile-rails-find-spec         <span style="font-style: italic;">"Spec"</span>)
      (<span style="font-style: italic;">"t"</span> projectile-rails-find-locale       <span style="font-style: italic;">"Translation"</span>))

     <span style="font-style: italic;">"Single Files"</span>
     ((<span style="font-style: italic;">"R"</span> projectile-rails-goto-routes   <span style="font-style: italic;">"routes.rb"</span>)
      (<span style="font-style: italic;">"G"</span> projectile-rails-goto-gemfile  <span style="font-style: italic;">"Gemfile"</span>)
      (<span style="font-style: italic;">"D"</span> projectile-rails-goto-schema   <span style="font-style: italic;">"schema.rb"</span>)))))
</pre>
</div>

<ul class="org-ul">
<li><a href="https://mugijiru.github.io/.emacs.d/programming/rails/">https://mugijiru.github.io/.emacs.d/programming/rails/</a></li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>major-mode-hydra</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"M-SPC"</span>) #'major-mode-hydra)

(<span style="font-weight: bold;">with-eval-after-load</span> 'major-mode-hydra
  (major-mode-hydra-define emacs-lisp-mode nil
    (<span style="font-style: italic;">"Eval"</span>
     ((<span style="font-style: italic;">"b"</span> eval-buffer <span style="font-style: italic;">"buffer"</span>)
      (<span style="font-style: italic;">"e"</span> eval-defun <span style="font-style: italic;">"defun"</span>)
      (<span style="font-style: italic;">"r"</span> eval-region <span style="font-style: italic;">"region"</span>))
     <span style="font-style: italic;">"REPL"</span>
     ((<span style="font-style: italic;">"I"</span> ielm <span style="font-style: italic;">"ielm"</span>))
     <span style="font-style: italic;">"Test"</span>
     ((<span style="font-style: italic;">"t"</span> ert <span style="font-style: italic;">"prompt"</span>)
      (<span style="font-style: italic;">"T"</span> (ert t) <span style="font-style: italic;">"all"</span>)
      (<span style="font-style: italic;">"F"</span> (ert <span style="font-weight: bold;">:failed</span>) <span style="font-style: italic;">"failed"</span>))
     <span style="font-style: italic;">"Doc"</span>
     ((<span style="font-style: italic;">"f"</span> describe-function <span style="font-style: italic;">"function"</span>)
      (<span style="font-style: italic;">"v"</span> describe-variable <span style="font-style: italic;">"variable"</span>)
      (<span style="font-style: italic;">"i"</span> info-lookup-symbol <span style="font-style: italic;">"info lookup"</span>)))))

(<span style="font-weight: bold;">with-eval-after-load</span> 'major-mode-hydra
  (major-mode-hydra-define org-agenda-mode nil
    (<span style="font-style: italic;">"pomodoro"</span>
     ((<span style="font-style: italic;">"s"</span> org-pomodoro <span style="font-style: italic;">"start org-pomodoro"</span>)))))
</pre>
</div>

<p>
メジャーモードに対するhydraを設定する。
</p>
</div>
</div>

<div id="outline-container-orgcf8cf04" class="outline-2">
<h2 id="orgcf8cf04"><span class="section-number-2">20.</span> Display Manager</h2>
<div class="outline-text-2" id="text-20">
<p>
OS操作の便利関数。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>音量調整する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/mint-volume-up</span> ()
  <span style="font-style: italic;">"Linux Mint&#12391;&#12398;&#38899;&#37327;&#12450;&#12483;&#12503;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"volume up"</span> nil <span style="font-style: italic;">"pactl set-sink-volume @DEFAULT_SINK@ +5%"</span>))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/mint-volume-down</span> ()
  <span style="font-style: italic;">"Linux Mint&#12391;&#12398;&#38899;&#37327;&#12480;&#12454;&#12531;."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"volume up"</span> nil <span style="font-style: italic;">"pactl set-sink-volume @DEFAULT_SINK@ -5%"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>再生を停止する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/player-stop</span> ()
  <span style="font-style: italic;">"&#20877;&#29983;&#20572;&#27490;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (start-process-shell-command <span style="font-style: italic;">"player stop"</span> nil <span style="font-style: italic;">"playerctl stop"</span>))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ネットワークを接続・切断する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/up-network</span> ()
  <span style="font-style: italic;">"&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#25509;&#32154;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((passwd))
    (<span style="font-weight: bold;">setq</span> passwd (read-passwd <span style="font-style: italic;">"Password? "</span>))
    (shell-command  (concat <span style="font-style: italic;">"for intf in /sys/class/net/*; do echo "</span>
                            (shell-quote-argument passwd)
                            <span style="font-style: italic;">" | sudo -S ifconfig `basename $intf` up; done"</span>))))
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/down-network</span> ()
  <span style="font-style: italic;">"&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#20999;&#26029;"</span>
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((passwd))
    (<span style="font-weight: bold;">setq</span> passwd (read-passwd <span style="font-style: italic;">"Password? "</span>))
    (shell-command  (concat <span style="font-style: italic;">"for intf in /sys/class/net/*; do echo "</span>
                            (shell-quote-argument passwd)
                            <span style="font-style: italic;">" | sudo -S ifconfig `basename $intf` down; done"</span>))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>英語辞書をインストールする</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package ej-dict</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:straight (:host github :repo "kijimaD/ej-dict"))</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(ej-dict-install-dict)</span>
</pre>
</div>

<p>
あまり使ってないのでコメントアウトしている。
</p>
</div>
</div>
<div id="outline-container-org2130db7" class="outline-2">
<h2 id="org2130db7"><span class="section-number-2">21.</span> Helper</h2>
<div class="outline-text-2" id="text-21">
<p>
その他の便利関数。
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>前のマークに戻る</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-exchange-point-and-mark</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (exchange-point-and-mark)
  (deactivate-mark))
(global-set-key (kbd <span style="font-style: italic;">"C-x C-x"</span>) 'my-exchange-point-and-mark)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>行全体を削除する</label><pre class="src src-emacs-lisp">(global-set-key (kbd <span style="font-style: italic;">"C-c C-k"</span>) 'kill-whole-line)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>カレントパスを取得する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">current-path</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (<span style="font-weight: bold;">let</span> ((file-path buffer-file-name)
        (dir-path default-directory))
    (<span style="font-weight: bold;">cond</span> (file-path
           (kill-new (expand-file-name file-path))
           (message <span style="font-style: italic;">"Add Kill Ring: %s"</span> (expand-file-name file-path)))
          (dir-path
           (kill-new (expand-file-name dir-path))
           (message <span style="font-style: italic;">"Add Kill Ring: %s"</span> (expand-file-name dir-path)))
          (t
           (error-message-string <span style="font-style: italic;">"Fail to get path name."</span>)))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>i-searchで逆側にカーソルをセットする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-isearch-done-opposite</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> nopush edit)
  <span style="font-style: italic;">"End current search in the opposite side of the match."</span>
  (<span style="font-weight: bold;">interactive</span>)
  (funcall #'isearch-done nopush edit)
  (<span style="font-weight: bold;">when</span> isearch-other-end (goto-char isearch-other-end)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>カーソルを真ん中に保ちつつ行を1つ移動する</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-next-line</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (next-line)
  (recenter))
(global-set-key (kbd <span style="font-style: italic;">"&lt;down&gt;"</span>) 'my-next-line)

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">my-previous-line</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (previous-line)
  (recenter))
(global-set-key (kbd <span style="font-style: italic;">"&lt;up&gt;"</span>) 'my-previous-line)
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>ewwのキーバインドを設定する</label><pre class="src src-emacs-lisp">(eval-after-load <span style="font-style: italic;">"eww"</span>
  '(progn
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-1&gt;"</span>) 'my-next-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-2&gt;"</span>) 'define-word-at-point)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-4&gt;"</span>) 'my-previous-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;down-mouse-4&gt;"</span>) 'nil)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-5&gt;"</span>) 'my-next-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;down-mouse-5&gt;"</span>) 'nil)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-3&gt;"</span>) 'my-previous-line)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-8&gt;"</span>) 'backward-word)
     (define-key eww-mode-map (kbd <span style="font-style: italic;">"&lt;mouse-9&gt;"</span>) 'forward-word)))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>最後のタイマーをキャンセルする</label><pre class="src src-emacs-lisp">(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">kd/cancel-last-timer</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (cancel-timer (car (last timer-list))))
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Cの関数に定義ジャンプできるようにする</label><pre class="src src-emacs-lisp"><span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Emacs C source directory</span>
(<span style="font-weight: bold;">let</span> ((src-dir <span style="font-style: italic;">"~/ProjectOrg/emacs/src"</span>))
  (<span style="font-weight: bold;">if</span> (file-directory-p src-dir)
      (<span style="font-weight: bold;">setq</span> source-directory src-dir)))
</pre>
</div>

<p>
<code>~/ProjectOrg</code> にEmacsのソースコードを配置しておく。
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-12-18 Sun 11:11</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>